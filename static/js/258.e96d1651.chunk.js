"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[258],{96954:(e,t,s)=>{s.d(t,{Z:()=>c});var l=s(70537),n=s(4931),a=s(64631),r=s(11855),i=s(80683);const c=e=>{let{id:t=""}=e;const{favorites:s}=(0,r.Z)({}),[c,d]=(0,l.useState)(null);return(0,l.useEffect)((()=>{const e=s.find((e=>e.id==t)),{messages:l}=e||{};if(!l)return;const r=l.map((e=>{let{from_mid:t}=e;return+t}))||[];d((0,i.jsx)("div",{"data-favorite-mids":r.join(","),className:"favorite flex flex-col rounded-md bg-slate-50 dark:bg-slate-800",children:(0,i.jsx)("div",{className:"list",children:l.map(((e,t)=>{const{user:s={},download:l,content:r,content_type:c,properties:d,thumbnail:o}=e;return(0,i.jsxs)("div",{className:"w-full relative flex items-start gap-3 px-2 py-1 my-2 rounded-lg md:dark:hover:bg-gray-800",children:[s&&(0,i.jsx)("div",{className:"shrink-0 w-10 h-10 flex",children:(0,i.jsx)(a.Z,{width:40,height:40,className:"rounded-full object-cover",src:s.avatar,name:s.name})}),(0,i.jsxs)("div",{className:"w-full flex flex-col gap-2 text-sm",children:[(0,i.jsx)("div",{className:"flex items-center gap-2 font-semibold",children:(0,i.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:(null===s||void 0===s?void 0:s.name)||"Deleted User"})}),(0,i.jsx)("div",{className:"select-text text-gray-800 break-all whitespace-pre-wrap dark:text-white",children:(0,n.Z)({download:l,content:r,content_type:c,properties:d,thumbnail:o})})]})]},t)}))})}))}),[s,t]),t?c:null}},40830:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Bs});var l=s(70537),n=s(15924),a=s(57425),r=s(72991),i=s(64084),c=s(7829),d=s(28595),o=s(31159),x=s(14317),m=s(66160),u=s(14566),h=s(80683);function p(e){let{readonly:t=!1}=e;const{t:s}=(0,u.$G)(),{pathname:l}=(0,n.TH)(),{server:a,userCount:r}=(0,m.CG)((e=>({userCount:e.users.ids.length,server:e.server}))),{name:p,description:f,logo:g}=a;return t?(0,h.jsx)(i.OL,{to:"/",className:"relative flex items-center justify-between gap-2 px-4 py-2",children:(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("div",{className:"w-8 h-8",children:(0,h.jsx)("img",{alt:`${p} logo`,className:"w-full h-full object-cover rounded-full",src:g})}),(0,h.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,h.jsx)("h3",{className:"text-sm text-gray-600 dark:text-gray-100",title:f,children:p}),(0,h.jsxs)("span",{className:"text-xs text-gray-500",children:[r," ",s("members")]})]})]})}):(0,h.jsxs)("div",{className:"relative flex items-center justify-between gap-2 px-4 py-2",children:[(0,h.jsx)(i.OL,{to:`/setting/overview?f=${l}`,children:(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("div",{className:"w-8 h-8",children:(0,h.jsx)("img",{alt:`${p} logo`,className:"w-full h-full object-cover rounded-full",src:g})}),(0,h.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,h.jsx)("h3",{className:"text-sm text-gray-600 font-bold dark:text-gray-100",title:f,children:p}),(0,h.jsxs)("span",{className:"text-xs text-gray-500",children:[r," ",s("members")]})]})]})}),(0,h.jsx)(o.Z,{tip:s("more"),placement:"bottom",children:(0,h.jsx)(c.ZP,{interactive:!0,placement:"bottom-end",trigger:"click",content:(0,h.jsx)(x.Z,{}),children:(0,h.jsx)(d.Z,{className:"dark:fill-gray-400",role:"button"})})})]})}var f,g=s(3074),v=s(87336);function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},j.apply(this,arguments)}const b=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",j({width:160,height:160,viewBox:"0 0 160 160",fill:"#D0D5DD",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,f||(f=l.createElement("path",{d:"M79.9997 13.3642C116.819 13.3642 146.666 43.2118 146.666 80.0308C146.666 116.85 116.819 146.698 79.9997 146.698C43.1807 146.698 13.333 116.85 13.333 80.0308C13.333 43.2118 43.1807 13.3642 79.9997 13.3642ZM79.9997 23.3642C48.7035 23.3642 23.333 48.7347 23.333 80.0308C23.333 111.327 48.7035 136.698 79.9997 136.698C111.296 136.698 136.666 111.327 136.666 80.0308C136.666 48.7347 111.296 23.3642 79.9997 23.3642ZM79.9997 86.6667C88.284 86.6667 94.9997 93.3824 94.9997 101.667C94.9997 109.951 88.284 116.667 79.9997 116.667C71.7154 116.667 64.9997 109.951 64.9997 101.667C64.9997 93.3824 71.7154 86.6667 79.9997 86.6667ZM60.0027 58.3411C64.6024 58.3411 68.3313 62.0699 68.3313 66.6697C68.3313 71.2694 64.6024 74.9983 60.0027 74.9983C55.4029 74.9983 51.6741 71.2694 51.6741 66.6697C51.6741 62.0699 55.4029 58.3411 60.0027 58.3411ZM100.003 58.3411C104.602 58.3411 108.331 62.0699 108.331 66.6697C108.331 71.2694 104.602 74.9983 100.003 74.9983C95.4029 74.9983 91.6741 71.2694 91.6741 66.6697C91.6741 62.0699 95.4029 58.3411 100.003 58.3411Z"})))},C=(0,l.forwardRef)(b);var y=s(25552),w=s(7699),N=s.n(w),k=s(4931),Z=s(64631),_=s(21812);const M=e=>{var t,s,l;let{data:n}=e;const{msgData:a,usersData:r}=(0,m.CG)((e=>({msgData:e.message,usersData:e.users.byId}))),{mid:i=0}=n,c=(0,_.PW)(n)||{},{content_type:d,content:o,properties:x,thumbnail:u=""}={...n,...c},p=(null===(t=a[i])||void 0===t?void 0:t.from_uid)||0,f=(null===(s=a[i])||void 0===s?void 0:s.created_at)||0,{name:g,avatar:v}=null!==(l=r[p])&&void 0!==l?l:{};return(0,h.jsxs)("div",{className:"w-full relative flex items-start gap-3 p-2 my-2 rounded-lg",children:[(0,h.jsx)("div",{className:"rounded-full overflow-hidden w-10 h-10 shrink-0",children:(0,h.jsx)(Z.Z,{width:40,height:40,src:v,name:g})}),(0,h.jsxs)("div",{className:"w-full flex flex-col items-start gap-1  text-sm",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2 font-semibold",children:[(0,h.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:g}),(0,h.jsx)("time",{className:"text-xs text-gray-400",children:N()(f).format("YYYY-MM-DD h:mm:ss A")})]}),(0,h.jsx)("div",{className:"select-text text-gray-600 break-all whitespace-pre-wrap dark:text-white",children:(0,k.Z)({content_type:d,content:o,thumbnail:u,from_uid:p,properties:x})})]})]})},L=e=>{let{id:t}=e;const{t:s}=(0,u.$G)("chat"),{pins:l,unpinMessage:n,canPin:a}=(0,v.Z)(t),r=e=>{const{mid:t}=e.currentTarget.dataset;t&&n(+t)},i=0==l.length;return(0,h.jsxs)("div",{className:"p-4 drop-shadow-md overflow-y-scroll min-w-[320px] md:min-w-[486px] md:max-h-[90vh] rounded-xl bg-gray-50 dark:bg-gray-800",children:[(0,h.jsxs)("h4",{className:" text-gray-600 dark:text-gray-400 mb-4 font-semibold",children:[s("pinned_msg"),"(",l.length,")"]}),i?(0,h.jsxs)("div",{className:"flex flex-col items-center gap-2 w-full p-4",children:[(0,h.jsx)(C,{}),(0,h.jsx)("div",{className:"w-60 font-semibold text-gray-500 dark:text-gray-300 text-center",children:s("pin_empty_tip")})]}):(0,h.jsx)("ul",{className:"flex flex-col gap-2",children:l.map((e=>(0,h.jsxs)("li",{className:"group relative border border-solid border-slate-100 dark:border-slate-600 rounded-md ",children:[(0,h.jsx)(M,{data:e}),(0,h.jsx)("div",{className:"invisible group-hover:visible flex items-center gap-1 absolute top-1 right-1 p-1 border border-solid border-black/10 dark:border-gray-500 rounded-md",children:a&&(0,h.jsx)("button",{className:"flex bg-none border-none","data-mid":e.mid,onClick:r,children:(0,h.jsx)(y.Z,{className:"fill-slate-900 dark:fill-slate-300"})})})]},e.mid)))})]})};var D=s(96954),I=s(11855);const E=e=>{let{cid:t=null,uid:s=null}=e;const{t:l}=(0,u.$G)("chat"),{favorites:n,removeFavorite:a}=(0,I.Z)({cid:t,uid:s}),r=e=>{const{id:t=""}=e.currentTarget.dataset;a(t)},i=0==n.length;return(0,h.jsxs)("div",{className:"p-4 bg-slate-50 dark:bg-slate-800 rounded-xl min-w-[500px] max-h-[500px] overflow-auto drop-shadow-[0px_25px_50px_rgba(31,_41,_55,_0.25)]",children:[(0,h.jsxs)("h4",{className:"font-bold text-gray-600 dark:text-gray-400 mb-4",children:[l("fav_msg"),"(",n.length,")"]}),i?(0,h.jsxs)("div",{className:"flex flex-col gap-2 w-full items-center p-4",children:[(0,h.jsx)(C,{}),(0,h.jsx)("div",{className:"w-60 text-gray-600 dark:text-gray-400 text-center font-bold",children:l("fav_empty_tip")})]}):(0,h.jsx)("ul",{className:"flex flex-col gap-2",children:n.map((e=>{let{id:t}=e;return(0,h.jsxs)("li",{className:"relative border border-solid border-slate-200 dark:border-gray-600 rounded-md group",children:[(0,h.jsx)(D.Z,{id:t}),(0,h.jsx)("div",{className:"flex items-center absolute top-2 right-2 border border-solid border-gray-300 dark:border-gray-600 rounded-md overflow-hidden invisible group-hover:visible",children:(0,h.jsx)("button",{className:"flex-center w-6 h-6 p-1","data-id":t,onClick:r,children:(0,h.jsx)(y.Z,{className:"fill-slate-900 dark:fill-slate-500"})})})]},t)}))})]})};var $=s(12564),O=s(13386),V=s(59857),H=s(16352),S=s(27418),F=s(62432),G=s(53517),R=s(1823),U=s(88332);var T=s(80308),B=s(81721),P=s(57815),z=s(55526),A=s(88109),K=s(25583),W=s(34265);const Y={editableProps:{spellCheck:!1,autoFocus:!0,placeholder:"Type\u2026"},trailingBlock:{type:z.JBe},softBreak:{options:{rules:[{hotkey:"shift+enter",query:{allow:[z.IVr,z.JBe]}}]}},exitBreak:{options:{rules:[{hotkey:"mod+enter",query:{allow:[z.IVr,z.JBe]}}]}},selectOnBackspace:{options:{query:{allow:[z.IVr]}}}};var q=s(33941);const Q="_text_editor";let J=(0,z.Ips)({});const X=[{type:z.JBe,children:[{text:""}]}],ee=e=>{const t=(0,z.CE7)(`${Q}_${e}`);return{focus:()=>{t&&K.F3.focus(t)},insertText:e=>{t&&(K.F3.focus(t),t.insertText(e))}}},te=e=>{let{updateDraft:t=null,initialValue:s=X,id:n,placeholder:a="Write some markdown...",sendMessages:r,members:i=[]}=e;const[c,d]=n.split("_"),{addStageFile:o}=(0,W.Z)({context:c,id:d}),x=i.length>0,u=(0,m.CG)((e=>e.users.byId)),[p,f]=(0,l.useState)([]),g=(0,l.useRef)(null),v={...Y.editableProps,className:"flex flex-col md:gap-2",placeholder:a},j=(0,z.CE7)(`${Q}_${n}`);(0,l.useEffect)((()=>{const e=e=>{const t=[...e.clipboardData.files];if(t.length){const e=t.map((e=>{const{size:t,type:s,name:l}=e;return{size:t,type:s,name:l,url:URL.createObjectURL(e)}}));o(e)}};return window.addEventListener("paste",e),()=>{window.removeEventListener("paste",e)}}),[n,t]),(0,B.z)("Enter",(e=>{if(!j)return;if((0,z.kGl)(j)||e.shiftKey||e.ctrlKey||e.altKey||e.isComposing)return!0;e.preventDefault(),b()}),{when:!(0,_.tq)(),target:g});const b=()=>{r(p),P.YR.delete(j,{at:{anchor:P.ML.start(j,[]),focus:P.ML.end(j,[])}})},C=[(0,z.ZZF)(),(0,z.kdp)(),(0,z.kjx)(Y.softBreak),(0,z.AFf)(Y.trailingBlock),(0,z.z$X)(Y.exitBreak)],y=(0,z.ZUk)(x?C.concat([(0,A.kQ)(),(0,z.MoH)({options:{createMentionNode:e=>{const{text:t,data:{uid:s}}=e;return{value:`@${t}`,uid:s}},insertSpaceAfterMention:!0}})]):C,{components:J}),w=(0,l.useCallback)((async e=>{const t=[],s=e=>{const t=[];return{value:e.map((e=>{let{type:s,text:l,uid:n}=e;return"mention"==s?(t.push(n),` @${n} `):l})).join(""),mentions:t}};for(const n of e){const{value:e,mentions:l}=s(n.children),a=t[t.length-1];a&&Array.isArray(a)?t[t.length-1].push({type:"text",content:e,properties:{mentions:l}}):t.push([{type:"text",content:e,properties:{mentions:l}}])}const l=t.map((e=>Array.isArray(e)?{type:"text",content:e.map((e=>e.content)).join("\n"),properties:{mentions:e.map((e=>{var t;return(null===(t=e.properties)||void 0===t?void 0:t.mentions)||[]})).flat()}}:e)).filter((e=>{let{content:t}=e;return!!t}));f(l)}),[p]);return(0,h.jsx)("div",{className:"input w-full pr-14 md:pr-0 max-h-[50vh] overflow-auto text-sm text-gray-600 dark:text-white",ref:g,children:(0,h.jsx)(z.hv7,{id:`${Q}_${n}`,onChange:w,editableProps:{...v,style:{userSelect:"text"}},initialValue:s,plugins:y,children:x?(0,h.jsx)(z.bEm,{onRenderItem:e=>{let{item:t}=e;return t&&t.data?(0,h.jsx)(q.Z,{uid:t.data.uid,interactive:!1},t.data.uid):null},items:i.map((e=>{const t=u[e];if(!t)return{key:e};const{uid:s,name:l,...n}=t;return{key:s,text:l,data:{uid:s,...n}}}))}):null})})};var se=s(80874),le=s(69885),ne=s(17237);function ae(e){let{name:t,closeModal:s,updateName:n}=e;const[a,r]=(0,l.useState)(t);return(0,h.jsx)(se.Z,{children:(0,h.jsxs)("div",{className:"bg-white dark:bg-gray-800 flex flex-col drop-shadow rounded-xl p-4 w-[406px]",children:[(0,h.jsxs)("h4",{className:"flex items-center justify-between font-semibold text-lg text-gray-700 dark:text-gray-100 w-full",children:["File Details ",(0,h.jsx)(y.Z,{className:"cursor-pointer dark:fill-white",onClick:s})]}),(0,h.jsxs)("div",{className:"py-4 flex flex-col gap-2",children:[(0,h.jsx)("label",{className:"font-semibold text-sm text-gray-600 dark:text-gray-200",htmlFor:"name",children:"Name"}),(0,h.jsx)(ne.Z,{id:"name",value:a,onChange:e=>{r(e.target.value)}})]}),(0,h.jsxs)("div",{className:"flex justify-end gap-4 mt-8 w-full",children:[(0,h.jsx)(le.Z,{className:"ghost cancel",onClick:s,children:"Cancel"}),(0,h.jsx)(le.Z,{onClick:()=>{n(a),s()},children:"Save Changes"})]})]})})}var re=s(28533),ie=s(9925);function ce(e){let{context:t,id:s}=e;const n=ee(`${t}_${s}`),[a,r]=(0,l.useState)(null),{stageFiles:i,updateStageFile:c,removeStageFile:d}=(0,W.Z)({context:t,id:s}),o=e=>{r((t=>t?null:e))},x=e=>{const t=i[`${e}`];t&&o({...t,index:e})};return(0,l.useEffect)((()=>{n.focus()}),[i.length]),t&&s&&i&&0!=i.length?(0,h.jsxs)(h.Fragment,{children:[a&&(0,h.jsx)(ae,{name:a.name,updateName:e=>{if(!e||!a)return;const{index:t}=a;c(t,{name:e})},closeModal:o}),(0,h.jsx)("ul",{className:"w-full overflow-auto flex gap-2 justify-start p-4 pt-6 bg-gray-200 dark:bg-gray-800 rounded-t-lg",children:i.map(((e,t)=>{let{name:s,url:l,size:n,type:a}=e;return(0,h.jsxs)("li",{className:"group relative flex flex-col bg-gray-100 dark:bg-gray-700 rounded p-2",children:[(0,h.jsx)("div",{className:"flex-center w-40 h-40",children:a.startsWith("image")?(0,h.jsx)("img",{className:"w-full h-full object-cover",src:l,alt:"image"}):(0,_.LP)(a,s)}),(0,h.jsx)("h4",{className:"w-40 mt-4 mb-0.5 font-semibold text-sm text-gray-800 dark:text-gray-100 truncate",children:s}),(0,h.jsx)("span",{className:"text-xs text-gray-500",children:(0,_.td)(n)}),(0,h.jsxs)("ul",{className:"invisible group-hover:visible bg-inherit border border-solid border-black/10 box-border rounded-md flex items-center absolute -right-5 -top-2.5",children:[(0,h.jsx)("li",{className:"p-1 cursor-pointer edit",onClick:x.bind(null,t),children:(0,h.jsx)(re.Z,{})}),(0,h.jsx)("li",{className:"p-1 cursor-pointer delete","data-index":t,onClick:d.bind(null,t),children:(0,h.jsx)(ie.Z,{})})]})]},l)}))})]}):null}var de=s(84006),oe=s(24041);const xe=s.p+"static/media/picture.57a395fb7f41e8e3c5d1.svg";var me=s(7935);const ue=e=>{const{content_type:t,content:s,thumbnail:l="",properties:n}=e;let a=null;switch(t){case T.bT.text:a=(0,h.jsx)(me.Z,{text:s,url:!1,mentionTextOnly:!0});break;case T.bT.audio:a=(0,h.jsx)("div",{className:"text-sm",children:(0,h.jsx)("span",{className:"text-gray-400 italic",children:"[Voice Message]"})});break;case T.bT.markdown:a=(0,h.jsx)("div",{className:"max-h-[100px] overflow-auto",children:(0,h.jsx)(de.Z,{content:s})});break;case T.bT.file:{const{content_type:e="",name:t,size:s}=n||{};if((0,_.Or)(e,s))a=(0,h.jsx)("img",{className:"w-10 h-10 object-cover",src:l||xe});else{const s=(0,_.LP)(e,t,"icon w-4 h-5");a=(0,h.jsxs)(h.Fragment,{children:[s,(0,h.jsx)("span",{className:"ml-1 text-[10px] text-gray-400",children:t})]})}}}return a};function he(e){let{context:t,id:s,mid:l}=e;const{removeReplying:n}=(0,F.Z)({to:s,context:t}),{msg:a,usersData:r}=(0,m.CG)((e=>({usersData:e.users.byId,msg:e.message[l]})));if(!a)return null;const{from_uid:i=0}=a,c=r[i];return(0,h.jsxs)("div",{className:"reply bg-gray-100 dark:bg-gray-700 z-[999] flex flex-col md:flex-row items-start justify-start gap-4 rounded-t-lg w-full px-4 py-3 text-sm",children:[(0,h.jsxs)("div",{className:"whitespace-nowrap text-gray-400 ",children:["Replying to ",(0,h.jsx)("span",{className:"font-bold text-gray-600 dark:text-gray-400",children:null===c||void 0===c?void 0:c.name})]}),(0,h.jsx)("div",{className:"text-gray-500 overflow-hidden pr-7 ",children:ue(a)}),(0,h.jsx)("button",{className:"absolute top-4 right-4 cursor-pointer",onClick:()=>{n()},children:(0,h.jsx)(oe.Z,{className:"dark:fill-gray-400"})})]})}var pe;function fe(){return fe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},fe.apply(this,arguments)}const ge=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",fe({width:24,height:24,viewBox:"0 0 24 24",fill:"#667085",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,pe||(pe=l.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM17 13H13V17H11V13H7V11H11V7H13V11H17V13Z"})))},ve=(0,l.forwardRef)(ge);var je;function be(){return be=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},be.apply(this,arguments)}const Ce=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",be({width:24,height:24,viewBox:"0 0 24 24",fill:"#667085",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,je||(je=l.createElement("path",{d:"M3 2H21C21.2652 2 21.5196 2.11706 21.7071 2.32544C21.8946 2.53381 22 2.81643 22 3.11111V20.8889C22 21.1836 21.8946 21.4662 21.7071 21.6746C21.5196 21.8829 21.2652 22 21 22H3C2.73478 22 2.48043 21.8829 2.29289 21.6746C2.10536 21.4662 2 21.1836 2 20.8889V3.11111C2 2.81643 2.10536 2.53381 2.29289 2.32544C2.48043 2.11706 2.73478 2 3 2ZM7 15.8889V11.4444L9 13.6667L11 11.4444V15.8889H13V8.11111H11L9 10.3333L7 8.11111H5V15.8889H7ZM18 12.5556V8.11111H16V12.5556H14L17 15.8889L20 12.5556H18Z"})))},ye=(0,l.forwardRef)(Ce);var we;function Ne(){return Ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},Ne.apply(this,arguments)}const ke=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",Ne({width:24,height:24,viewBox:"0 0 24 24",fill:"#667085",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,we||(we=l.createElement("path",{d:"M5 6C5 5.44772 5.44772 5 6 5H8C8.55228 5 9 4.55228 9 4C9 3.44772 8.55228 3 8 3H6C4.34315 3 3 4.34315 3 6V8C3 8.55228 3.44772 9 4 9C4.55228 9 5 8.55228 5 8V6ZM5 18C5 18.5523 5.44772 19 6 19H8C8.55228 19 9 19.4477 9 20C9 20.5523 8.55228 21 8 21H6C4.34315 21 3 19.6569 3 18V16C3 15.4477 3.44772 15 4 15C4.55228 15 5 15.4477 5 16V18ZM18 5C18.5523 5 19 5.44772 19 6V8C19 8.55228 19.4477 9 20 9C20.5523 9 21 8.55228 21 8V6C21 4.34315 19.6569 3 18 3H16C15.4477 3 15 3.44772 15 4C15 4.55228 15.4477 5 16 5H18ZM19 18C19 18.5523 18.5523 19 18 19H16C15.4477 19 15 19.4477 15 20C15 20.5523 15.4477 21 16 21H18C19.6569 21 21 19.6569 21 18V16C21 15.4477 20.5523 15 20 15C19.4477 15 19 15.4477 19 16V18Z"})))},Ze=(0,l.forwardRef)(ke);var _e;function Me(){return Me=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},Me.apply(this,arguments)}const Le=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",Me({width:24,height:24,viewBox:"0 0 24 24",fill:"#667085",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,_e||(_e=l.createElement("path",{d:"M9 4C9 3.44772 8.55228 3 8 3C7.44772 3 7 3.44772 7 4V6.5C7 6.77614 6.77614 7 6.5 7H4C3.44772 7 3 7.44772 3 8C3 8.55228 3.44772 9 4 9H6.5C7.88071 9 9 7.88071 9 6.5V4ZM9 20C9 20.5523 8.55228 21 8 21C7.44772 21 7 20.5523 7 20V17.5C7 17.2239 6.77614 17 6.5 17H4C3.44772 17 3 16.5523 3 16C3 15.4477 3.44772 15 4 15H6.5C7.88071 15 9 16.1193 9 17.5V20ZM16 3C15.4477 3 15 3.44772 15 4V6.5C15 7.88071 16.1193 9 17.5 9H20C20.5523 9 21 8.55228 21 8C21 7.44772 20.5523 7 20 7H17.5C17.2239 7 17 6.77614 17 6.5V4C17 3.44772 16.5523 3 16 3ZM15 20C15 20.5523 15.4477 21 16 21C16.5523 21 17 20.5523 17 20V17.5C17 17.2239 17.2239 17 17.5 17H20C20.5523 17 21 16.5523 21 16C21 15.4477 20.5523 15 20 15H17.5C16.1193 15 15 16.1193 15 17.5V20Z"})))},De=(0,l.forwardRef)(Le),Ie=e=>{let{toggleMarkdownFullscreen:t,fullscreen:s,toggleMode:n,mode:a,to:r,context:i}=e;const{t:c}=(0,u.$G)(),{addStageFile:d}=(0,W.Z)({context:i,id:r}),x=(0,l.useRef)(null),m="markdown"==a;return(0,h.jsxs)("div",{className:"hidden md:flex flex-col md:flex-row items-center justify-end gap-2.5",children:[(0,h.jsxs)("div",{className:"flex cursor-pointer gap-3.5",children:[(0,h.jsx)(o.Z,{placement:"top",tip:"Markdown",children:(0,h.jsx)(ye,{className:m?"fill-primary-400":"dark:fill-gray-300",onClick:n})}),m&&(s?(0,h.jsx)(o.Z,{placement:"top",tip:"Exit Fullscreen",children:(0,h.jsx)(De,{onClick:t,className:"dark:fill-gray-300"})}):(0,h.jsx)(o.Z,{placement:"top",tip:"Fullscreen",children:(0,h.jsx)(Ze,{onClick:t,className:"dark:fill-gray-300"})}))]}),!m&&(0,h.jsx)(o.Z,{placement:"top",tip:c("action.upload"),children:(0,h.jsxs)("div",{className:"cursor-pointer relative w-6 h-6",children:[(0,h.jsx)(ve,{className:"dark:fill-gray-300"}),(0,h.jsx)("label",{htmlFor:"file",className:" cursor-pointer absolute left-0 top-0 w-full h-full opacity-0",children:(0,h.jsx)("input",{className:"hidden",size:24,ref:x,multiple:!0,onChange:e=>{if(!e.target.files)return;const t=Array.from(e.target.files).map((e=>{const{size:t,type:s,name:l}=e;return{size:t,type:s,name:l,url:URL.createObjectURL(e)}}));d(t),x.current.value=null,x.current.value=""},type:"file",name:"file",id:"file"})})]})})]})};var Ee=s(97943),$e=s(49476),Oe=s(1098);function Ve(e){let{selectEmoji:t}=e;const s=(0,l.useRef)(null),[n,r]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{s&&s.current&&(s.current.innerHTML="",new $e.cW({data:async()=>(await fetch("https://cdn.jsdelivr.net/npm/@emoji-mart/data")).json(),parent:s.current,onEmojiSelect:e=>{t(e.native)}}))}),[t]),(0,Ee.O)(s,(e=>{const t=e.target;"svg"==t.nodeName&&"toggler"==t.dataset.emoji||"path"==t.nodeName&&"toggler"==t.parentElement.dataset.emoji||r(!1)}),n),(0,h.jsx)(o.Z,{placement:"top",tip:"Emojis",disabled:n,children:(0,h.jsxs)("div",{className:"hidden md:flex relative w-fit items-center",children:[(0,h.jsx)("div",{ref:s,className:(0,a.Z)("z-50 absolute -top-5 -left-5 -translate-y-full",n?"block":"hidden")}),(0,h.jsx)(Oe.Z,{"data-emoji":"toggler",className:"cursor-pointer select-none !w-[22px] !h-[22px]",onClick:()=>{r((e=>!e))}})]})})}var He=s(85606),Se=(s(85012),s(61459),s(29191),s(69495),s(55403)),Fe=s.n(Se);const Ge=e=>{let{updateDraft:t=null,initialValue:s="",height:n="50vh",placeholder:a,sendMarkdown:r,setEditorInstance:i}=e;const c=(0,l.useRef)(),{uploadFile:d}=(0,W.Z)();(0,l.useEffect)((()=>{const e=null===c||void 0===c?void 0:c.current;if(e){const t=e.getInstance();t.removeHook("addImageBlobHook"),t.addHook("addImageBlobHook",(async(e,t)=>{const{thumbnail:s=""}=await d(e)||{};t(s)})),i(t)}return()=>{if(e){const s=e.getInstance(),l=s.getMarkdown();t&&t(l),s.destroy()}}}),[]);return(0,h.jsxs)("div",{className:"input md-editor",children:[(0,h.jsx)(He.M,{initialValue:s,plugins:[Fe()],placeholder:a,ref:c,toolbarItems:[],hideModeSwitch:!0,previewStyle:"vertical",height:n,initialEditType:"markdown",useCommandShortcut:!0,theme:(0,_.Yc)()?"dark":"light"}),(0,h.jsx)(le.Z,{className:"send small",onClick:()=>{if(!c.current)return;const e=c.current.getInstance();e.getMarkdown().trim()&&(r(e.getMarkdown()),e.reset())},children:"Send"})]})},Re=e=>{let{context:t="user",id:s=0}=e;const l=(0,m.TL)(),n=`${t}_${s}`,{draftMarkdown:a,draftMixedText:r}=(0,m.CG)((e=>({draftMarkdown:e.ui.draftMarkdown,draftMixedText:e.ui.draftMixedText})));return{getDraft:function(){return"mixed"==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mixed")?r[n]:a[n]},getUpdateDraft:function(){const e="mixed"==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mixed")?$.$K:$.Ul;return t=>{l(e({key:n,value:t}))}}}};var Ue=s(55283);const Te=e=>{let{sendMessage:t,placeholder:s}=e;const{t:n}=(0,u.$G)(),a=(0,l.useRef)(null),[r,i]=(0,l.useState)(""),c=()=>{if(!r)return;t([{type:"text",content:r}]),i("")};return(0,B.z)("Enter",(e=>{e.preventDefault(),c()}),{when:!(0,_.tq)(),target:a}),(0,h.jsxs)("div",{className:"md:hidden relative mb-1 p-1 flex items-center w-full text-gray-600 dark:text-white bg-gray-200 dark:bg-gray-600 rounded-lg",children:[(0,h.jsx)(Ue.Z,{onFocus:e=>e.currentTarget.setSelectionRange(e.currentTarget.value.length,e.currentTarget.value.length),ref:a,className:"p-1 w-full min-h-[28px] resize-none bg-transparent text-gray-800 dark:text-white text-sm break-all",maxRows:8,minRows:1,onChange:e=>{i(e.target.value)},value:r,placeholder:s}),(0,h.jsx)(le.Z,{onClick:c,className:"mini absolute right-1.5 bottom-1.5",children:n("action.send")})]})},Be="text",Pe="markdown",ze=e=>{var t,s,n,r;let{context:i="channel",id:c}=e;const{t:d}=(0,u.$G)("chat"),{resetStageFiles:o}=(0,W.Z)({context:i,id:c}),{getDraft:x,getUpdateDraft:p}=Re({context:i,id:c}),f=ee(`${i}_${c}`),[v,j]=(0,l.useState)(null),[b,C]=(0,l.useState)(!1),y=(0,m.TL)(),w=function(e){let{context:t,to:s}=e;const l=(0,g.I0)(),n="channel"==t?R.p_:U.ZK;return e=>{l((0,G.Hz)(e)),l(n({id:s,mid:e.mid}))}}({context:i,to:c}),{from_uid:N,replying_mid:k=null,mode:Z,uploadFiles:_,channelsData:M,usersData:L,uids:D}=(0,m.CG)((e=>{var t;return{channelsData:e.channels.byId,uids:e.users.ids,usersData:e.users.byId,mode:e.ui.inputMode,from_uid:null===(t=e.authData.user)||void 0===t?void 0:t.uid,replying_mid:e.message.replying[`${i}_${c}`],uploadFiles:e.ui.uploadFiles[`${i}_${c}`]}})),{sendMessage:I}=(0,F.Z)({context:i,from:N,to:c});(0,l.useEffect)((()=>{k&&f.focus()}),[k]);const E=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(c){if(e&&e.length)for await(const s of e){var t;const{type:e,content:l,properties:n={}}=s;n.local_id=null!==(t=n.local_id)&&void 0!==t?t:+new Date,await I({id:c,reply_mid:k,type:e,content:l,from_uid:N,properties:n})}_&&0!==_.length&&(_.forEach((e=>{const t=+new Date,{url:s,name:l,size:n,type:a}=e,r={mid:t,content:s,content_type:T.bT.file,created_at:t,properties:{content_type:a,name:l,size:n,local_id:t},from_uid:N,sending:!0};w(r)})),o())}},O="channel"==i?null===(t=M[c])||void 0===t?void 0:t.name:null===(s=L[c])||void 0===s?void 0:s.name,V=`${d("send_to")} ${T.rR[i]}${O} `,H="channel"==i?null!==(n=M[c])&&void 0!==n&&n.is_public?D:null===(r=M[c])||void 0===r?void 0:r.members:[],S=Z==Pe;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Te,{sendMessage:E,placeholder:V}),(0,h.jsxs)("div",{className:(0,a.Z)(`send hidden md:block relative bg-gray-200 rounded-lg w-full dark:bg-gray-600 ${Z} ${b?"fullscreen":""} ${k?"reply":""} ${i}`,S&&b&&"-mt-9"),children:[k&&(0,h.jsx)(he,{context:i,mid:k,id:c}),Z==Be&&(0,h.jsx)(ce,{context:i,id:c}),(0,h.jsxs)("div",{className:(0,a.Z)("flex justify-between items-center gap-4 px-4 py-3.5",S&&"grid grid-cols-[1fr_1fr] grid-rows-[auto_auto] gap-0"),children:[(0,h.jsx)(Ve,{selectEmoji:e=>{Z==Pe&&v?v.insertText(e):f.insertText(e)}}),Z==Be&&(0,h.jsx)(te,{updateDraft:p(),initialValue:x(),members:H,id:`${i}_${c}`,placeholder:V,sendMessages:E}),(0,h.jsx)(Ie,{context:i,to:c,mode:Z,toggleMode:()=>{y((0,$.XH)(Z==Be?Pe:Be))},fullscreen:b,toggleMarkdownFullscreen:()=>{C((e=>!e))}}),Z==Pe&&(0,h.jsx)(Ge,{updateDraft:p("markdown"),initialValue:x("markdown"),height:b?"calc(100vh - 168px)":"30vh",placeholder:V,setEditorInstance:j,sendMarkdown:async e=>{I({id:c,reply_mid:k,type:"markdown",content:e,from_uid:N,properties:{local_id:+new Date}})}})]})]})]})};var Ae=s(46269),Ke=s(10189),We=s(41016),Ye=s(99181),qe=s(96117);const Qe=e=>{let{context:t,id:s}=e;const[n,a]=(0,l.useState)(!1),{canDelete:r}=(0,Ae.Z)(),{addFavorite:i}=(0,I.Z)({}),c=(0,m.CG)((e=>e.ui.selectMessages[`${t}_${s}`])),[d,o]=(0,l.useState)(!1),x=(0,m.TL)(),u=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a((e=>!e)),e&&(x((0,$.Gy)({context:t,id:s,operation:"reset"})),S.ZP.success("Messages Deleted!"))},p=()=>{o((e=>!e))};(0,B.z)("Escape",(()=>{x((0,$.Gy)({context:t,id:s,operation:"reset"}))}));const f=r(c),g="p-2 bg-slate-100 dark:bg-slate-800 rounded md:hover:bg-slate-300 dark:md:hover:bg-slate-900";return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"relative p-4 flex-center gap-8 shadow-md",children:[(0,h.jsx)("button",{className:g,onClick:p,children:(0,h.jsx)(Ke.Z,{})}),(0,h.jsx)("button",{className:g,onClick:async()=>{await i(c)?(x((0,$.Gy)({context:t,id:s,operation:"reset"})),S.ZP.success("Messages Saved!")):S.ZP.error("Operation Failed!")},children:(0,h.jsx)(We.Z,{})}),(0,h.jsx)("button",{className:g,disabled:!f,onClick:u.bind(null,!1),children:(0,h.jsx)(ie.Z,{})}),(0,h.jsx)(oe.Z,{className:"cursor-pointer absolute right-5 top-1/2 -translate-y-1/2",onClick:()=>{x((0,$.Gy)({context:t,id:s,operation:"reset"}))}})]}),d&&(0,h.jsx)(Ye.Z,{mids:c,closeModal:p}),n&&(0,h.jsx)(qe.Z,{mids:c,closeModal:u})]})};var Je=s(21645),Xe=s(34400);const et=e=>{let{placement:t="chat"}=e;const{t:s}=(0,u.$G)("welcome"),{t:l}=(0,u.$G)(),r=(0,g.I0)(),{clearLocalData:i}=(0,Xe.Z)(),c=(0,n.s0)();return(0,h.jsxs)("div",{className:(0,a.Z)("flex items-center justify-between bg-slate-200/80 dark:bg-gray-800 rounded-lg p-4 border border-solid border-gray-200 dark:border-gray-500","session"==t?"!w-[96%] md:hidden fixed bottom-2 left-1/2 -translate-x-1/2":"w-full"),children:[(0,h.jsxs)("span",{className:"text-xs md:text-base text-gray-400 dark:text-gray-100",children:[(0,h.jsx)("i",{className:"mr-2 text-xs md:text-lg ",children:"\ud83d\udc4b"}),s("sign_in_tip")]}),(0,h.jsx)(le.Z,{onClick:()=>{r((0,Je.sQ)()),i(),c("/login")},className:"small",children:l("action.login")})]})};var tt=s(51892);const st=()=>{const{t:e}=(0,u.$G)("chat"),t=(0,n.s0)();return(0,h.jsxs)("div",{className:"flex items-center justify-between bg-red-600 rounded-md w-full py-3 px-4",children:[(0,h.jsxs)("span",{className:"text-white",children:[(0,h.jsx)("i",{className:"text-xl mr-2",children:"\ud83d\udea8"}),e("license_tip")]}),(0,h.jsx)(le.Z,{onClick:()=>{t("/setting/license")},className:"small",children:"Upgrade License"})]})},lt=e=>{let{context:t,name:s}=e;const{t:l}=(0,u.$G)("chat");return(0,h.jsx)("div",{className:"flex-center absolute left-0 top-0 w-full h-full bg-black/50",children:(0,h.jsx)("div",{className:"p-4 drop-shadow-md rounded-lg bg-primary-300",children:(0,h.jsxs)("div",{className:"p-4 pt-16 border-2 border-dashed border-primary-300 rounded-md flex flex-col items-center text-white",children:[(0,h.jsx)("h4",{className:"text-xl font-semibold",children:`${l("send_to")} ${T.rR[t]}${s}`}),(0,h.jsx)("span",{className:"text-sm",children:"Photos accept jpg, png, max size limit to 10M."})]})})})};var nt,at;function rt(){return rt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},rt.apply(this,arguments)}const it=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",rt({width:32,height:32,viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,nt||(nt=l.createElement("rect",{width:32,height:32,rx:16,fill:"#FEF0C7"})),at||(at=l.createElement("path",{d:"M15.9998 13.3333V16M15.9998 18.6667H16.0064M14.8598 9.90666L9.2131 19.3333C9.09668 19.5349 9.03508 19.7635 9.03443 19.9963C9.03378 20.2292 9.0941 20.4581 9.20939 20.6603C9.32468 20.8626 9.49092 21.0312 9.69157 21.1492C9.89223 21.2673 10.1203 21.3308 10.3531 21.3333H21.6464C21.8792 21.3308 22.1073 21.2673 22.308 21.1492C22.5086 21.0312 22.6749 20.8626 22.7902 20.6603C22.9054 20.4581 22.9658 20.2292 22.9651 19.9963C22.9645 19.7635 22.9029 19.5349 22.7864 19.3333L17.1398 9.90666C17.0209 9.71073 16.8536 9.54874 16.6539 9.43632C16.4542 9.32389 16.2289 9.26483 15.9998 9.26483C15.7706 9.26483 15.5453 9.32389 15.3456 9.43632C15.146 9.54874 14.9786 9.71073 14.8598 9.90666Z",stroke:"#DC6803",strokeWidth:1.33333,strokeLinecap:"round",strokeLinejoin:"round"})))},ct=(0,l.forwardRef)(it);var dt=s(11172),ot=s(67883),xt=s(85910),mt=s(24783),ut=s(30697);const ht=e=>{let{context:t,id:s,scrollToBottom:l}=e;const{t:n}=(0,u.$G)("chat"),{readIndex:r,mids:i,messageData:c,loginUid:d}=(0,m.CG)((e=>{var l,n;return{readIndex:"channel"==t?e.footprint.readChannels[s]:e.footprint.readUsers[s],mids:"user"==t?e.userMessage.byId[s]:e.channelMessage[s],selects:e.ui.selectMessages[`${t}_${s}`],loginUid:null!==(l=null===(n=e.authData.user)||void 0===n?void 0:n.uid)&&void 0!==l?l:0,data:"channel"==t?e.channels.byId[s]:void 0,messageData:e.message||{}}})),{unreads:o=0}=(0,ut.ZP)({mids:i,readIndex:r,messageData:c,loginUid:d});return(0,h.jsx)("aside",{className:(0,a.Z)("z-[999] absolute bottom-20 right-4\n                                justify-between text-xs\n                                rounded-full py-1 px-3 text-white\n                                bg-gradient-to-tl from-[#3C8CE7] to-[#00EAFF]",o>0?"flex":"hidden"),children:(0,h.jsx)("button",{onClick:l,children:n("new_msg",{num:o})})})},pt=(0,l.forwardRef)(((e,t)=>{let{style:s,...l}=e;return(0,h.jsx)("div",{style:{...s,width:"calc(100% - 2rem)"},...l,ref:t})}));var ft=s(37076);const gt=e=>{let{cid:t}=e;const{pathname:s}=(0,n.TH)(),{t:l}=(0,u.$G)("chat"),{data:a,loginUser:r}=(0,m.CG)((e=>({loginUser:e.authData.user,data:e.channels.byId[t]})));return(0,h.jsxs)("div",{className:"pt-14 px-1 md:px-0 flex flex-col items-start gap-2",children:[(0,h.jsx)("h2",{className:"font-bold text-4xl dark:text-white",children:l("welcome_channel",{name:null===a||void 0===a?void 0:a.name})}),(0,h.jsxs)("p",{className:"text-gray-600 dark:text-gray-300",children:[l("welcome_desc",{name:null===a||void 0===a?void 0:a.name})," "]}),(null===r||void 0===r?void 0:r.is_admin)&&(0,h.jsxs)(i.OL,{to:`/setting/channel/${t}/overview?f=${s}`,className:"flex items-center gap-1 bg-clip-text text-fill-transparent bg-gradient-to-r from-blue-500 to-primary-400 ",children:[(0,h.jsx)(re.Z,{className:"w-4 h-4 fill-blue-500"}),l("edit_channel")]})]})},vt=e=>{let{context:t}=e;if(!t)return null;const{id:s,isChannel:l,loadingMore:n}=t;return(0,h.jsxs)(h.Fragment,{children:[l?(0,h.jsx)(gt,{cid:s}):null,(0,h.jsx)("div",{className:(0,a.Z)("mt-2 w-full py-2 ",n?"flex-center":"hidden"),children:(0,h.jsx)(ft.Z,{size:18,lineWeight:4,speed:1,color:"#ccc"})})]})};var jt=s(81980);const bt=e=>{let{context:t,id:s}=e;const n=(0,g.I0)(),[a,r]=(0,l.useState)(!1),[i,{isLoading:c,isSuccess:d,data:o}]=(0,mt.F0)(),x=(0,l.useRef)(null),[u]=(0,mt.o5)(),p=(0,ot.N)(u,300),{historyMid:f="",mids:v=[],selects:j,messageData:b,loginUser:C,footprint:y}=(0,m.CG)((e=>({historyMid:"user"==t?e.footprint.historyUsers[s]:e.footprint.historyChannels[s],mids:"user"==t?e.userMessage.byId[s]:e.channelMessage[s],selects:e.ui.selectMessages[`${t}_${s}`],footprint:e.footprint,loginUser:e.authData.user,messageData:e.message||{}})));(0,l.useEffect)((()=>{if(d&&o)if(0==o.length)n((0,jt.aB)({type:t,id:s,mid:"reached"}));else{const[{mid:e}]=o;n((0,jt.aB)({type:t,id:s,mid:`${e}`}))}}),[d,o,v,t,s]);const w=(0,l.useCallback)((()=>{const e=x.current;e&&e.scrollToIndex(v.length-1)}),[v]),N="channel"==t?y.readChannels[s]:y.readUsers[s];return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(xt.OO,{overscan:50,context:{loadingMore:c,id:s,isChannel:"channel"==t},id:`VOCECHAT_FEED_${t}_${s}`,className:"px-1 md:px-4 py-4.5 overflow-x-hidden overflow-y-scroll",ref:x,components:{List:pt,Header:vt},initialTopMostItemIndex:v.length-1,data:v,atTopThreshold:"channel"==t?160:0,atTopStateChange:e=>{if(e){if("reached"===f)return;let e=v.slice(0,1)[0];f&&(e=+f),i({context:t,id:s,mid:e})}},atBottomStateChange:e=>{r(e)},atBottomThreshold:400,followOutput:e=>{const[t]=v?v.slice(-1):[0],s=(new Date).getTime();return!(!e&&!(s-t<1e3))&&(!e||"smooth")},itemContent:(e,l)=>{const n=b[l];if(!n)return(0,h.jsx)("div",{className:"w-full h-[1px] invisible"});const a=0==e?null:b[v[e-1]],r=(null===n||void 0===n?void 0:n.from_uid)==(null===C||void 0===C?void 0:C.uid)||l<=N;return(0,ut.R7)({selectMode:!!j,updateReadIndex:p,read:r,prev:a,curr:n,contextId:s,context:t})}}),!a&&(0,h.jsx)(ht,{context:t,id:s,scrollToBottom:w})]})},Ct=e=>{var t,s;let{readonly:n=!1,header:r,aside:i=null,users:c=null,voice:d=null,dropFiles:o=[],context:x="channel",to:u}=e;const{reachLimit:p}=(0,tt.Z)(),{addStageFile:f}=(0,W.Z)({context:x,id:u}),g=(0,l.useRef)(null),{selects:v,channelsData:j,usersData:b,inputMode:C}=(0,m.CG)((e=>({inputMode:e.ui.inputMode,selects:e.ui.selectMessages[`${x}_${u}`],channelsData:e.channels.byId,usersData:e.users.byId}))),[{isActive:y},w]=(0,V.L)((()=>({accept:[H.FILE],drop(e){let{files:t}=e;if("text"===C){if(t.length){const e=t.map((e=>{const{size:t,type:s,name:l}=e;return{size:t,type:s,name:l,url:URL.createObjectURL(e)}}));f(e)}}else(0,S.Am)("DnD not allowed in this input mode",{icon:(0,h.jsx)(ct,{className:"w-5 h-5"})})},collect:e=>({isActive:e.canDrop()&&e.isOver()})})),[x,u,C]);(0,l.useEffect)((()=>{if(null!==o&&void 0!==o&&o.length){const e=o.map((e=>{const{size:t,type:s,name:l}=e;return{size:t,type:s,name:l,url:URL.createObjectURL(e)}}));f(e)}}),[o]);const N="channel"==x?null===(t=j[u])||void 0===t?void 0:t.name:null===(s=b[u])||void 0===s?void 0:s.name;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(dt.Z,{container:g.current}),(0,h.jsxs)("section",{ref:w,className:"relative h-full w-full rounded-r-2xl flex",children:[(0,h.jsxs)("main",{className:"flex flex-col flex-1",children:[r,(0,h.jsx)("div",{className:"w-full h-full flex items-start justify-between relative",children:(0,h.jsxs)("div",{className:"rounded-br-2xl flex flex-col absolute bottom-0 w-full h-full",ref:g,children:[(0,h.jsx)(bt,{context:x,id:u},`${x}_${u}`),(0,h.jsxs)("div",{className:"px-2 py-0 md:p-4 "+(v?"selecting":""),children:[n?(0,h.jsx)(et,{}):p?(0,h.jsx)(st,{}):(0,h.jsx)("div",{className:(0,a.Z)("flex justify-center",v&&"hidden"),children:(0,h.jsx)(ze,{id:u,context:x},u)}),v&&(0,h.jsx)(Qe,{context:x,id:u})]})]})})]}),i&&(0,h.jsx)("div",{className:(0,a.Z)("z-50 p-3 absolute right-0 top-0 translate-x-full flex-col hidden md:flex"),children:i}),c&&(0,h.jsx)("div",{className:"hidden md:block",children:c}),d&&(0,h.jsx)("div",{className:"hidden md:block",children:d}),!n&&"text"==C&&y&&(0,h.jsx)(lt,{context:x,name:N})]})]})};var yt;function wt(){return wt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},wt.apply(this,arguments)}const Nt=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",wt({width:24,height:24,viewBox:"0 0 24 24",fill:"#70707B",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,yt||(yt=l.createElement("path",{d:"M3.5 14L13.5 14.001C14.2793 14.001 14.9204 14.5963 14.9931 15.3566L15 15.501V17.5C14.999 21 11.284 22 8.5 22C5.77787 22 2.1647 21.044 2.00545 17.7296L2 17.5V15.5C2 14.7207 2.59527 14.0796 3.35561 14.0069L3.5 14ZM15.488 14H20.5C21.2793 14 21.9204 14.5944 21.9931 15.3555L22 15.5V17C21.999 20.062 19.142 21 17 21C16.32 21 15.569 20.904 14.86 20.678C15.5128 19.9277 15.9362 18.9748 15.9934 17.78L16 17.5V15.5C16 15.0056 15.8507 14.5488 15.601 14.1616L15.488 14H20.5H15.488ZM8.5 3C10.985 3 13 5.015 13 7.5C13 9.985 10.985 12 8.5 12C6.015 12 4 9.985 4 7.5C4 5.015 6.015 3 8.5 3ZM17.5 5C19.433 5 21 6.567 21 8.5C21 10.433 19.433 12 17.5 12C15.567 12 14 10.433 14 8.5C14 6.567 15.567 5 17.5 5Z"})))},kt=(0,l.forwardRef)(Nt);var Zt=s(25680),_t=s(94271),Mt=s(24007),Lt=s(89670);const Dt=e=>{let{uids:t,addVisible:s,ownerId:n,cid:a,membersVisible:r}=e;const{t:i}=(0,u.$G)("chat"),c=(0,l.useRef)(null),[o,x]=(0,l.useState)(!1),m=()=>{x((e=>!e))};return(0,h.jsxs)(h.Fragment,{children:[o&&(0,h.jsx)(Lt.Z,{cid:a,closeModal:m}),(0,h.jsxs)("div",{ref:c,className:"h-full flex-col gap-1 w-[226px] overflow-y-scroll p-2 shadow-[inset_1px_0px_0px_rgba(0,_0,_0,_0.1)] "+(r?"flex":"hidden"),children:[s&&(0,h.jsxs)("div",{className:"cursor-pointer flex items-center justify-start gap-1 select-none rounded-lg p-2.5 md:hover:bg-gray-500/10",onClick:m,children:[(0,h.jsx)(d.Z,{className:"w-6 h-6 dark:fill-slate-300"}),(0,h.jsx)("div",{className:"font-semibold text-sm text-gray-600 dark:text-gray-50",children:i("add_channel_members")})]}),(0,h.jsx)(Mt.b,{initialPrerender:15,viewportRef:c,items:t,children:e=>(0,h.jsx)(q.Z,{enableContextMenu:!0,cid:a,owner:n==e,uid:e,dm:!0,popover:!0},e)})]})]})};var It;function Et(){return Et=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},Et.apply(this,arguments)}const $t=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",Et({width:24,height:24,viewBox:"0 0 24 24",fill:"#70707B",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,It||(It=l.createElement("path",{d:"M12 2C17.5228 2 22 6.47715 22 12V19C22 20.6569 20.6569 22 19 22H16C15.4477 22 15 21.5523 15 21V15C15 14.4477 15.4477 14 16 14H20.5V12C20.5 7.30558 16.6944 3.5 12 3.5C7.30558 3.5 3.5 7.30558 3.5 12V14H8C8.55228 14 9 14.4477 9 15V21C9 21.5523 8.55228 22 8 22H5C3.34315 22 2 20.6569 2 19V12C2 6.47715 6.47715 2 12 2Z"})))},Ot=(0,l.forwardRef)($t);var Vt=s(64778),Ht=s(65809);const St=e=>{var t,s;let{id:l,context:n="channel"}=e;const{joinVoice:a,joined:r,joining:i=!1,joinedAtThisContext:c}=(0,Vt.M)({id:l,context:n}),d=(0,g.I0)(),{loginUser:x,voiceList:p,visibleAside:f}=(0,m.CG)((e=>({loginUser:e.authData.user,contextData:"channel"==n?e.channels.byId[l]:e.users.byId[l],voiceList:e.voice.list,visibleAside:"channel"==n?e.footprint.channelAsides[l]:null}))),{data:v}=(0,Ht.z7)(void 0,{skip:!(null!==x&&void 0!==x&&x.is_admin)}),{t:j}=(0,u.$G)("chat");if(!x||!x.is_admin||null===v||void 0===v||!v.enabled)return null;const b="voice"==f,C=null!==(t=null===(s=p.find((e=>e.context==n&&e.id==l)))||void 0===s?void 0:s.memberCount)&&void 0!==t?t:0,y="absolute -top-2 -right-2 w-4 h-4 rounded-full bg-primary-400 text-white ";return(0,h.jsx)(o.Z,{disabled:b,tip:j("voice"),placement:"left",children:(0,h.jsxs)("li",{className:"relative group",children:[(0,h.jsx)(Ot,{className:b?"fill-gray-600":"fill-gray-500",role:"button",onClick:c?()=>{"channel"==n&&d((0,jt.Kp)({id:l,aside:"voice"==f?null:"voice"}))}:()=>{i||r?alert("You have joined another channel, please leave first!"):(a(),"channel"==n&&d((0,jt.Kp)({id:l,aside:"voice"})))}}),b?null:(0,h.jsxs)(h.Fragment,{children:[C>0&&(0,h.jsx)("span",{className:`${y} flex-center font-bold text-[10px] group-hover:invisible`,children:C}),(0,h.jsx)("span",{className:`${y} text-xs flex-center invisible group-hover:visible`,children:(0,h.jsx)("em",{className:"not-italic",children:"+"})})]})]})})};var Ft;function Gt(){return Gt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},Gt.apply(this,arguments)}const Rt=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",Gt({width:24,height:24,viewBox:"0 0 24 24",fill:"#78787C",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,Ft||(Ft=l.createElement("path",{d:"M15 4.25V19.7456C15 20.8243 13.7255 21.3965 12.9194 20.6797L8.42793 16.686C8.29063 16.5639 8.11329 16.4965 7.92956 16.4965H4.25C3.00736 16.4965 2 15.4891 2 14.2465V9.74859C2 8.50595 3.00736 7.49859 4.25 7.49859H7.92961C8.11333 7.49859 8.29065 7.43116 8.42794 7.30909L12.9195 3.31583C13.7255 2.59915 15 3.17138 15 4.25ZM18.9916 5.89733C19.3244 5.65079 19.7941 5.72077 20.0407 6.05362C21.2717 7.7157 22 9.7739 22 12C22 14.2261 21.2717 16.2843 20.0407 17.9464C19.7941 18.2793 19.3244 18.3492 18.9916 18.1027C18.6587 17.8562 18.5888 17.3865 18.8353 17.0536C19.8815 15.6411 20.5 13.8939 20.5 12C20.5 10.1062 19.8815 8.35896 18.8353 6.94641C18.5888 6.61356 18.6587 6.14387 18.9916 5.89733ZM17.143 8.36933C17.5072 8.17214 17.9624 8.30757 18.1596 8.67184C18.6958 9.66245 19 10.7968 19 12C19 13.2032 18.6958 14.3376 18.1596 15.3282C17.9624 15.6924 17.5072 15.8279 17.143 15.6307C16.7787 15.4335 16.6432 14.9783 16.8404 14.6141C17.2609 13.8373 17.5 12.9477 17.5 12C17.5 11.0523 17.2609 10.1627 16.8404 9.38593C16.6432 9.02167 16.7787 8.56652 17.143 8.36933Z"})))},Ut=(0,l.forwardRef)(Rt);var Tt,Bt;function Pt(){return Pt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},Pt.apply(this,arguments)}const zt=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",Pt({width:24,height:24,viewBox:"0 0 24 24",fill:"#78787C",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,Tt||(Tt=l.createElement("path",{d:"M15 4.25V19.7456C15 20.8243 13.7255 21.3965 12.9194 20.6797L8.42793 16.686C8.29063 16.5639 8.11329 16.4965 7.92956 16.4965H4.25C3.00736 16.4965 2 15.4891 2 14.2465V9.74859C2 8.50595 3.00736 7.49859 4.25 7.49859H7.92961C8.11333 7.49859 8.29065 7.43116 8.42794 7.30909L12.9195 3.31583C13.7255 2.59915 15 3.17138 15 4.25ZM18.9916 5.89733C19.3244 5.65079 19.7941 5.72077 20.0407 6.05362C21.2717 7.7157 22 9.7739 22 12C22 14.2261 21.2717 16.2843 20.0407 17.9464C19.7941 18.2793 19.3244 18.3492 18.9916 18.1027C18.6587 17.8562 18.5888 17.3865 18.8353 17.0536C19.8815 15.6411 20.5 13.8939 20.5 12C20.5 10.1062 19.8815 8.35896 18.8353 6.94641C18.5888 6.61356 18.6587 6.14387 18.9916 5.89733ZM17.143 8.36933C17.5072 8.17214 17.9624 8.30757 18.1596 8.67184C18.6958 9.66245 19 10.7968 19 12C19 13.2032 18.6958 14.3376 18.1596 15.3282C17.9624 15.6924 17.5072 15.8279 17.143 15.6307C16.7787 15.4335 16.6432 14.9783 16.8404 14.6141C17.2609 13.8373 17.5 12.9477 17.5 12C17.5 11.0523 17.2609 10.1627 16.8404 9.38593C16.6432 9.02167 16.7787 8.56652 17.143 8.36933Z"})),Bt||(Bt=l.createElement("path",{d:"M2.88667 2.21966C3.17956 1.92677 3.65444 1.92678 3.94733 2.21968L22.4471 20.7198C22.74 21.0127 22.74 21.4876 22.4471 21.7805C22.1542 22.0734 21.6793 22.0734 21.3864 21.7805L2.88666 3.28032C2.59377 2.98743 2.59377 2.51255 2.88667 2.21966Z",fill:"#D92D20"})))},At=(0,l.forwardRef)(zt);var Kt;function Wt(){return Wt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},Wt.apply(this,arguments)}const Yt=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",Wt({width:24,height:24,viewBox:"0 0 24 24",fill:"#78787C",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,Kt||(Kt=l.createElement("path",{d:"M18.25 11C18.6297 11 18.9435 11.2822 18.9932 11.6482L19 11.75V12.25C19 15.8094 16.245 18.7254 12.751 18.9817L12.75 21.25C12.75 21.6642 12.4142 22 12 22C11.6203 22 11.3065 21.7178 11.2568 21.3518L11.25 21.25L11.25 18.9818C7.83323 18.7316 5.12283 15.938 5.00406 12.4863L5 12.25V11.75C5 11.3358 5.33579 11 5.75 11C6.1297 11 6.44349 11.2822 6.49315 11.6482L6.5 11.75V12.25C6.5 15.077 8.73445 17.3821 11.5336 17.4956L11.75 17.5H12.25C15.077 17.5 17.3821 15.2656 17.4956 12.4664L17.5 12.25V11.75C17.5 11.3358 17.8358 11 18.25 11ZM12 2C14.2091 2 16 3.79086 16 6V12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12V6C8 3.79086 9.79086 2 12 2Z"})))},qt=(0,l.forwardRef)(Yt);var Qt,Jt;function Xt(){return Xt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},Xt.apply(this,arguments)}const es=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",Xt({width:24,height:24,viewBox:"0 0 24 24",fill:"#78787C",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,Qt||(Qt=l.createElement("path",{d:"M3.94733 2.21968C3.65444 1.92678 3.17956 1.92677 2.88667 2.21966C2.59377 2.51255 2.59377 2.98743 2.88666 3.28032L8.66699 9.06078V12C8.66699 14.2091 10.4579 16 12.667 16C13.5005 16 14.2744 15.7451 14.9151 15.309L16.061 16.4549C15.1846 17.1112 14.0962 17.5 12.917 17.5H12.417L12.2006 17.4956C9.40144 17.3821 7.16699 15.077 7.16699 12.25V11.75L7.16015 11.6482C7.11048 11.2822 6.79669 11 6.41699 11C6.00278 11 5.66699 11.3358 5.66699 11.75V12.25L5.67105 12.4863C5.78983 15.938 8.50022 18.7316 11.917 18.9818L11.917 21.25L11.9238 21.3518C11.9735 21.7178 12.2873 22 12.667 22C13.0812 22 13.417 21.6642 13.417 21.25L13.418 18.9817C14.8169 18.8791 16.0975 18.35 17.1301 17.5241L21.3864 21.7805C21.6793 22.0734 22.1542 22.0734 22.4471 21.7805C22.74 21.4876 22.74 21.0127 22.4471 20.7198L3.94733 2.21968ZM17.8631 14.0144L19.0091 15.1604C19.4308 14.2791 19.667 13.2921 19.667 12.25V11.75L19.6601 11.6482C19.6105 11.2822 19.2967 11 18.917 11C18.5028 11 18.167 11.3358 18.167 11.75V12.25L18.1626 12.4664C18.1407 13.0075 18.0368 13.5276 17.8631 14.0144ZM8.80467 4.95575L16.5971 12.7483C16.643 12.5059 16.667 12.2558 16.667 12V6C16.667 3.79086 14.8761 2 12.667 2C10.8191 2 9.26391 3.25302 8.80467 4.95575Z"})),Jt||(Jt=l.createElement("path",{d:"M2.88667 2.21966C3.17956 1.92677 3.65444 1.92678 3.94733 2.21968L22.4471 20.7198C22.74 21.0127 22.74 21.4876 22.4471 21.7805C22.1542 22.0734 21.6793 22.0734 21.3864 21.7805L2.88666 3.28032C2.59377 2.98743 2.59377 2.51255 2.88667 2.21966Z",fill:"#D92D20"})))},ts=(0,l.forwardRef)(es);var ss;function ls(){return ls=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},ls.apply(this,arguments)}const ns=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",ls({width:24,height:24,viewBox:"0 0 24 24",fill:"white",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,ss||(ss=l.createElement("path",{d:"M21.7806 2.21967C22.0735 2.51256 22.0735 2.98744 21.7806 3.28033L18.5609 6.5L21.7806 9.71967C22.0735 10.0126 22.0735 10.4874 21.7806 10.7803C21.4877 11.0732 21.0128 11.0732 20.7199 10.7803L17.5002 7.56066L14.2806 10.7803C13.9877 11.0732 13.5128 11.0732 13.2199 10.7803C12.927 10.4874 12.927 10.0126 13.2199 9.71967L16.4396 6.5L13.2199 3.28033C12.927 2.98744 12.927 2.51256 13.2199 2.21967C13.5128 1.92678 13.9877 1.92678 14.2806 2.21967L17.5002 5.43934L20.7199 2.21967C21.0128 1.92678 21.4877 1.92678 21.7806 2.21967ZM9.36737 3.31232L10.2271 5.33967C10.6018 6.22312 10.3939 7.26203 9.71313 7.90815L7.81881 9.70616C7.93569 10.7816 8.2972 11.8406 8.90334 12.8832C9.50948 13.9257 10.2665 14.7905 11.1744 15.4776L13.4496 14.7189C14.312 14.4313 15.2512 14.7618 15.7802 15.539L17.0125 17.3495C17.6275 18.2529 17.5169 19.4993 16.7538 20.2653L15.9361 21.0862C15.1222 21.9033 13.9597 22.1997 12.8843 21.8643C10.3454 21.0723 8.01109 18.7211 5.88132 14.8107C3.74845 10.8945 2.9957 7.57189 3.62307 4.84289C3.88707 3.69457 4.70458 2.78009 5.77209 2.43899L6.84868 2.09498C7.8575 1.77263 8.93535 2.29358 9.36737 3.31232Z"})))},as=(0,l.forwardRef)(ns),rs=e=>{let{info:t,setMute:s,setDeafen:l,leave:n}=e;const{t:r}=(0,u.$G)("chat"),{userData:i,voicingMembers:c}=(0,m.CG)((e=>({userData:e.users.byId,voicingMembers:e.voice.voicingMembers})));if(!t)return null;const{deafen:d,muted:x}=t,p=(0,a.Z)("text-sm text-gray-500 max-w-[120px] truncate font-semibold dark:text-white"),f=c.ids,g=c.byId;return t.joining?(0,h.jsx)("div",{className:"w-full h-full flex-center p-1 text-sm text-gray-600 dark:text-gray-400",children:"Connecting to voice channel..."}):"RECONNECTING"==t.connectionState?(0,h.jsxs)("div",{className:"w-full h-full flex-center flex-col gap-1 p-1 ",children:[(0,h.jsx)("span",{className:"text-red-300",children:"Reconnecting..."}),(0,h.jsx)("span",{className:"text-xs text-red-500",children:"Please check network connection!"})]}):(0,h.jsxs)("div",{className:"w-full h-full py-2 flex flex-col",children:[(0,h.jsx)("ul",{className:"flex grow flex-col",children:f.map((e=>{const t=i[e];if(!t)return null;const{muted:s,speakingVolume:l=0}=g[e],n=l>50;return(0,h.jsxs)("li",{className:"flex items-center justify-between gap-6 pb-4 ",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2 transition-opacity",children:[(0,h.jsxs)("div",{className:(0,a.Z)("w-8 h-8 flex shrink-0 relative"),children:[n&&(0,h.jsx)("div",{className:"z-10 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 opacity-0 rounded-full bg-green-500 animate-speaking w-[36px] h-[36px]"}),(0,h.jsx)(Z.Z,{width:32,height:32,className:"w-full h-full rounded-full object-cover z-20",src:t.avatar,name:t.name,alt:"avatar"})]}),(0,h.jsx)("span",{className:p,title:null===t||void 0===t?void 0:t.name,children:null===t||void 0===t?void 0:t.name})]}),(0,h.jsx)("div",{className:"flex items-center gap-2",children:s?(0,h.jsx)(ts,{className:"w-4 fill-gray-500 dark:fill-gray-400"}):(0,h.jsx)(qt,{className:"w-4 fill-gray-500  dark:fill-gray-400"})})]},e)}))}),(0,h.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,h.jsxs)("ul",{className:"flex justify-between",children:[(0,h.jsx)(o.Z,{tip:r(d?"undeafen":"deafen"),placement:"top",children:(0,h.jsx)("li",{role:"button",onClick:l.bind(null,!d),className:"py-2 px-3 rounded bg-gray-100 dark:bg-gray-900",children:d?(0,h.jsx)(At,{className:"fill-gray-700 dark:fill-gray-300"}):(0,h.jsx)(Ut,{className:"fill-gray-700 dark:fill-gray-300"})})}),(0,h.jsx)(o.Z,{tip:r(x?"unmute":"mute"),placement:"top",children:(0,h.jsx)("li",{role:"button",onClick:s.bind(null,!x),className:"py-2 px-3 rounded bg-gray-100 dark:bg-gray-900",children:x?(0,h.jsx)(ts,{className:"fill-gray-700 dark:fill-gray-300"}):(0,h.jsx)(qt,{className:"fill-gray-700 dark:fill-gray-300"})})})]}),(0,h.jsx)(le.Z,{onClick:n,className:"bg-red-600 hover:!bg-red-700 text-center",children:(0,h.jsx)(o.Z,{tip:r("leave_voice"),placement:"top",offset:[0,24],children:(0,h.jsx)(as,{className:"m-auto"})})})]})]})},is=e=>{let{context:t="channel",id:s,visible:l}=e;const{voicingInfo:n,setMute:a,setDeafen:r,leave:i}=(0,Vt.M)({id:s,context:t});return(0,h.jsx)("div",{className:"h-full flex-col gap-1 w-[226px] overflow-y-scroll overflow-x-hidden p-2 shadow-[inset_1px_0px_0px_rgba(0,_0,_0,_0.1)] "+(l?"flex":"hidden"),children:(0,h.jsx)(rs,{info:n,setMute:a,setDeafen:r,leave:i})})};function cs(e){var t;let{cid:s=0,dropFiles:a=[]}=e;const{t:r}=(0,u.$G)("chat"),{pathname:i}=(0,n.TH)(),d=(0,n.s0)(),x=(0,g.I0)(),{userIds:p,data:f,loginUser:v,visibleAside:j}=(0,m.CG)((e=>({loginUser:e.authData.user,userIds:e.users.ids,data:e.channels.byId[s],visibleAside:e.footprint.channelAsides[s]})));(0,l.useEffect)((()=>{f||d("/chat")}),[f]),(0,l.useEffect)((()=>(x((0,$.cp)()),()=>{x((0,$.cp)({path:i}))})),[i]);if(!f)return null;const{name:b,description:C,is_public:y,members:w=[],owner:N}=f,k=y?p:w.slice(0).sort((e=>e==N?-1:0)),Z=(null===v||void 0===v?void 0:v.is_admin)||N==(null===v||void 0===v?void 0:v.uid),_=(null===f||void 0===f||null===(t=f.pinned_messages)||void 0===t?void 0:t.length)||0,M="relative cursor-pointer";return(0,h.jsx)(Ct,{to:s,context:"channel",dropFiles:a,aside:(0,h.jsxs)("ul",{className:"flex flex-col gap-6",children:[(0,h.jsx)(o.Z,{tip:r("pin"),placement:"left",children:(0,h.jsx)(c.ZP,{placement:"left-start",popperOptions:{strategy:"fixed"},offset:[0,150],interactive:!0,trigger:"click",content:(0,h.jsx)(L,{id:s}),children:(0,h.jsxs)("li",{className:`${M}`,children:[_>0?(0,h.jsx)("span",{className:"absolute -top-2 -right-2 flex-center w-4 h-4 rounded-full bg-primary-400 text-white font-bold text-[10px]",children:_}):null,(0,h.jsx)(Zt.Z,{className:"fill-gray-500"})]})})}),(0,h.jsx)(St,{context:"channel",id:s}),(0,h.jsx)(o.Z,{tip:r("fav"),placement:"left",children:(0,h.jsx)(c.ZP,{placement:"left-start",popperOptions:{strategy:"fixed"},offset:[0,164],interactive:!0,trigger:"click",content:(0,h.jsx)(E,{cid:s}),children:(0,h.jsx)("li",{className:`${M}`,children:(0,h.jsx)(We.Z,{className:"fill-gray-500"})})})}),(0,h.jsx)("li",{className:`${M}`,onClick:()=>{x((0,jt.Kp)({id:s,aside:"members"!==j?"members":null}))},children:(0,h.jsx)(o.Z,{tip:r("channel_members"),placement:"left",children:(0,h.jsx)(kt,{className:"members"==j?"fill-gray-600":""})})})]}),header:(0,h.jsxs)("header",{className:"px-5 py-4 flex items-center justify-center md:justify-between shadow-[inset_0_-1px_0_rgb(0_0_0_/_10%)]",children:[(0,h.jsx)(_t.Z,{}),(0,h.jsxs)("div",{className:"flex items-center gap-1",children:[(0,h.jsx)(O.Z,{personal:!y}),(0,h.jsx)("span",{className:"text-gray-800 dark:text-white",children:b}),(0,h.jsx)("span",{className:"ml-2 text-gray-500 hidden md:block",children:C})]})]}),users:(0,h.jsx)(Dt,{uids:k,addVisible:Z,cid:s,ownerId:N,membersVisible:"members"==j}),voice:(0,h.jsx)(is,{visible:"voice"==j,id:s,context:"channel"})})}const ds=(0,l.memo)(cs,((e,t)=>e.cid==t.cid)),os=e=>{let{uid:t=0,dropFiles:s}=e;const a=(0,n.s0)(),{currUser:r}=(0,m.CG)((e=>({currUser:e.users.byId[t]})));return(0,l.useEffect)((()=>{r||a("/chat")}),[r]),r?(0,h.jsx)(Ct,{to:t,context:"user",dropFiles:s,aside:(0,h.jsx)("ul",{className:"flex flex-col gap-6",children:(0,h.jsx)(o.Z,{tip:"Saved Items",placement:"left",children:(0,h.jsx)(c.ZP,{placement:"left-start",popperOptions:{strategy:"fixed"},offset:[0,180],interactive:!0,trigger:"click",content:(0,h.jsx)(E,{uid:t}),children:(0,h.jsx)("li",{className:"relative cursor-pointer fav",children:(0,h.jsx)(We.Z,{className:"fill-gray-500"})})})})}),header:(0,h.jsxs)("header",{className:"box-border px-5 py-1 flex items-center justify-center md:justify-between shadow-[inset_0_-1px_0_rgb(0_0_0_/_10%)]",children:[(0,h.jsx)(_t.Z,{}),(0,h.jsx)(q.Z,{interactive:!1,uid:r.uid})]})}):null};var xs=s(59476),ms=s(18879),us=s(52334),hs=s(79198),ps=s(50911);const fs=e=>{let{context:t="dm",id:s,visible:l,mid:a,hide:r,deleteChannel:i,setInviteChannelId:d,children:o}=e;const{t:x}=(0,u.$G)(),{canCopyEmail:p,copyEmail:f,canDeleteChannel:v,canInviteChannel:j}=(0,ps.Z)({uid:"dm"==t?s:void 0,cid:"channel"==t?s:void 0}),[b]=(0,us.bI)(),[C]=(0,mt.o5)(),y=(0,n.bS)(`/chat/dm/${s}`),w=(0,g.I0)(),N=(0,n.s0)(),{pathname:k}=(0,n.TH)(),{channelMuted:Z}=(0,m.CG)((e=>({channelMuted:"channel"==t&&e.footprint.muteChannels[s]}))),_=()=>{if(a){C("dm"==t?{users:[{uid:+s,mid:a}]}:{groups:[{gid:+s,mid:a}]})}},M="dm"==t?[{title:x("action.mark_read"),handler:_},{title:x("setting"),handler:()=>{N(`/setting/dm/${s}/overview?f=${k}`)}},p&&{title:x("action.copy_email"),handler:f},{title:x("action.hide_session"),danger:!0,handler:()=>{w((0,U.So)(s)),y&&N("/chat")}}]:[{title:x("setting"),underline:!0,handler:()=>{N(`/setting/channel/${s}/overview?f=${k}`)}},{title:x("action.mark_read"),handler:_},{title:x(Z?"action.unmute":"action.mute"),handler:()=>{b(Z?{remove_groups:[s]}:{add_groups:[{gid:s}]})}},j&&{title:x("action.invite_people"),handler:d.bind(null,s)},v&&{title:x("action.delete_channel"),danger:!0,handler:i.bind(null,s)}];return(0,h.jsx)(c.ZP,{interactive:!0,placement:"right-start",popperOptions:{strategy:"fixed"},followCursor:"initial",visible:l,onClickOutside:r,content:(0,h.jsx)(hs.Z,{hideMenu:r,items:M.filter(Boolean)}),children:o})};var gs;function vs(){return vs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},vs.apply(this,arguments)}const js=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",vs({width:5,height:8,viewBox:"0 0 5 8",fill:"#616161",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,gs||(gs=l.createElement("path",{d:"M4.1875 3.16699V2.33366C4.1875 1.40033 3.375 0.666992 2.5 0.666992C1.625 0.666992 0.833333 1.40033 0.833333 2.33366V3.16699C0.373083 3.16699 0 3.54009 0 4.00032V6.50032C0 6.96056 0.373083 7.33366 0.833333 7.33366H2.5H4.16667C4.62692 7.33366 5 6.96056 5 6.50032V3.97949C5 3.53076 4.63625 3.16699 4.1875 3.16699ZM3.33333 3.16699H1.66667V2.33366C1.66667 1.85747 2.05558 1.50033 2.5 1.50033C2.94442 1.50033 3.33333 1.85747 3.33333 2.33366V3.16699Z"})))},bs=(0,l.forwardRef)(js);var Cs,ys,ws;function Ns(){return Ns=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},Ns.apply(this,arguments)}const ks=(e,t)=>{let{title:s,titleId:n,...a}=e;return l.createElement("svg",Ns({width:28,height:28,viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},a),s?l.createElement("title",{id:n},s):null,Cs||(Cs=l.createElement("rect",{x:2,y:2,width:24,height:24,rx:12,fill:"#12B76A"})),ys||(ys=l.createElement("path",{d:"M14.9995 8.50001C14.9995 8.29898 14.8791 8.11749 14.6939 8.03934C14.5086 7.96119 14.2946 8.00157 14.1506 8.14185L11.2239 10.9927H9.49951C8.67108 10.9927 7.99951 11.6643 7.99951 12.4927V15.4817C7.99951 16.3101 8.67108 16.9817 9.49951 16.9817H11.2227L14.1491 19.8567C14.2928 19.9978 14.5071 20.039 14.6929 19.9611C14.8786 19.8832 14.9995 19.7014 14.9995 19.5V8.50001ZM16.1108 11.1887C16.2827 10.9726 16.5972 10.9368 16.8133 11.1087L16.8142 11.1094L16.8151 11.1102L16.8173 11.1119L16.8226 11.1163L16.8376 11.1288C16.8494 11.1388 16.8647 11.1522 16.883 11.169C16.9196 11.2026 16.9684 11.2499 17.0252 11.3112C17.1387 11.4336 17.2852 11.613 17.4302 11.8514C17.7217 12.331 18.0038 13.0444 18.0038 13.9986C18.0038 14.9527 17.7217 15.6669 17.4304 16.1471C17.2855 16.3859 17.1392 16.5657 17.0258 16.6884C16.9691 16.7498 16.9203 16.7973 16.8837 16.8309C16.8641 16.849 16.8439 16.8666 16.8235 16.8838L16.815 16.8907L16.8142 16.8914C16.8142 16.8914 16.3679 17.1337 16.1115 16.8129C15.9399 16.5983 15.9738 16.2858 16.1866 16.1128L16.1882 16.1115L16.1874 16.1122L16.1891 16.1108L16.1882 16.1115C16.1911 16.109 16.1974 16.1036 16.2065 16.0952C16.2247 16.0784 16.2542 16.05 16.2913 16.0098C16.3658 15.9292 16.4699 15.8025 16.5754 15.6285C16.785 15.283 17.0038 14.7461 17.0038 13.9986C17.0038 13.2511 16.785 12.7152 16.5757 12.3709C16.4702 12.1974 16.3662 12.0712 16.2919 11.9911C16.2548 11.951 16.2254 11.9228 16.2072 11.9061C16.1981 11.8978 16.1919 11.8924 16.189 11.89L16.19 11.8907C15.9743 11.7187 15.939 11.4047 16.1108 11.1887ZM17.8126 9.10886C17.5965 8.93686 17.282 8.97255 17.11 9.18858C16.938 9.40451 16.9742 9.71932 17.1899 9.89138L17.201 9.9006C17.2118 9.90975 17.2293 9.92484 17.2526 9.94582C17.2993 9.98781 17.3688 10.0532 17.4537 10.1413C17.6238 10.3179 17.8536 10.5841 18.084 10.9351C18.5445 11.6364 19.0028 12.6685 19.0028 14.004C19.0028 15.3395 18.5445 16.3694 18.0843 17.0685C17.854 17.4184 17.6243 17.6835 17.4544 17.8593C17.3696 17.947 17.3001 18.0121 17.2535 18.0538C17.2302 18.0747 17.2127 18.0897 17.2019 18.0988L17.1903 18.1083L17.1894 18.1091C16.9741 18.2808 16.9381 18.5945 17.1092 18.8105C17.2807 19.0269 17.5959 19.0628 17.8124 18.8913L17.8453 18.8642C17.8639 18.8487 17.8893 18.8268 17.9208 18.7986C17.9837 18.7423 18.0705 18.6607 18.1734 18.5543C18.3788 18.3418 18.6495 18.0286 18.9196 17.6183C19.4603 16.797 20.0028 15.5788 20.0028 14.004C20.0028 12.4293 19.4603 11.2094 18.9199 10.3863C18.6499 9.97503 18.3793 9.66089 18.1741 9.4477C18.0713 9.34097 17.9844 9.25908 17.9216 9.20255C17.8902 9.17426 17.8647 9.15228 17.8462 9.13665L17.8238 9.11798L17.8167 9.11222L17.8143 9.11024L17.8126 9.10886ZM16.189 11.89L16.1876 11.8887L16.189 11.89Z",fill:"white"})),ws||(ws=l.createElement("rect",{x:2,y:2,width:24,height:24,rx:12,stroke:"white",strokeWidth:4})))},Zs=(0,l.forwardRef)(ks);var _s=s(47438);const Ms=e=>{let{type:t="dm",id:s,mid:r,setDeleteChannelId:c,setInviteChannelId:d}=e;const o="dm"==t?`/chat/dm/${s}`:`/chat/channel/${s}`,x=(0,n.bS)(o),u=(0,n.s0)(),{addStageFile:p}=(0,W.Z)({context:t,id:s}),[{isActive:f},g]=(0,V.L)((()=>({accept:[H.FILE],drop(e){let{files:l}=e;if(l.length){const e=l.map((e=>{const{size:t,type:s,name:l}=e;return{size:t,type:s,name:l,url:URL.createObjectURL(e)}}));p(e),u("dm"==t?`/chat/dm/${s}`:`/chat/channel/${s}`)}},collect:e=>({isActive:e.canDrop()&&e.isOver()})})),[t,s]),{visible:v,handleContextMenuEvent:j,hideContextMenu:b}=(0,_s.Z)(),[C,y]=(0,l.useState)(),{messageData:w,userData:N,channelData:k,readIndex:M,loginUid:L,mids:D,muted:I,voiceList:E}=(0,m.CG)((e=>{var l;return{voiceList:e.voice.list,mids:"dm"==t?e.userMessage.byId[s]:e.channelMessage[s],loginUid:(null===(l=e.authData.user)||void 0===l?void 0:l.uid)||0,readIndex:"dm"==t?e.footprint.readUsers[s]:e.footprint.readChannels[s],messageData:e.message,userData:e.users.byId,channelData:e.channels.byId,muted:"dm"==t?e.footprint.muteUsers[s]:e.footprint.muteChannels[s]}}));if((0,l.useEffect)((()=>{const e="dm"==t?N[s]:k[s];if(e)if("avatar"in e){const{name:t,avatar:s}=e;y({name:t,icon:s,mid:r,is_public:!0})}else{const{name:t,icon:s="",is_public:l}=e;y({name:t,icon:s,mid:r,is_public:l})}}),[s,r,t,N,k]),!C)return null;const $=w[r]||{},{name:O,icon:S,is_public:F}=C,{unreads:G=0}=(0,ut.ZP)({mids:D,readIndex:M,messageData:w,loginUid:L}),R="channel"==t&&E.findIndex((e=>e.id==s))>-1;return(0,h.jsx)("li",{className:"session",children:(0,h.jsx)(fs,{visible:v,hide:b,context:t,id:s,mid:r,setInviteChannelId:d,deleteChannel:c,children:(0,h.jsxs)(i.OL,{ref:g,className:e=>{let{isActive:t}=e;return(0,a.Z)("nav flex gap-2 rounded-lg p-2 w-full md:hover:bg-gray-500/20",f&&"shadow-[inset_0_0_0_2px_#52edff]",t&&"bg-gray-500/20")},to:o,onContextMenu:j,children:[(0,h.jsxs)("div",{className:"flex shrink-0 relative w-10 h-10",children:["dm"==t?(0,h.jsx)(q.Z,{avatarSize:40,compact:!0,interactive:!1,uid:s}):(0,h.jsx)(Z.Z,{width:40,height:40,className:"icon rounded-full object-cover",type:"channel",name:O,src:S}),R&&(0,h.jsx)(Zs,{className:"top-0 -right-[7px] absolute w-6 h-6"})]}),(0,h.jsxs)("div",{className:"w-full flex flex-col justify-between overflow-hidden",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between ",children:[(0,h.jsxs)("span",{className:(0,a.Z)("flex items-center gap-1"),children:[(0,h.jsx)("i",{className:(0,a.Z)("not-italic font-semibold text-sm text-gray-500 dark:text-white max-w-[120px] truncate",!$.created_at&&"max-w-[190px]"),children:O}),!F&&(0,h.jsx)(bs,{className:"dark:fill-gray-400"})]}),(0,h.jsx)("span",{className:(0,a.Z)("text-xs text-gray-500 dark:text-gray-400 max-w-[80px] truncate font-semibold"),children:(0,_.Lf)($.created_at)})]}),(0,h.jsxs)("div",{className:"flex items-center justify-between",children:[(0,h.jsx)("span",{className:(0,a.Z)("text-xs text-gray-500 dark:text-gray-400  truncate",G>0?"w-36":""),children:(0,ut.DH)($)}),G>0&&!x&&(0,h.jsx)("strong",{className:(0,a.Z)("text-white px-1.5 py-[3px] bg-primary-400 font-bold text-[10px] leading-[10px] rounded-[10px]",I&&"bg-gray-500"),children:G>99?"99+":G})]})]})]})})})};var Ls=s(77493);const Ds=e=>{let{tempSession:t}=e;const s=(0,l.useRef)(null),[n,a]=(0,l.useState)(),[r,i]=(0,l.useState)(),[c,d]=(0,l.useState)([]),{channelIDs:o,DMs:x,readChannels:u,readUsers:p,channelMessage:f,userMessage:g,loginUid:v}=(0,m.CG)((e=>{var t;return{loginUid:null===(t=e.authData.user)||void 0===t?void 0:t.uid,channelIDs:e.channels.ids,DMs:e.userMessage.ids,userMessage:e.userMessage.byId,channelMessage:e.channelMessage,readChannels:e.footprint.readChannels,readUsers:e.footprint.readUsers}}));return(0,l.useEffect)((()=>{const e=[...o.map((e=>{const t=f[e];if(!t||0==t.length)return{unreads:0,id:e,type:"channel"};return{id:e,mid:[...t].sort(((e,t)=>+e-+t)).pop(),type:"channel"}})),...x.map((e=>{const t=g[e];if(!t||0==t.length)return{unreads:0,id:e,type:"dm"};return{type:"dm",id:e,mid:[...t].sort(((e,t)=>+e-+t)).pop()}}))].sort(((e,t)=>{const{mid:s=0}=e,{mid:l=0}=t;return l-s})),s=t?[t,...e]:e;d(s)}),[o,x,f,u,p,v,g,t]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("ul",{ref:s,className:"flex flex-1 flex-col gap-0.5 p-2 overflow-auto",children:(0,h.jsx)(Mt.b,{initialPrerender:10,viewportRef:s,items:c,children:e=>{const{type:t,id:s,mid:l=0}=e,n=`${t}_${s}`;return(0,h.jsx)(Ms,{type:t,id:s,mid:l,setInviteChannelId:i,setDeleteChannelId:a},n)}})}),!!n&&(0,h.jsx)(Ls.Z,{id:n,closeModal:()=>{a(0)}}),!!r&&(0,h.jsx)(Lt.Z,{type:"channel",cid:r,closeModal:()=>{i(0)}})]})},Is=(0,l.memo)(Ds);var Es=s(43764);const $s=()=>{const{t:e}=(0,u.$G)("auth"),t=(0,g.I0)(),{clearLocalData:s}=(0,Xe.Z)(),l=(0,n.s0)(),a=(0,m.CG)((e=>e.server.name));return(0,h.jsxs)("section",{className:"flex flex-col items-center text-center",children:[(0,h.jsx)("h2",{className:"text-3xl text-gray-600 dark:text-gray-50 font-bold",children:e("welcome",{name:a})}),(0,h.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,h.jsx)("span",{className:"text-gray-400 dark:text-gray-200 my-3 text-sm",children:e("guest_login_tip")}),(0,h.jsx)("div",{className:"w-44 h-44 self-center mb-4",children:(0,h.jsx)(Es.Z,{level:"Q",size:1200,link:`https://voce.chat/login?s=${encodeURIComponent(T.Ci)}`})}),(0,h.jsx)(le.Z,{onClick:()=>{t((0,Je.sQ)()),s(),l("/login")},className:"small",children:e("sign_in")})]})]})};function Os(e){let{cid:t=0}=e;const{data:s}=(0,m.CG)((e=>({data:e.channels.byId[t]})));if(!s)return null;const{name:l,description:n,is_public:a}=s;return(0,h.jsx)(Ct,{readonly:!0,to:t,context:"channel",header:(0,h.jsxs)("header",{className:"px-5 py-4 flex items-center justify-center md:justify-between shadow-[inset_0_-1px_0_rgb(0_0_0_/_10%)]",children:[(0,h.jsx)(_t.Z,{}),(0,h.jsxs)("div",{className:"flex items-center gap-1",children:[(0,h.jsx)(O.Z,{personal:!a}),(0,h.jsx)("span",{className:"text-gray-800 dark:text-white",children:l}),(0,h.jsx)("span",{className:"ml-2 text-gray-500 hidden md:block ",children:n})]})]})})}const Vs=e=>{let{id:t,mid:s}=e;const[n,r]=(0,l.useState)(),{messageData:c,userData:d,channelData:o}=(0,m.CG)((e=>({messageData:e.message,userData:e.users.byId,channelData:e.channels.byId})));if((0,l.useEffect)((()=>{const e=o[t];if(!e)return;const{name:l,icon:n="",is_public:a}=e;r({name:l,icon:n,mid:s,is_public:a})}),[t,s,d,o]),!n)return null;const x=c[s]||{},{name:u,icon:p}=n;return(0,h.jsx)("li",{className:"session",children:(0,h.jsxs)(i.OL,{className:e=>{let{isActive:t}=e;return(0,a.Z)("nav flex gap-2 rounded-lg p-2 w-full md:hover:bg-gray-500/20",t&&"bg-gray-500/20")},to:`/chat/channel/${t}`,children:[(0,h.jsx)("div",{className:"flex shrink-0",children:(0,h.jsx)(Z.Z,{width:40,height:40,className:"icon rounded-full",type:"channel",name:u,src:p})}),(0,h.jsxs)("div",{className:"w-full flex flex-col justify-between",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between",children:[(0,h.jsx)("span",{className:(0,a.Z)("flex items-center gap-2 font-semibold text-sm text-gray-500 dark:text-white truncate",x.created_at&&"max-w-[190px]"),children:u}),(0,h.jsx)("span",{className:"text-xs text-gray-600 max-w-[80px] truncate",children:(0,_.Lf)(x.created_at)})]}),(0,h.jsx)("div",{className:"flex items-center justify-between",children:(0,h.jsx)("span",{className:"text-xs text-gray-500 w-36 truncate",children:(0,ut.DH)(x)})})]})]})})},Hs=()=>{const[e,t]=(0,l.useState)([]),{channelIDs:s,readChannels:n,readUsers:a,channelMessage:r,userMessage:i,loginUid:c}=(0,m.CG)((e=>{var t;return{loginUid:null===(t=e.authData.user)||void 0===t?void 0:t.uid,channelIDs:e.channels.ids,userMessage:e.userMessage.byId,channelMessage:e.channelMessage,readChannels:e.footprint.readChannels,readUsers:e.footprint.readUsers}}));return(0,l.useEffect)((()=>{const e=[...s.map((e=>{const t=r[e];if(!t||0==t.length)return{key:`channel_${e}`,unreads:0,id:e,type:"channel"};return{key:`channel_${e}`,id:e,mid:[...t].sort().pop(),type:"channel"}}))].sort(((e,t)=>{const{mid:s=0}=e,{mid:l=0}=t;return l-s}));t(e)}),[s,r,n,a,c,i]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("ul",{className:"flex-1 flex flex-col gap-0.5 p-2 overflow-auto",children:e.map((e=>{const{key:t,id:s,mid:l=0}=e;return(0,h.jsx)(Vs,{id:s,mid:l},t)}))}),(0,h.jsx)(et,{placement:"session"})]})};var Ss=s(83825);function Fs(e){let{error:t,resetErrorBoundary:s}=e;return(0,h.jsxs)("div",{role:"alert",className:"text-lg text-red-600",children:[(0,h.jsx)("p",{children:"Something went wrong:"}),(0,h.jsx)("pre",{children:t.message}),(0,h.jsx)("button",{onClick:s,children:"Try again"})]})}const Gs=e=>{let{children:t}=e;return(0,h.jsx)(Ss.SV,{FallbackComponent:Fs,children:t})},Rs=e=>{let{strength:t=0}=e;const s=6-t,l=s<=2?"bg-red-700":3==s?"bg-yellow-700":"bg-green-700";let n=" bg-gray-500";return(0,h.jsx)("div",{className:"w-6 h-6 flex-center",children:(0,h.jsxs)("div",{className:"w-[18px] h-[15px] flex items-end gap-[2px]",children:[(0,h.jsx)("span",{className:(0,a.Z)("h-1/5 w-[2px]",0==s?n:l)}),(0,h.jsx)("span",{className:(0,a.Z)("h-2/5 w-[2px]",s<=1?n:l)}),(0,h.jsx)("span",{className:(0,a.Z)("h-3/5 w-[2px]",s<=2?n:l)}),(0,h.jsx)("span",{className:(0,a.Z)("h-4/5 w-[2px]",s<=3?n:l)}),(0,h.jsx)("span",{className:(0,a.Z)("h-full w-[2px]",s<=4?n:l)})]})})},Us=e=>{var t,s;let{id:l,context:n="channel"}=e;const{t:r}=(0,u.$G)("chat"),{leave:i,voicingInfo:c,setMute:d,setDeafen:x,joining:p=!0}=(0,Vt.M)({context:n,id:l}),{loginUser:f,channelData:g,userData:v}=(0,m.CG)((e=>({userData:e.users.byId,channelData:e.channels.byId,loginUser:e.authData.user})));if(!f||!c||p)return null;if(!("channel"==c.context?null===(t=g[c.id])||void 0===t?void 0:t.name:null===(s=v[c.id])||void 0===s?void 0:s.name))return null;const j="RECONNECTING"==c.connectionState;return(0,h.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-900 flex flex-col p-2 rounded-3xl m-3 mb-4 text-sm",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center border-b border-b-gray-200 dark:border-b-gray-800 pb-2",children:[(0,h.jsxs)("div",{className:"flex flex-1 items-center gap-1",children:[(0,h.jsx)(Rs,{strength:c.downlinkNetworkQuality}),(0,h.jsxs)("div",{className:"flex flex-col",children:[(0,h.jsx)("span",{className:(0,a.Z)("text-green-800 font-bold",j&&"text-red-500"),children:j?"Voice Reconnecting...":"Voice Connected"}),(0,h.jsxs)("span",{className:"text-gray-600 dark:text-gray-400 text-xs truncate max-w-[170px]",children:["channel"==c.context?"Channel":"DM"," / ","channel"==c.context?g[c.id].name:v[c.id].name]})]})]}),(0,h.jsx)(o.Z,{tip:r("leave_voice"),placement:"top",children:(0,h.jsx)(Ot,{onClick:i,role:"button",className:"fill-red-600"})})]}),(0,h.jsxs)("div",{className:"flex justify-between items-center pt-2",children:[(0,h.jsxs)("div",{className:"flex items-center gap-3",children:[(0,h.jsx)(q.Z,{uid:f.uid,compact:!0}),(0,h.jsxs)("div",{className:"flex flex-col",children:[(0,h.jsx)("span",{className:"dark:text-white text-sm font-bold",children:f.name}),(0,h.jsxs)("span",{className:"text-gray-400 text-xs",children:["#",f.uid]})]})]}),(0,h.jsxs)("div",{className:"flex gap-2 px-1",children:[(0,h.jsx)(o.Z,{tip:c.deafen?r("undeafen"):r("deafen"),placement:"top",children:c.deafen?(0,h.jsx)(At,{role:"button",onClick:x.bind(null,!1)}):(0,h.jsx)(Ut,{role:"button",onClick:x.bind(null,!0)})}),(0,h.jsx)(o.Z,{tip:c.muted?r("unmute"):r("mute"),placement:"top",children:c.muted?(0,h.jsx)(ts,{onClick:d.bind(null,!1),role:"button"}):(0,h.jsx)(qt,{onClick:d.bind(null,!0),role:"button"})})]})]})]})};function Ts(){var e;const t=(0,n.bS)("/"),s=(0,n.bS)("/chat"),[i,c]=(0,l.useState)(!1),[d,o]=(0,l.useState)(!1),[x,u]=(0,l.useState)(!1),{channel_id:f=0,user_id:g=0}=(0,n.UO)(),{sessionUids:v,isGuest:j}=(0,m.CG)((e=>({isGuest:e.authData.guest,sessionUids:e.userMessage.ids}))),b=0==g?void 0:-1==v.findIndex((e=>e==+g))?{mid:0,unread:0,id:+g,type:"dm"}:void 0,C=0==f&&0==g,y=t||s,w=0!==f?"channel":"dm",N=null!==(e=f||g)&&void 0!==e?e:0;return(0,h.jsxs)(Gs,{children:[d&&(0,h.jsx)(ms.Z,{closeModal:()=>{o((e=>!e))},personal:!0}),x&&(0,h.jsx)(xs.Z,{closeModal:()=>{u((e=>!e))}}),(0,h.jsxs)("div",{className:(0,a.Z)("flex h-screen md:h-full md:pt-2 md:pb-2.5 md:pr-1",j?"guest-container md:px-1":"md:pr-12"),children:[i&&(0,h.jsx)("div",{onClick:()=>{c((e=>!e))},className:"z-30 fixed top-0 left-4 w-screen h-screen bg-black/50 transition-all backdrop-blur-sm"}),(0,h.jsxs)("div",{className:(0,a.Z)("left-container pb-14 md:pb-0 flex-col md:rounded-l-2xl w-full h-screen md:h-full md:max-w-[250px] md:min-w-[268px] shadow-[rgb(0_0_0_/_10%)_-1px_0px_0px_inset] bg-white dark:!bg-gray-800",y?"flex":"hidden md:flex"),children:[(0,h.jsx)(p,{readonly:j}),j?(0,h.jsx)(Hs,{}):(0,h.jsx)(Is,{tempSession:b}),j?(0,h.jsxs)("footer",{className:"hidden md:block py-1 text-xs text-gray-300 dark:text-gray-700 text-center",children:["Host your own ",(0,h.jsx)("a",{href:"https://voce.chat",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400  dark:text-gray-600",children:"voce.chat"})]}):(0,h.jsx)(Us,{id:+N,context:w})]}),(0,h.jsxs)("div",{className:(0,a.Z)("right-container md:rounded-r-2xl w-full bg-white dark:!bg-gray-700",C&&"h-full flex-center",y&&"hidden md:flex"),children:[C&&(j?(0,h.jsx)($s,{}):(0,h.jsx)(r.Z,{})),0!==f&&(j?(0,h.jsx)(Os,{cid:+f}):(0,h.jsx)(ds,{cid:+f})),0!==g&&(0,h.jsx)(os,{uid:+g})]})]})]})}const Bs=(0,l.memo)(Ts)},77493:(e,t,s)=>{s.d(t,{Z:()=>m});var l=s(70537),n=s(27418),a=s(15924),r=s(80874),i=s(6144),c=s(40698),d=s(69885),o=s(14566),x=s(80683);const m=e=>{let{id:t,closeModal:s}=e;const{t:m}=(0,o.$G)("setting"),{t:u}=(0,o.$G)(),h=(0,a.s0)(),[p,{isLoading:f,isSuccess:g}]=(0,i.kE)();return(0,l.useEffect)((()=>{g&&(n.ZP.success(u("tip.delete")),s(),h("/chat"))}),[g]),t?(0,x.jsx)(r.Z,{id:"modal-modal",children:(0,x.jsx)(c.Z,{className:"compact",title:m("channel.delete"),description:m("channel.delete_desc"),buttons:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(d.Z,{onClick:s.bind(null,void 0),className:"cancel",children:u("action.cancel")}),(0,x.jsx)(d.Z,{onClick:()=>{p(t)},className:"danger",children:f?"Deleting":u("action.remove")})]})})}):null}}}]);