"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[869],{79884:(e,n,l)=>{l.d(n,{Z:()=>c});var s,t=l(70537);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var l=arguments[n];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},a.apply(this,arguments)}const i=(e,n)=>{let{title:l,titleId:i,...c}=e;return t.createElement("svg",a({width:20,height:20,viewBox:"0 0 20 20",fill:"#616161",xmlns:"http://www.w3.org/2000/svg",ref:n,"aria-labelledby":i},c),l?t.createElement("title",{id:i},l):null,s||(s=t.createElement("path",{d:"M6.48667 11.6667L6.83667 8.33333H3.325V6.66667H7L7.43333 2.5H9.10833L8.66667 6.66667H11.9833L12.4167 2.5H14.0917L13.65 6.66667H16.625V8.33333H13.4667L13.1167 11.6667H16.6167V13.3333H12.9333L12.4917 17.5H10.8083L11.2417 13.3333H7.91667L7.475 17.5H5.8L6.23333 13.3333H3.25V11.6667H6.4H6.48667ZM8.1625 11.6667H11.4875L11.8375 8.33333H8.5125L8.1625 11.6667Z"})))},c=(0,t.forwardRef)(i)},11089:(e,n,l)=>{l.d(n,{Z:()=>u});var s=l(70537),t=l(27418),a=l(14566),i=l(52334),c=l(66160),r=l(24563),d=l(15621),o=l(80683);const u=e=>{var n,l;let{id:u,type:v="channel"}=e;const h=(0,c.CG)((e=>"channel"==v?e.footprint.autoDeleteMsgChannels.find((e=>e.gid==u)):e.footprint.autoDeleteMsgUsers.find((e=>e.uid==u)))),[m,{isSuccess:x}]=(0,i.ar)(),[p,g]=(0,s.useState)(null!==(n=null===h||void 0===h?void 0:h.expires_in)&&void 0!==n?n:0),{t:f}=(0,a.$G)("setting",{keyPrefix:"auto_delete_msg"}),{t:j}=(0,a.$G)(),b=[{title:f("off"),value:0},{title:f("5_min"),value:300},{title:f("10_min"),value:600},{title:f("1_hour"),value:3600},{title:f("1_day"),value:86400},{title:f("1_week"),value:604800}];(0,s.useEffect)((()=>{x&&t.Am.success(j("tip.update"))}),[x]);const Z=null!==(l=null===h||void 0===h?void 0:h.expires_in)&&void 0!==l?l:0;return(0,o.jsxs)("section",{className:"max-w-[512px] h-full relative",children:[(0,o.jsxs)("div",{className:"text-sm",children:[(0,o.jsx)("h2",{className:"dark:text-white",children:f("title")}),(0,o.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:f("desc")})]}),(0,o.jsx)("div",{className:"mt-4",children:(0,o.jsx)(d.Z,{options:b.map((e=>{let{title:n}=e;return n})),values:b.map((e=>{let{value:n}=e;return n})),value:p||0,onChange:e=>{g(e)}})}),Z!==p&&(0,o.jsx)(r.Z,{saveHandler:()=>{m("user"==v?{users:[{uid:u,expires_in:p}]}:{groups:[{gid:u,expires_in:p}]})},resetHandler:()=>{var e;g(null!==(e=null===h||void 0===h?void 0:h.expires_in)&&void 0!==e?e:0)}})]})}},77493:(e,n,l)=>{l.d(n,{Z:()=>v});var s=l(70537),t=l(27418),a=l(15924),i=l(80874),c=l(6144),r=l(40698),d=l(69885),o=l(14566),u=l(80683);const v=e=>{let{id:n,closeModal:l}=e;const{t:v}=(0,o.$G)("setting"),{t:h}=(0,o.$G)(),m=(0,a.s0)(),[x,{isLoading:p,isSuccess:g}]=(0,c.kE)();return(0,s.useEffect)((()=>{g&&(t.ZP.success(h("tip.delete")),l(),m("/chat"))}),[g]),n?(0,u.jsx)(i.Z,{id:"modal-modal",children:(0,u.jsx)(r.Z,{className:"compact",title:v("channel.delete"),description:v("channel.delete_desc"),buttons:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d.Z,{onClick:l.bind(null,void 0),className:"cancel",children:h("action.cancel")}),(0,u.jsx)(d.Z,{onClick:()=>{x(n)},className:"danger",children:p?"Deleting":h("action.remove")})]})})}):null}},20869:(e,n,l)=>{l.r(n),l.d(n,{default:()=>O});var s=l(70537),t=l(15924),a=l(64084),i=l(27418),c=l(80874),r=l(6144),d=l(66160);function o(e){const{channel:n,loginUid:l}=(0,d.CG)((n=>{var l;return{channel:n.channels.byId[e],loginUid:null===(l=n.authData.user)||void 0===l?void 0:l.uid}})),[s,{isLoading:t,isSuccess:a}]=(0,r.tW)(),[i,{isLoading:c,isSuccess:o}]=(0,r.VJ)(),u=l==(null===n||void 0===n?void 0:n.owner);return{otherMembers:(null===n||void 0===n?void 0:n.members.filter((e=>e!=l)))||[],transferOwner:n=>{n&&s({id:e,owner:n})},leaveChannel:()=>{e&&i(e)},leaving:c,leaveSuccess:o,isOwner:u,transferring:t,transferSuccess:a}}var u=l(40698),v=l(69885),h=l(33941),m=l(14566),x=l(57425),p=l(80683);const g=e=>{let{id:n,closeModal:l,withLeave:a=!0}=e;const{t:r}=(0,m.$G)(),{transferOwner:d,otherMembers:g,leaving:f,leaveChannel:j,leaveSuccess:b,transferSuccess:Z,transferring:w}=o(n),[N,_]=(0,s.useState)(null),y=(0,t.s0)(),C=e=>{_(e)};if((0,s.useEffect)((()=>{Z&&b&&(i.ZP.success("Leave channel successfully!"),l(),y("/chat"))}),[b,Z,a]),!n)return null;const L=f||w;return(0,p.jsx)(c.Z,{id:"modal-modal",children:(0,p.jsx)(u.Z,{className:"compact",title:"Transfer Ownership",description:"This cannot be undone.",buttons:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(v.Z,{onClick:l.bind(null,void 0),className:"cancel",children:r("action.cancel")}),(0,p.jsx)(v.Z,{disabled:!N,onClick:async()=>{N&&(await d(N),a&&await j())},className:"danger",children:L?"Assigning":"Assign and Leave"})]}),children:(0,p.jsx)("ul",{className:"flex flex-col max-h-[260px] py-4 overflow-y-scroll",children:g.map((e=>(0,p.jsx)("li",{className:(0,x.Z)("cursor-pointer flex items-center px-2 hover:bg-gray-500/10",N==e?"bg-gray-500/10":""),onClick:C.bind(null,e),children:(0,p.jsx)(h.Z,{uid:e,interactive:!1})},e)))})})})},f=e=>{let{id:n,closeModal:l,handleNextStep:a}=e;const{t:r}=(0,m.$G)("setting"),d=(0,t.s0)(),{isOwner:h,leaving:x,leaveChannel:g,leaveSuccess:f}=o(n);return(0,s.useEffect)((()=>{f&&(i.ZP.success("Leave channel successfully!"),l(),d("/chat"))}),[f]),n?(0,p.jsx)(c.Z,{id:"modal-modal",children:(0,p.jsx)(u.Z,{className:"compact",title:r("channel.leave"),description:r(h?"channel.transfer_desc":"channel.leave_desc"),buttons:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(v.Z,{onClick:l.bind(null,void 0),className:"cancel",children:r("action.cancel",{ns:"common"})}),h?(0,p.jsx)(v.Z,{onClick:a,className:"main",children:"Next"}):(0,p.jsx)(v.Z,{onClick:g,className:"danger",children:x?"Leaving":"Leave"})]})})}):null},j=e=>{let{id:n,isOwner:l=!1,closeModal:t}=e;const[a,i]=(0,s.useState)(l);return a?(0,p.jsx)(g,{id:n,closeModal:t}):(0,p.jsx)(f,{id:n,closeModal:t,handleNextStep:()=>{i(!0)}})};var b=l(90442),Z=l(77493),w=l(95727),N=l(68975),_=l(48540),y=l(15621),C=l(64884),L=l(24563),S=l(79884);function H(e){let{id:n=0}=e;const{t:l}=(0,m.$G)("setting",{keyPrefix:"channel"}),{t:t}=(0,m.$G)(),{loginUser:a,channel:c}=(0,d.CG)((e=>({loginUser:e.authData.user,channel:e.channels.byId[n]}))),{data:o,refetch:u}=(0,r.aw)(n),[v,h]=(0,s.useState)(!1),[x,g]=(0,s.useState)(),[f]=(0,r.kG)(),[j,{isSuccess:b}]=(0,r.tW)(),[Z,{isSuccess:H}]=(0,r.Cl)(),k=e=>{const n=e.target.value,{type:l=""}=e.target.dataset;g((e=>e?{...e,[l]:n}:e))};if((0,s.useEffect)((()=>{o&&g(o)}),[o]),(0,s.useEffect)((()=>{if(o&&x){const{name:e,description:n}=x,{name:l,description:s}=o;h(l!==e||s!==n)}}),[o,x]),(0,s.useEffect)((()=>{b&&(i.ZP.success(t("tip.update")),u())}),[b]),(0,s.useEffect)((()=>{H&&i.ZP.success(t("tip.update"))}),[H]),!x||!n)return null;const{name:G,description:M}=x,E=!(null!==a&&void 0!==a&&a.is_admin)&&(null===c||void 0===c?void 0:c.owner)!=(null===a||void 0===a?void 0:a.uid),O="w-full flex flex-col items-start gap-2 relative";return(0,p.jsxs)("div",{className:"relative w-[512px] flex flex-col gap-6 h-full",children:[(0,p.jsx)(w.Z,{type:"channel",url:null===c||void 0===c?void 0:c.icon,name:G,uploadImage:e=>{f({gid:n,image:e})}}),(0,p.jsxs)("div",{className:"flex flex-col gap-6 items-start",children:[(0,p.jsxs)("div",{className:O,children:[(0,p.jsx)(_.Z,{htmlFor:"name",children:l("name")}),(0,p.jsx)(N.Z,{disabled:E,className:"!pl-8","data-type":"name",onChange:k,value:G,name:"name",id:"name",placeholder:l("name")}),(0,p.jsx)(S.Z,{className:"absolute bottom-2.5 left-2"})]}),(0,p.jsxs)("div",{className:O,children:[(0,p.jsx)(_.Z,{htmlFor:"desc",children:l("topic")}),(0,p.jsx)(C.Z,{disabled:E,"data-type":"description",onChange:k,value:null!==M&&void 0!==M?M:"",rows:4,name:"name",id:"name",placeholder:l("topic_placeholder")})]}),!E&&(0,p.jsxs)("div",{className:O,children:[(0,p.jsx)(_.Z,{htmlFor:"desc",children:l("visibility")}),(0,p.jsx)(y.Z,{options:[l("public"),l("private")],values:["true","false"],value:String(c.is_public),onChange:e=>{Z({is_public:"true"===e.toLowerCase(),id:n})}})]})]}),v&&(0,p.jsx)(L.Z,{saveHandler:()=>{if(!x)return;const{name:e,description:l}=x;j({id:n,name:e,description:l})},resetHandler:()=>{g(o)}})]})}var k=l(11089),G=l(61895);const M=e=>{const{t:n}=(0,m.$G)("setting");return[{title:n("nav.general"),items:[{name:"overview",title:n("nav.overview"),component:(0,p.jsx)(H,{id:e})},{name:"auto_delete_msg",title:n("nav.auto_delete_msg"),component:(0,p.jsx)(k.Z,{id:e})},{name:"members",title:n("nav.members"),component:(0,p.jsx)(G.Z,{cid:e})}]}]};let E="";function O(){const{t:e}=(0,m.$G)("setting"),{cid:n=0}=(0,t.UO)(),{loginUser:l,channel:i}=(0,d.CG)((e=>({loginUser:e.authData.user,channel:n?e.channels.byId[+n]:void 0}))),c=(0,t.s0)(),[r]=(0,a.lr)(),o=M(+n),u=o.map((e=>{let{items:n}=e;return n})).flat(),v=r.get("nav");E=E||(r.get("f")||"/");const[h,x]=(0,s.useState)(!1),[g,f]=(0,s.useState)(!1),w=()=>{x((e=>!e))},N=()=>{f((e=>!e))};if(!n)return null;const _=u.find((e=>e.name==v))||u[0],y=(null===l||void 0===l?void 0:l.is_admin)||(null===i||void 0===i?void 0:i.owner)==(null===l||void 0===l?void 0:l.uid),C=!(null!==i&&void 0!==i&&i.is_public);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(b.Z,{nav:_,closeModal:()=>{c(E),E=""},title:"Channel Setting",navs:o,dangers:[C&&{title:e("channel.leave"),handler:N},y&&{title:e("channel.delete"),handler:w}],children:_.component}),h&&(0,p.jsx)(Z.Z,{closeModal:w,id:+n}),g&&(0,p.jsx)(j,{closeModal:N,id:+n})]})}}}]);