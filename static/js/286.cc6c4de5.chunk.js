"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[286],{66286:(e,s,a)=>{a.r(s),a.d(s,{default:()=>k});var t=a(70537),n=a(27418),i=a(80308),c=a(64813),r=a(17237),o=a(69885),l=a(57889),d=a(15924),g=a(80683);const u=(0,l.ZP)(o.Z)`
  width: 100%;
  margin-bottom: 16px;
`;function m(){const e=(0,d.s0)();return(0,g.jsx)(u,{onClick:()=>{e("/send_magic_link")},children:"Sign in with Magic Link"})}var h=a(14566);function p(e){let{smtp:s=!1}=e;const{t:a}=(0,h.$G)("auth"),t=(0,d.s0)();return(0,g.jsxs)("div",{className:"flex gap-1 mt-7 text-sm text-[#667085] justify-center",children:[(0,g.jsx)("span",{children:a("login.no_account")}),(0,g.jsx)("a",{className:"text-[#22d3ee] cursor-pointer",onClick:()=>{t(s?"/send_magic_link":"/register")},children:a("sign_up")})]})}var f=a(15312),x=a(65809),j=a(25089),_=a(44917);function k(){const{t:e}=(0,h.$G)("auth"),{data:s}=(0,x.n8)(),[a,{isSuccess:l,isLoading:d,error:u}]=(0,f.YA)(),{clientId:k}=(0,j.Z)(),{data:w,isSuccess:b}=(0,x.ww)(),[v,y]=(0,t.useState)({email:"",password:""});(0,t.useEffect)((()=>{const e=new URLSearchParams(location.search),s=e.get("code"),t=e.get("state"),n=e.get("magic_token"),i=e.get("exists");if(s&&t&&a({code:s,state:t,type:"oidc"}),n&&"undefined"!==typeof i){"true"==i?a({magic_token:n,type:"magiclink"}):location.href=`?magic_token=${n}#/register/set_name/login`}}),[]),(0,t.useEffect)((()=>{if(u)switch(u.status){case 401:case 404:n.ZP.error("Username or Password incorrect");break;case 410:n.ZP.error("No associated account found, please contact user admin for an invitation link to join.");break;case"PARSING_ERROR":break;default:n.ZP.error("Something Error")}else;}),[u]),(0,t.useEffect)((()=>{l&&n.ZP.success("Login Successfully")}),[l]);const N=e=>{const{type:s}=e.target.dataset,{value:a}=e.target;s&&y((e=>(e[s]=a,{...e})))},{email:Z,password:S}=v;if(!b)return null;const{magic_link:P,github:C,google:E,metamask:R,oidc:L=[],who_can_sign_up:$}=w,G=s&&P,q=G||E&&k||R||L.length>0||C;return(0,g.jsx)(c.Z,{children:(0,g.jsxs)("div",{className:"form",children:[(0,g.jsxs)("div",{className:"tips",children:[(0,g.jsx)("img",{src:`${i.ZP}/resource/organization/logo`,alt:"logo",className:"logo"}),(0,g.jsx)("h2",{className:"title",children:e("login.title")}),(0,g.jsx)("span",{className:"desc",children:e("login.desc")})]}),(0,g.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a({...v,type:"password"})},children:[(0,g.jsx)(r.Z,{className:"large",name:"email",value:Z,type:"email",required:!0,placeholder:e("placeholder_email"),"data-type":"email",onChange:N}),(0,g.jsx)(r.Z,{className:"large",type:"password",value:S,name:"password",required:!0,"data-type":"password",onChange:N,placeholder:e("placeholder_pwd")}),(0,g.jsx)(o.Z,{type:"submit",disabled:d,children:d?"Signing":e("sign_in")})]}),q&&(0,g.jsx)("hr",{className:"or"}),(0,g.jsxs)("div",{className:"btns",children:[G&&(0,g.jsx)(m,{}),(0,g.jsx)(_.Z,{})]}),"EveryOne"===$&&(0,g.jsx)(p,{smtp:s})]})})}}}]);