"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[656],{99656:(e,a,s)=>{s.r(a),s.d(a,{default:()=>m});var t=s(70537),n=s(3074),i=s(15924),r=s(27418),c=s(21645),o=s(3022),l=s(69885),u=s(15312),d=s(80683);function h(){return(0,d.jsxs)("div",{className:"flex flex-col items-center",children:[(0,d.jsx)("div",{className:"font-bold text-3xl text-gray-800 mt-3",children:"Magic link expired"}),(0,d.jsx)("p",{className:"text-center text-gray-400 mb-6",children:"Go back to your original VoceChat tab and request a new magic link."}),(0,d.jsx)("p",{className:"text-center text-gray-400",children:"You can close this window now."})]})}const m=()=>{const[e,{data:a,isLoading:s}]=(0,u.v5)(),[m,{isLoading:g,error:x,isSuccess:f,data:k}]=(0,u.YA)(),[b,{isLoading:p,isSuccess:j,data:v,error:w}]=(0,u.l4)(),{from:y="reg"}=(0,i.UO)(),N=(0,n.I0)(),[C,L]=(0,t.useState)(""),S=new URLSearchParams(location.search).get("magic_token");(0,t.useEffect)((()=>{S&&e(S)}),[S]),(0,t.useEffect)((()=>{if(x&&"status"in x&&401===x.status)r.ZP.error("Invalided Token")}),[x]),(0,t.useEffect)((()=>{if(w&&"status"in w&&409===w.status)r.ZP.error("Something Conflicted!")}),[w]),(0,t.useEffect)((()=>{const e=k||v;(f||j)&&e&&(r.ZP.success("Login Successfully"),N((0,c.A3)(e)),location.href="/#/")}),[f,j,k,v]);if(!S)return(0,d.jsx)(d.Fragment,{children:'"No Token"'});if(s)return(0,d.jsx)(d.Fragment,{children:'"Checking Magic Link..."'});if(!a)return(0,d.jsx)(h,{});const _=g||p,E=f||j;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"tips",children:[(0,d.jsx)("h2",{className:"title",children:"What\u2019s your name"}),(0,d.jsx)("span",{className:"desc",children:"Enter a name or handle so people know how you\u2019d like to be called. Your name will only be visible to others in spaces you joined."})]}),(0,d.jsxs)("form",{onSubmit:e=>{e.preventDefault(),"reg"==y?b({magic_token:S,name:C}):m({magic_token:S,extra_name:C,type:"magiclink"})},children:[(0,d.jsx)(o.Z,{className:"large",name:"username",value:C,required:!0,placeholder:"Type a name",onChange:e=>{L(e.target.value)}}),(0,d.jsx)(l.Z,{type:"submit",disabled:_||!C||E,children:_?"Logging in":"Continue"})]})]})}}}]);