"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[875],{33568:(e,t,l)=>{l.d(t,{Z:()=>c});var s,a,n=l(70537);function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},r.apply(this,arguments)}const i=(e,t)=>{let{title:l,titleId:i,...c}=e;return n.createElement("svg",r({width:6,height:6,viewBox:"0 0 6 6",fill:"black",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":i},c),l?n.createElement("title",{id:i},l):null,s||(s=n.createElement("rect",{opacity:.01,width:6,height:6,fill:"#D8D8D8"})),a||(a=n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.62506 1.64911C5.41795 1.4503 5.08216 1.45029 4.87506 1.64911L3.00003 3.44911L1.12506 1.64916C0.917951 1.45034 0.582164 1.45034 0.375057 1.64916C0.16795 1.84798 0.16795 2.17033 0.375057 2.36915L2.62506 4.52912C2.83217 4.72794 3.16795 4.72794 3.37506 4.52912C3.37665 4.5276 3.37822 4.52608 3.37977 4.52454L5.62506 2.36911C5.83216 2.17029 5.83216 1.84793 5.62506 1.64911Z",fillOpacity:.5})))},c=(0,n.forwardRef)(i)},18697:(e,t,l)=>{l.d(t,{Z:()=>c});var s,a,n=l(70537);function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},r.apply(this,arguments)}const i=(e,t)=>{let{title:l,titleId:i,...c}=e;return n.createElement("svg",r({width:16,height:12,viewBox:"0 0 16 12",fill:"#78787C",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":i},c),l?n.createElement("title",{id:i},l):null,s||(s=n.createElement("g",{clipPath:"url(#clip0_9046_23916)"},n.createElement("path",{d:"M4.93942 9.69781L1.62578 6.38648C1.25336 6.01431 0.651746 6.01431 0.27932 6.38648C-0.0931066 6.75865 -0.0931066 7.35984 0.27932 7.73201L4.27096 11.7209C4.64339 12.093 5.245 12.093 5.61743 11.7209L15.7207 1.62465C16.0931 1.25248 16.0931 0.651292 15.7207 0.279125C15.3483 -0.0930417 14.7466 -0.0930417 14.3742 0.279125L4.93942 9.69781Z"}))),a||(a=n.createElement("defs",null,n.createElement("clipPath",{id:"clip0_9046_23916"},n.createElement("rect",{width:16,height:12,fill:"white"})))))},c=(0,n.forwardRef)(i)},7499:(e,t,l)=>{l.d(t,{Z:()=>c});var s=l(70537),a=l(2632),n=l(16956),r=l(3713),i=l(80683);const c=e=>{let{id:t=""}=e;const{favorites:l}=(0,a.Z)({}),[c,d]=(0,s.useState)(null);return(0,s.useEffect)((()=>{const e=l.find((e=>e.id==t)),{messages:s}=e||{};if(!s)return;const a=s.map((e=>{let{from_mid:t}=e;return+t}))||[];d((0,i.jsx)("div",{"data-favorite-mids":a.join(","),className:"favorite flex flex-col rounded-md bg-slate-50 dark:bg-slate-800",children:(0,i.jsx)("div",{className:"list",children:s.map(((e,t)=>{const{user:l={},download:s,content:a,content_type:c,properties:d,thumbnail:o}=e;return(0,i.jsxs)("div",{className:"w-full relative flex items-start gap-3 px-2 py-1 my-2 rounded-lg md:dark:hover:bg-gray-800",children:[l&&(0,i.jsx)("div",{className:"shrink-0 w-10 h-10 flex",children:(0,i.jsx)(n.Z,{width:40,height:40,className:"rounded-full object-cover",src:l.avatar,name:l.name})}),(0,i.jsxs)("div",{className:"w-full flex flex-col gap-2 text-sm",children:[(0,i.jsx)("div",{className:"flex items-center gap-2 font-semibold",children:(0,i.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:(null===l||void 0===l?void 0:l.name)||"Deleted User"})}),(0,i.jsx)("div",{className:"select-text text-gray-800 break-all whitespace-pre-wrap dark:text-white",children:(0,r.Z)({download:s,content:a,content_type:c,properties:d,thumbnail:o})})]})]},t)}))})}))}),[l,t]),t?c:null}},23234:(e,t,l)=>{l.r(t),l.d(t,{default:()=>ks});var s=l(70537),a=l(15924),n=l(57425),r=l(66160),i=l(11782),c=l(24720),d=l(83825),o=l(80683);function u(e){let{error:t,resetErrorBoundary:l}=e;return(0,o.jsxs)("div",{role:"alert",className:"text-lg text-red-600",children:[(0,o.jsx)("p",{children:"Something went wrong:"}),(0,o.jsx)("pre",{children:t.message}),(0,o.jsx)("button",{onClick:l,children:"Try again"})]})}const m=e=>{let{children:t}=e;return(0,o.jsx)(d.SV,{FallbackComponent:u,children:t})};var x=l(14566),h=l(64084),p=l(7829),g=l(28595),f=l(1047),v=l(33478);function b(e){let{readonly:t=!1}=e;const{t:l}=(0,x.$G)(),{pathname:s}=(0,a.TH)(),{server:n,userCount:i}=(0,r.CG)((e=>({userCount:e.users.ids.length,server:e.server}))),{name:c,description:d,logo:u}=n;return t?(0,o.jsx)(h.OL,{to:"/",className:"relative flex items-center justify-between gap-2 px-4 py-2",children:(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("div",{className:"w-8 h-8",children:(0,o.jsx)("img",{alt:`${c} logo`,className:"w-full h-full object-cover rounded-full",src:u})}),(0,o.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,o.jsx)("h3",{className:"text-sm text-gray-600 dark:text-gray-100",title:d,children:c}),(0,o.jsxs)("span",{className:"text-xs text-gray-500",children:[i," ",l("members")]})]})]})}):(0,o.jsxs)("div",{className:"relative flex items-center justify-between gap-2 px-4 py-2",children:[(0,o.jsx)(h.OL,{to:`/setting/overview?f=${s}`,children:(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("div",{className:"w-8 h-8",children:(0,o.jsx)("img",{alt:`${c} logo`,className:"w-full h-full object-cover rounded-full",src:u})}),(0,o.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,o.jsx)("h3",{className:"text-sm text-gray-600 font-bold dark:text-gray-100",title:d,children:c}),(0,o.jsxs)("span",{className:"text-xs text-gray-500",children:[i," ",l("members")]})]})]})}),(0,o.jsx)(v.Z,{tip:l("more"),placement:"bottom",children:(0,o.jsx)(p.ZP,{interactive:!0,placement:"bottom-end",trigger:"click",content:(0,o.jsx)(f.Z,{}),children:(0,o.jsx)(g.Z,{className:"dark:fill-gray-400",role:"button"})})})]})}var j,y=l(74664),w=l(3074),C=l(81980),N=l(12564),k=l(55009),Z=l(16188),_=l(41016);function M(){return M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},M.apply(this,arguments)}const L=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",M({width:24,height:24,viewBox:"0 0 24 24",fill:"#70707B",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,j||(j=s.createElement("path",{d:"M3.5 14L13.5 14.001C14.2793 14.001 14.9204 14.5963 14.9931 15.3566L15 15.501V17.5C14.999 21 11.284 22 8.5 22C5.77787 22 2.1647 21.044 2.00545 17.7296L2 17.5V15.5C2 14.7207 2.59527 14.0796 3.35561 14.0069L3.5 14ZM15.488 14H20.5C21.2793 14 21.9204 14.5944 21.9931 15.3555L22 15.5V17C21.999 20.062 19.142 21 17 21C16.32 21 15.569 20.904 14.86 20.678C15.5128 19.9277 15.9362 18.9748 15.9934 17.78L16 17.5V15.5C16 15.0056 15.8507 14.5488 15.601 14.1616L15.488 14H20.5H15.488ZM8.5 3C10.985 3 13 5.015 13 7.5C13 9.985 10.985 12 8.5 12C6.015 12 4 9.985 4 7.5C4 5.015 6.015 3 8.5 3ZM17.5 5C19.433 5 21 6.567 21 8.5C21 10.433 19.433 12 17.5 12C15.567 12 14 10.433 14 8.5C14 6.567 15.567 5 17.5 5Z"})))},I=(0,s.forwardRef)(L);var E,D=l(25680),O=l(7499),V=l(2632),$=l(25552);function S(){return S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},S.apply(this,arguments)}const H=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",S({width:160,height:160,viewBox:"0 0 160 160",fill:"#D0D5DD",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,E||(E=s.createElement("path",{d:"M79.9997 13.3642C116.819 13.3642 146.666 43.2118 146.666 80.0308C146.666 116.85 116.819 146.698 79.9997 146.698C43.1807 146.698 13.333 116.85 13.333 80.0308C13.333 43.2118 43.1807 13.3642 79.9997 13.3642ZM79.9997 23.3642C48.7035 23.3642 23.333 48.7347 23.333 80.0308C23.333 111.327 48.7035 136.698 79.9997 136.698C111.296 136.698 136.666 111.327 136.666 80.0308C136.666 48.7347 111.296 23.3642 79.9997 23.3642ZM79.9997 86.6667C88.284 86.6667 94.9997 93.3824 94.9997 101.667C94.9997 109.951 88.284 116.667 79.9997 116.667C71.7154 116.667 64.9997 109.951 64.9997 101.667C64.9997 93.3824 71.7154 86.6667 79.9997 86.6667ZM60.0027 58.3411C64.6024 58.3411 68.3313 62.0699 68.3313 66.6697C68.3313 71.2694 64.6024 74.9983 60.0027 74.9983C55.4029 74.9983 51.6741 71.2694 51.6741 66.6697C51.6741 62.0699 55.4029 58.3411 60.0027 58.3411ZM100.003 58.3411C104.602 58.3411 108.331 62.0699 108.331 66.6697C108.331 71.2694 104.602 74.9983 100.003 74.9983C95.4029 74.9983 91.6741 71.2694 91.6741 66.6697C91.6741 62.0699 95.4029 58.3411 100.003 58.3411Z"})))},R=(0,s.forwardRef)(H),T=e=>{let{cid:t=null,uid:l=null}=e;const{t:s}=(0,x.$G)("chat"),{favorites:a,removeFavorite:n}=(0,V.Z)({cid:t,uid:l}),r=e=>{const{id:t=""}=e.currentTarget.dataset;n(t)},i=0==a.length;return(0,o.jsxs)("div",{className:"p-4 bg-slate-50 dark:bg-slate-800 rounded-xl min-w-[500px] max-h-[500px] overflow-auto drop-shadow-[0px_25px_50px_rgba(31,_41,_55,_0.25)]",children:[(0,o.jsxs)("h4",{className:"font-bold text-gray-600 dark:text-gray-400 mb-4",children:[s("fav_msg"),"(",a.length,")"]}),i?(0,o.jsxs)("div",{className:"flex flex-col gap-2 w-full items-center p-4",children:[(0,o.jsx)(R,{}),(0,o.jsx)("div",{className:"w-60 text-gray-600 dark:text-gray-400 text-center font-bold",children:s("fav_empty_tip")})]}):(0,o.jsx)("ul",{className:"flex flex-col gap-2",children:a.map((e=>{let{id:t}=e;return(0,o.jsxs)("li",{className:"relative border border-solid border-slate-200 dark:border-gray-600 rounded-md group",children:[(0,o.jsx)(O.Z,{id:t}),(0,o.jsx)("div",{className:"flex items-center absolute top-2 right-2 border border-solid border-gray-300 dark:border-gray-600 rounded-md overflow-hidden invisible group-hover:visible",children:(0,o.jsx)("button",{className:"flex-center w-6 h-6 p-1","data-id":t,onClick:r,children:(0,o.jsx)($.Z,{className:"fill-slate-900 dark:fill-slate-500"})})})]},t)}))})]})};var F=l(59857),G=l(16352),U=l(27418),P=l(40760),z=l(80308),B=l(51),A=(l(85012),l(61459),l(29191),l(69495),l(55403)),K=l.n(A),W=l(73395),Y=l(26602),q=l(4472);const Q=e=>{let{updateDraft:t=null,initialValue:l="",height:a="50vh",placeholder:n,sendMarkdown:r,setEditorInstance:i}=e;const c=(0,s.useRef)(),{uploadFile:d}=(0,W.Z)();(0,s.useEffect)((()=>{const e=null===c||void 0===c?void 0:c.current;if(e){const t=e.getInstance();t.removeHook("addImageBlobHook"),t.addHook("addImageBlobHook",(async(e,t)=>{const{thumbnail:l=""}=await d(e)||{};t(l)})),i(t)}return()=>{if(e){const l=e.getInstance(),s=l.getMarkdown();t&&t(s),l.destroy()}}}),[]);return(0,o.jsxs)("div",{className:"input md-editor",children:[(0,o.jsx)(B.M,{initialValue:l,plugins:[K()],placeholder:n,ref:c,toolbarItems:[],hideModeSwitch:!0,previewStyle:"vertical",height:a,initialEditType:"markdown",useCommandShortcut:!0,theme:(0,Y.Yc)()?"dark":"light"}),(0,o.jsx)(q.Z,{className:"send small",onClick:()=>{if(!c.current)return;const e=c.current.getInstance();e.getMarkdown().trim()&&(r(e.getMarkdown()),e.reset())},children:"Send"})]})};var J=l(53517),X=l(1823),ee=l(88332);const te=e=>{let{context:t="dm",id:l=0}=e;const s=(0,r.TL)(),a=`${t}_${l}`,{draftMarkdown:n,draftMixedText:i}=(0,r.CG)((e=>({draftMarkdown:e.ui.draftMarkdown,draftMixedText:e.ui.draftMixedText})));return{getDraft:function(){return"mixed"==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mixed")?i[a]:n[a]},getUpdateDraft:function(){const e="mixed"==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mixed")?N.$K:N.Ul;return t=>{s(e({key:a,value:t}))}}}};var le=l(75790),se=l(22481),ae=l(85490),ne=l(88109),re=l(81721),ie=l(57815),ce=l(25583),de=l(65487);const oe={editableProps:{spellCheck:!1,autoFocus:!0,placeholder:"Type\u2026"},trailingBlock:{type:ae.JBe},softBreak:{options:{rules:[{hotkey:"shift+enter",query:{allow:[ae.IVr,ae.JBe]}}]}},exitBreak:{options:{rules:[{hotkey:"mod+enter",query:{allow:[ae.IVr,ae.JBe]}}]}},selectOnBackspace:{options:{query:{allow:[ae.IVr]}}}},ue="_text_editor";let me=(0,ae.Ips)({});const xe=[{type:ae.JBe,children:[{text:""}]}],he=e=>{const t=(0,ae.CE7)(`${ue}_${e}`);return{resetInput:()=>{t&&ie.YR.delete(t,{at:{anchor:ie.ML.start(t,[]),focus:ie.ML.end(t,[])}})},focus:()=>{t&&ce.F3.focus(t)},insertText:e=>{t&&(ce.F3.focus(t),t.insertText(e))}}},pe=e=>{let{updateDraft:t=null,initialValue:l=xe,id:a,placeholder:n="Write some markdown...",sendMessages:i,updateMessages:c,members:d=[]}=e;const[u,m]=a.split("_"),{addStageFile:x}=(0,W.Z)({context:u,id:m}),h=d.length>0,p=(0,r.CG)((e=>e.users.byId)),g=(0,s.useRef)(null),f={...oe.editableProps,className:"flex flex-col md:gap-2",placeholder:n},v=(0,ae.CE7)(`${ue}_${a}`);(0,s.useEffect)((()=>{const e=e=>{const t=[...e.clipboardData.files];if(t.length){const e=t.map((e=>{const{size:t,type:l,name:s}=e;return{size:t,type:l,name:s,url:URL.createObjectURL(e)}}));x(e)}};return window.addEventListener("paste",e),()=>{window.removeEventListener("paste",e)}}),[a,t]),(0,re.z)("Enter",(e=>{if(!v)return;if((0,ae.kGl)(v)||e.shiftKey||e.ctrlKey||e.altKey||e.isComposing)return!0;e.preventDefault(),i()}),{when:!(0,Y.tq)(),target:g});const b=[(0,ae.ZZF)(),(0,ae.kdp)(),(0,ae.kjx)(oe.softBreak),(0,ae.AFf)(oe.trailingBlock),(0,ae.z$X)(oe.exitBreak)],j=(0,ae.ZUk)(h?b.concat([(0,ne.kQ)(),(0,ae.MoH)({options:{createMentionNode:e=>{const{text:t,data:{uid:l}}=e;return{value:`@${t}`,uid:l}},insertSpaceAfterMention:!0}})]):b,{components:me});return(0,o.jsx)("div",{className:"input w-full pr-14 md:pr-0 max-h-[50vh] overflow-auto text-sm text-gray-600 dark:text-white",ref:g,children:(0,o.jsx)(ae.hv7,{id:`${ue}_${a}`,onChange:e=>{const t=[],l=e=>{const t=[];return{value:e.map((e=>{let{type:l,text:s,uid:a}=e;return"mention"==l?(t.push(a),` @${a} `):s})).join(""),mentions:t}};for(const a of e){const{value:e,mentions:s}=l(a.children),n=t[t.length-1];n&&Array.isArray(n)?t[t.length-1].push({type:"text",content:e,properties:{mentions:s}}):t.push([{type:"text",content:e,properties:{mentions:s}}])}const s=t.map((e=>Array.isArray(e)?{type:"text",content:e.map((e=>e.content)).join("\n"),properties:{mentions:e.map((e=>{var t;return(null===(t=e.properties)||void 0===t?void 0:t.mentions)||[]})).flat()}}:e)).filter((e=>{let{content:t}=e;return!!t.trim()}));c(s)},editableProps:{...f,style:{userSelect:"text"}},initialValue:l,plugins:j,children:h?(0,o.jsx)(ae.bEm,{onRenderItem:e=>{let{item:t}=e;return t&&t.data?(0,o.jsx)(de.Z,{uid:t.data.uid,interactive:!1},t.data.uid):null},items:d.map((e=>{const t=p[e];if(!t)return{key:e};const{uid:l,name:s,...a}=t;return{key:l,text:s,data:{uid:l,...a}}}))}):null})})};var ge=l(55283);const fe=e=>{let{sendMessage:t,placeholder:l}=e;const{t:a}=(0,x.$G)(),n=(0,s.useRef)(null),[r,i]=(0,s.useState)(""),c=()=>{if(!r)return;t([{type:"text",content:r}]),i("")};return(0,re.z)("Enter",(e=>{e.preventDefault(),c()}),{when:!(0,Y.tq)(),target:n}),(0,o.jsxs)("div",{className:"md:hidden relative mb-1 p-1 flex items-center w-full text-gray-600 dark:text-white bg-gray-200 dark:bg-gray-600 rounded-lg",children:[(0,o.jsx)(ge.Z,{onFocus:e=>e.currentTarget.setSelectionRange(e.currentTarget.value.length,e.currentTarget.value.length),ref:n,className:"p-1 w-full min-h-[28px] resize-none bg-transparent text-gray-800 dark:text-white text-sm break-all",maxRows:8,minRows:1,onChange:e=>{i(e.target.value)},value:r,placeholder:l}),(0,o.jsx)(q.Z,{onClick:c,className:"mini absolute right-1.5 bottom-1.5",children:a("action.send")})]})};var ve=l(49476),be=l(97943),je=l(1098);function ye(e){let{selectEmoji:t}=e;const l=(0,s.useRef)(null),[a,r]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{l&&l.current&&(l.current.innerHTML="",new ve.cW({data:async()=>(await fetch("https://cdn.jsdelivr.net/npm/@emoji-mart/data")).json(),parent:l.current,onEmojiSelect:e=>{t(e.native)}}))}),[t]),(0,be.O)(l,(e=>{const t=e.target;if(!t)return;"svg"==t.nodeName&&"toggler"==t.dataset.emoji||"path"==t.nodeName&&t.parentElement&&"toggler"==t.parentElement.dataset.emoji||r(!1)}),a),(0,o.jsx)(v.Z,{placement:"top",tip:"Emojis",disabled:a,children:(0,o.jsxs)("div",{className:"hidden md:flex relative w-fit items-center",children:[(0,o.jsx)("div",{ref:l,className:(0,n.Z)("z-50 absolute -top-5 -left-5 -translate-y-full",a?"block":"hidden")}),(0,o.jsx)(je.Z,{"data-emoji":"toggler",className:"cursor-pointer select-none !w-[22px] !h-[22px]",onClick:()=>{r((e=>!e))}})]})})}var we=l(24041);const Ce=l.p+"static/media/picture.57a395fb7f41e8e3c5d1.svg";var Ne=l(82493),ke=l(22938);const Ze=e=>{const{content_type:t,content:l,thumbnail:s="",properties:a}=e;let n=null;switch(t){case z.bT.text:n=(0,o.jsx)(Ne.Z,{text:l,url:!1,mentionTextOnly:!0});break;case z.bT.audio:n=(0,o.jsx)("div",{className:"text-sm",children:(0,o.jsx)("span",{className:"text-gray-400 italic",children:"[Voice Message]"})});break;case z.bT.markdown:n=(0,o.jsx)("div",{className:"max-h-[100px] overflow-auto",children:(0,o.jsx)(ke.Z,{content:l})});break;case z.bT.file:{const{content_type:e="",name:t,size:l}=a||{};if((0,Y.Or)(e,l))n=(0,o.jsx)("img",{className:"w-10 h-10 object-cover",src:s||Ce});else{const l=(0,Y.LP)(e,t,"icon w-4 h-5");n=(0,o.jsxs)("div",{className:"flex items-center gap-1",children:[l,(0,o.jsx)("span",{className:"ml-1 text-[10px] text-gray-400",children:t})]})}}}return n};function _e(e){let{context:t,id:l,mid:s}=e;const{removeReplying:a}=(0,le.Z)({to:l,context:t}),{msg:n,usersData:i}=(0,r.CG)((e=>({usersData:e.users.byId,msg:e.message[s]})));if(!n)return null;const{from_uid:c=0}=n,d=i[c];return(0,o.jsxs)("div",{className:"reply bg-gray-100 dark:bg-gray-900 z-[999] flex flex-col md:flex-row items-start justify-start gap-4 rounded-t-lg w-full px-4 py-3 text-sm",children:[(0,o.jsxs)("div",{className:"whitespace-nowrap text-gray-400 ",children:["Replying to ",(0,o.jsx)("span",{className:"font-bold text-gray-600 dark:text-gray-400",children:null===d||void 0===d?void 0:d.name})]}),(0,o.jsx)("div",{className:"text-gray-500 overflow-hidden pr-7 ",children:Ze(n)}),(0,o.jsx)("button",{className:"absolute top-4 right-4 cursor-pointer",onClick:()=>{a()},children:(0,o.jsx)(we.Z,{className:"dark:fill-gray-400"})})]})}var Me;function Le(){return Le=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},Le.apply(this,arguments)}const Ie=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",Le({width:24,height:24,viewBox:"0 0 24 24",fill:"#667085",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,Me||(Me=s.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM17 13H13V17H11V13H7V11H11V7H13V11H17V13Z"})))},Ee=(0,s.forwardRef)(Ie);var De;function Oe(){return Oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},Oe.apply(this,arguments)}const Ve=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",Oe({width:24,height:24,viewBox:"0 0 24 24",fill:"#667085",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,De||(De=s.createElement("path",{d:"M9 4C9 3.44772 8.55228 3 8 3C7.44772 3 7 3.44772 7 4V6.5C7 6.77614 6.77614 7 6.5 7H4C3.44772 7 3 7.44772 3 8C3 8.55228 3.44772 9 4 9H6.5C7.88071 9 9 7.88071 9 6.5V4ZM9 20C9 20.5523 8.55228 21 8 21C7.44772 21 7 20.5523 7 20V17.5C7 17.2239 6.77614 17 6.5 17H4C3.44772 17 3 16.5523 3 16C3 15.4477 3.44772 15 4 15H6.5C7.88071 15 9 16.1193 9 17.5V20ZM16 3C15.4477 3 15 3.44772 15 4V6.5C15 7.88071 16.1193 9 17.5 9H20C20.5523 9 21 8.55228 21 8C21 7.44772 20.5523 7 20 7H17.5C17.2239 7 17 6.77614 17 6.5V4C17 3.44772 16.5523 3 16 3ZM15 20C15 20.5523 15.4477 21 16 21C16.5523 21 17 20.5523 17 20V17.5C17 17.2239 17.2239 17 17.5 17H20C20.5523 17 21 16.5523 21 16C21 15.4477 20.5523 15 20 15H17.5C16.1193 15 15 16.1193 15 17.5V20Z"})))},$e=(0,s.forwardRef)(Ve);var Se;function He(){return He=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},He.apply(this,arguments)}const Re=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",He({width:24,height:24,viewBox:"0 0 24 24",fill:"#667085",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,Se||(Se=s.createElement("path",{d:"M5 6C5 5.44772 5.44772 5 6 5H8C8.55228 5 9 4.55228 9 4C9 3.44772 8.55228 3 8 3H6C4.34315 3 3 4.34315 3 6V8C3 8.55228 3.44772 9 4 9C4.55228 9 5 8.55228 5 8V6ZM5 18C5 18.5523 5.44772 19 6 19H8C8.55228 19 9 19.4477 9 20C9 20.5523 8.55228 21 8 21H6C4.34315 21 3 19.6569 3 18V16C3 15.4477 3.44772 15 4 15C4.55228 15 5 15.4477 5 16V18ZM18 5C18.5523 5 19 5.44772 19 6V8C19 8.55228 19.4477 9 20 9C20.5523 9 21 8.55228 21 8V6C21 4.34315 19.6569 3 18 3H16C15.4477 3 15 3.44772 15 4C15 4.55228 15.4477 5 16 5H18ZM19 18C19 18.5523 18.5523 19 18 19H16C15.4477 19 15 19.4477 15 20C15 20.5523 15.4477 21 16 21H18C19.6569 21 21 19.6569 21 18V16C21 15.4477 20.5523 15 20 15C19.4477 15 19 15.4477 19 16V18Z"})))},Te=(0,s.forwardRef)(Re);var Fe;function Ge(){return Ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},Ge.apply(this,arguments)}const Ue=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",Ge({width:24,height:24,viewBox:"0 0 24 24",fill:"#667085",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,Fe||(Fe=s.createElement("path",{d:"M3 2H21C21.2652 2 21.5196 2.11706 21.7071 2.32544C21.8946 2.53381 22 2.81643 22 3.11111V20.8889C22 21.1836 21.8946 21.4662 21.7071 21.6746C21.5196 21.8829 21.2652 22 21 22H3C2.73478 22 2.48043 21.8829 2.29289 21.6746C2.10536 21.4662 2 21.1836 2 20.8889V3.11111C2 2.81643 2.10536 2.53381 2.29289 2.32544C2.48043 2.11706 2.73478 2 3 2ZM7 15.8889V11.4444L9 13.6667L11 11.4444V15.8889H13V8.11111H11L9 10.3333L7 8.11111H5V15.8889H7ZM18 12.5556V8.11111H16V12.5556H14L17 15.8889L20 12.5556H18Z"})))},Pe=(0,s.forwardRef)(Ue);var ze;function Be(){return Be=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},Be.apply(this,arguments)}const Ae=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",Be({xmlns:"http://www.w3.org/2000/svg",fill:"#667085",width:24,height:24,viewBox:"0 0 24 24",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,ze||(ze=s.createElement("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"})))},Ke=(0,s.forwardRef)(Ae),We=e=>{let{sendMessages:t,sendVisible:l,toggleMarkdownFullscreen:a,fullscreen:n,toggleMode:r,mode:i,to:c,context:d}=e;const{t:u}=(0,x.$G)(),{addStageFile:m}=(0,W.Z)({context:d,id:c}),h=(0,s.useRef)(null),p="markdown"==i;return(0,o.jsxs)("div",{className:"hidden md:flex flex-col md:flex-row items-center justify-end gap-2.5",children:[(0,o.jsxs)("div",{className:"flex cursor-pointer gap-3.5",children:[(0,o.jsx)(v.Z,{placement:"top",tip:"Markdown",children:(0,o.jsx)(Pe,{className:p?"fill-primary-400":"dark:fill-gray-300",onClick:r})}),p&&(n?(0,o.jsx)(v.Z,{placement:"top",tip:"Exit Fullscreen",children:(0,o.jsx)($e,{onClick:a,className:"dark:fill-gray-300"})}):(0,o.jsx)(v.Z,{placement:"top",tip:"Fullscreen",children:(0,o.jsx)(Te,{onClick:a,className:"dark:fill-gray-300"})}))]}),!p&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(v.Z,{placement:"top",tip:u("action.upload"),children:(0,o.jsxs)("div",{className:"cursor-pointer relative w-6 h-6",children:[(0,o.jsx)(Ee,{className:"dark:fill-gray-300"}),(0,o.jsx)("label",{htmlFor:"file",className:" cursor-pointer absolute left-0 top-0 w-full h-full opacity-0",children:(0,o.jsx)("input",{className:"hidden",size:24,ref:h,multiple:!0,onChange:e=>{if(!e.target.files)return;const t=Array.from(e.target.files).map((e=>{const{size:t,type:l,name:s}=e;return{size:t,type:l,name:s,url:URL.createObjectURL(e)}}));m(t),h.current.value=null,h.current.value=""},type:"file",name:"file",id:"file"})})]})}),l&&(0,o.jsx)(v.Z,{placement:"top",tip:"Send",children:(0,o.jsx)(Ke,{className:"w-6 h-6 cursor-pointer animate-zoomIn dark:fill-gray-300",onClick:t.bind(null,void 0)})})]})]})};var Ye=l(9925),qe=l(28533),Qe=l(97601),Je=l(99487);function Xe(e){let{name:t,closeModal:l,updateName:a}=e;const[n,r]=(0,s.useState)(t);return(0,o.jsx)(Qe.Z,{children:(0,o.jsxs)("div",{className:"bg-white dark:bg-gray-800 flex flex-col drop-shadow rounded-xl p-4 w-[406px]",children:[(0,o.jsxs)("h4",{className:"flex items-center justify-between font-semibold text-lg text-gray-700 dark:text-gray-100 w-full",children:["File Details ",(0,o.jsx)($.Z,{className:"cursor-pointer dark:fill-white",onClick:l})]}),(0,o.jsxs)("div",{className:"py-4 flex flex-col gap-2",children:[(0,o.jsx)("label",{className:"font-semibold text-sm text-gray-600 dark:text-gray-200",htmlFor:"name",children:"Name"}),(0,o.jsx)(Je.Z,{id:"name",value:n,onChange:e=>{r(e.target.value)}})]}),(0,o.jsxs)("div",{className:"flex justify-end gap-4 mt-8 w-full",children:[(0,o.jsx)(q.Z,{className:"ghost cancel",onClick:l,children:"Cancel"}),(0,o.jsx)(q.Z,{onClick:()=>{a(n),l()},children:"Save Changes"})]})]})})}function et(e){let{context:t,id:l}=e;const a=he(`${t}_${l}`),[n,r]=(0,s.useState)(null),{stageFiles:i,updateStageFile:c,removeStageFile:d}=(0,W.Z)({context:t,id:l}),u=e=>{r((t=>t?null:e))},m=e=>{const t=i[`${e}`];t&&u({...t,index:e})};return(0,s.useEffect)((()=>{a.focus()}),[i.length]),t&&l&&i&&0!=i.length?(0,o.jsxs)(o.Fragment,{children:[n&&(0,o.jsx)(Xe,{name:n.name,updateName:e=>{if(!e||!n)return;const{index:t}=n;c(t,{name:e})},closeModal:u}),(0,o.jsx)("ul",{className:"w-full overflow-auto flex gap-2 justify-start p-4 pt-6 bg-gray-200 dark:bg-gray-800 rounded-t-lg",children:i.map(((e,t)=>{let{name:l,url:s,size:a,type:n}=e;return(0,o.jsxs)("li",{className:"group relative flex flex-col bg-gray-100 dark:bg-gray-700 rounded p-2",children:[(0,o.jsx)("div",{className:"flex-center w-40 h-40",children:n.startsWith("image")?(0,o.jsx)("img",{className:"w-full h-full object-cover",src:s,alt:"image"}):(0,Y.LP)(n,l)}),(0,o.jsx)("h4",{className:"w-40 mt-4 mb-0.5 font-semibold text-sm text-gray-800 dark:text-gray-100 truncate",children:l}),(0,o.jsx)("span",{className:"text-xs text-gray-500",children:(0,Y.td)(a)}),(0,o.jsxs)("ul",{className:"invisible group-hover:visible bg-inherit border border-solid border-black/10 box-border rounded-md flex items-center absolute -right-5 -top-2.5",children:[(0,o.jsx)("li",{className:"p-1 cursor-pointer edit",onClick:m.bind(null,t),children:(0,o.jsx)(qe.Z,{})}),(0,o.jsx)("li",{className:"p-1 cursor-pointer delete","data-index":t,onClick:d.bind(null,t),children:(0,o.jsx)(Ye.Z,{})})]})]},s)}))})]}):null}const tt="text",lt="markdown",st=e=>{var t,l,a,i;let{context:c="channel",id:d}=e;const{t:u}=(0,x.$G)("chat"),{unblockThisContact:m,blocked:h}=(0,se.Z)({uid:"dm"==c?d:void 0,cid:"channel"==c?d:void 0}),{resetStageFiles:p}=(0,W.Z)({context:c,id:d}),{getDraft:g,getUpdateDraft:f}=te({context:c,id:d}),v=he(`${c}_${d}`),[b,j]=(0,s.useState)([]),[y,C]=(0,s.useState)(null),[k,Z]=(0,s.useState)(!1),_=(0,r.TL)(),M=function(e){let{context:t,to:l}=e;const s=(0,w.I0)(),a="channel"==t?X.p_:ee.ZK;return e=>{s((0,J.Hz)(e)),s(a({id:l,mid:e.mid}))}}({context:c,to:d}),{from_uid:L,replying_mid:I,mode:E,uploadFiles:D,channelsData:O,usersData:V,uids:$}=(0,r.CG)((e=>{var t,l;return{channelsData:e.channels.byId,uids:e.users.ids,usersData:e.users.byId,mode:e.ui.inputMode,from_uid:null===(t=e.authData.user)||void 0===t?void 0:t.uid,replying_mid:e.message.replying[`${c}_${d}`],uploadFiles:null!==(l=e.ui.uploadFiles[`${c}_${d}`])&&void 0!==l?l:[]}})),{sendMessage:S}=(0,le.Z)({context:c,from:L,to:d});(0,s.useEffect)((()=>{I&&v.focus()}),[I]);const H=async e=>{if(!d)return;const t=null!==e&&void 0!==e?e:b;if(v.resetInput(),t&&t.length)for await(const s of t){var l;const{type:e,content:t,properties:a={}}=s;""!==t.trim()&&(a.local_id=null!==(l=a.local_id)&&void 0!==l?l:+new Date,await S({id:d,reply_mid:I,type:e,content:t,from_uid:L,properties:a}))}0!==D.length&&(D.forEach((e=>{const t=+new Date,{url:l,name:s,size:a,type:n}=e,r={mid:t,content:l,content_type:z.bT.file,created_at:t,properties:{content_type:n,name:s,size:a,local_id:t},from_uid:L,sending:!0};M(r)})),p())},R="channel"==c?null===(t=O[d])||void 0===t?void 0:t.name:null===(l=V[d])||void 0===l?void 0:l.name,T=`${u("send_to")} ${z.rR[c]}${R} `,F="channel"==c?null!==(a=O[d])&&void 0!==a&&a.is_public?$:null===(i=O[d])||void 0===i?void 0:i.members:[],G=E==lt;return"dm"==c&&h?(0,o.jsxs)("div",{className:"p-5 bg-gray-200 rounded-lg w-full dark:bg-gray-600 text-red-300",children:[u("contact_block_tip"),(0,o.jsx)(q.Z,{className:"mini ml-4",onClick:m,children:u("unblock")})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(fe,{sendMessage:H,placeholder:T}),(0,o.jsxs)("div",{className:(0,n.Z)(`send hidden md:block relative bg-gray-200 rounded-lg w-full dark:bg-gray-600 ${E} ${k?"fullscreen":""} ${I?"reply":""} ${c}`,G&&k&&"-mt-9"),children:[I&&(0,o.jsx)(_e,{context:c,mid:I,id:d}),E==tt&&(0,o.jsx)(et,{context:c,id:d}),(0,o.jsxs)("div",{className:(0,n.Z)("flex justify-between items-center gap-4 px-4 py-3.5",G&&"grid grid-cols-[1fr_1fr] grid-rows-[auto_auto] gap-0"),children:[(0,o.jsx)(ye,{selectEmoji:e=>{E==lt&&y?y.insertText(e):v.insertText(e)}}),E==tt&&(0,o.jsx)(pe,{updateMessages:j,updateDraft:f(),initialValue:g(),members:F,id:`${c}_${d}`,placeholder:T,sendMessages:H}),(0,o.jsx)(We,{sendMessages:H,sendVisible:b.length>0||D.length>0,context:c,to:d,mode:E,toggleMode:()=>{_((0,N.XH)(E==tt?lt:tt))},fullscreen:k,toggleMarkdownFullscreen:()=>{Z((e=>!e))}}),E==lt&&(0,o.jsx)(Q,{updateDraft:f("markdown"),initialValue:g("markdown"),height:k?"calc(100vh - 168px)":"30vh",placeholder:T,setEditorInstance:C,sendMarkdown:async e=>{S({id:d,reply_mid:I,type:"markdown",content:e,from_uid:L,properties:{local_id:+new Date}})}})]})]})]})};var at,nt,rt=l(53878);function it(){return it=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},it.apply(this,arguments)}const ct=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",it({width:32,height:32,viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,at||(at=s.createElement("rect",{width:32,height:32,rx:16,fill:"#FEF0C7"})),nt||(nt=s.createElement("path",{d:"M15.9998 13.3333V16M15.9998 18.6667H16.0064M14.8598 9.90666L9.2131 19.3333C9.09668 19.5349 9.03508 19.7635 9.03443 19.9963C9.03378 20.2292 9.0941 20.4581 9.20939 20.6603C9.32468 20.8626 9.49092 21.0312 9.69157 21.1492C9.89223 21.2673 10.1203 21.3308 10.3531 21.3333H21.6464C21.8792 21.3308 22.1073 21.2673 22.308 21.1492C22.5086 21.0312 22.6749 20.8626 22.7902 20.6603C22.9054 20.4581 22.9658 20.2292 22.9651 19.9963C22.9645 19.7635 22.9029 19.5349 22.7864 19.3333L17.1398 9.90666C17.0209 9.71073 16.8536 9.54874 16.6539 9.43632C16.4542 9.32389 16.2289 9.26483 15.9998 9.26483C15.7706 9.26483 15.5453 9.32389 15.3456 9.43632C15.146 9.54874 14.9786 9.71073 14.8598 9.90666Z",stroke:"#DC6803",strokeWidth:1.33333,strokeLinecap:"round",strokeLinejoin:"round"})))},dt=(0,s.forwardRef)(ct);var ot,ut=l(88228);function mt(){return mt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},mt.apply(this,arguments)}const xt=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",mt({width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"#101828",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,ot||(ot=s.createElement("path",{d:"M4.93 4.93L19.07 19.07M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12Z",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))},ht=(0,s.forwardRef)(xt);var pt=l(52334);const gt=e=>{const{t:t}=(0,x.$G)("chat"),[l]=(0,pt.C6)(),{targetUser:s,enableContact:a}=(0,r.CG)((t=>({targetUser:t.users.byId[e.uid],enableContact:t.server.contact_verification_enable}))),n=t=>{l({target_uid:e.uid,action:t})},i="cursor-pointer flex flex-col items-center gap-1 rounded-lg w-32 text-primary-400 bg-gray-50 dark:bg-gray-800 text-sm pt-3.5 pb-3";if(!s||!a)return null;if("added"==s.status)return null;const c="blocked"==s.status;return(0,o.jsxs)("div",{className:"py-4 px-10 flex flex-col items-center gap-3 bg-slate-100 dark:bg-slate-600",children:[(0,o.jsx)("h3",{className:"text-gray-700 dark:text-gray-300 text-sm font-semibold",children:t(c?"contact_block_tip":"contact_tip")}),(0,o.jsxs)("ul",{className:"flex gap-4",children:[!c&&(0,o.jsxs)("li",{className:i,onClick:n.bind(null,"add"),children:[(0,o.jsx)(ut.Z,{className:"fill-primary-400"}),(0,o.jsx)("span",{children:t("add_contact")})]}),(0,o.jsxs)("li",{className:i,onClick:n.bind(null,c?"unblock":"block"),children:[(0,o.jsx)(ht,{className:"stroke-primary-400"}),(0,o.jsx)("span",{children:t(c?"unblock":"block")})]})]})]})};var ft,vt,bt=l(971),jt=l(16956),yt=l(56885),wt=l(80829),Ct=l.n(wt),Nt=l(33568),kt=l(38761);function Zt(){return Zt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},Zt.apply(this,arguments)}const _t=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",Zt({width:24,height:24,viewBox:"0 0 24 24",fill:"#344054",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,ft||(ft=s.createElement("path",{d:"M3.28034 2.21968C2.98745 1.92678 2.51257 1.92677 2.21968 2.21966C1.92678 2.51255 1.92677 2.98743 2.21966 3.28032L3.78662 4.84731C2.72676 5.38269 2 6.48147 2 7.75V16.25C2 18.0449 3.45507 19.5 5.25 19.5H12.75C14.2943 19.5 15.5871 18.4229 15.9179 16.9789L20.7194 21.7805C21.0123 22.0734 21.4872 22.0734 21.7801 21.7805C22.073 21.4876 22.073 21.0127 21.7801 20.7198L3.28034 2.21968ZM17 13.8182L21.5042 18.3226C21.8008 18.1491 22 17.8272 22 17.4588V6.54096C22 6.30368 21.9156 6.07414 21.762 5.89334C21.4043 5.47252 20.7732 5.42132 20.3524 5.77899L17 8.62794V13.8182ZM7.68194 4.5L16 12.8182V7.75C16 5.95508 14.5449 4.5 12.75 4.5H7.68194Z"})),vt||(vt=s.createElement("path",{d:"M2.21968 2.21966C2.51257 1.92677 2.98745 1.92678 3.28034 2.21968L21.7801 20.7198C22.073 21.0127 22.073 21.4876 21.7801 21.7805C21.4872 22.0734 21.0123 22.0734 20.7194 21.7805L2.21966 3.28032C1.92677 2.98743 1.92678 2.51255 2.21968 2.21966Z",fill:"#D92D20"})))},Mt=(0,s.forwardRef)(_t);var Lt;function It(){return It=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},It.apply(this,arguments)}const Et=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",It({width:24,height:24,viewBox:"0 0 24 24",fill:"#1D2939",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,Lt||(Lt=s.createElement("path",{d:"M16 16.25C16 18.0449 14.5449 19.5 12.75 19.5H5.25C3.45507 19.5 2 18.0449 2 16.25V7.75C2 5.95507 3.45507 4.5 5.25 4.5H12.75C14.5449 4.5 16 5.95507 16 7.75V16.25ZM21.762 5.89334C21.9156 6.07414 22 6.30368 22 6.54096V17.4588C22 18.0111 21.5523 18.4588 21 18.4588C20.7627 18.4588 20.5332 18.3744 20.3524 18.2208L17 15.3709V8.62794L20.3524 5.77899C20.7732 5.42132 21.4043 5.47252 21.762 5.89334Z"})))},Dt=(0,s.forwardRef)(Et);var Ot,Vt,$t=l(18697);function St(){return St=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},St.apply(this,arguments)}const Ht=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",St({viewBox:"0 0 24 24",width:"24px",height:"24px",fill:"#78787C",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,Ot||(Ot=s.createElement("path",{d:"M 3.28 2.22 C 2.987 1.927 2.513 1.927 2.22 2.22 C 1.927 2.513 1.927 2.987 2.22 3.28 L 8 9.061 L 8 12 C 8 14.209 9.791 16 12 16 C 12.834 16 13.607 15.745 14.248 15.309 L 15.394 16.455 C 14.518 17.111 13.429 17.5 12.25 17.5 L 11.75 17.5 L 11.534 17.496 C 8.734 17.382 6.5 15.077 6.5 12.25 L 6.5 11.75 L 6.493 11.648 C 6.443 11.282 6.13 11 5.75 11 C 5.336 11 5 11.336 5 11.75 L 5 12.25 L 5.004 12.486 C 5.123 15.938 7.833 18.732 11.25 18.982 L 11.25 21.25 L 11.257 21.352 C 11.306 21.718 11.62 22 12 22 C 12.414 22 12.75 21.664 12.75 21.25 L 12.751 18.982 C 14.15 18.879 15.431 18.35 16.463 17.524 L 20.719 21.781 C 21.012 22.073 21.487 22.073 21.78 21.781 C 22.073 21.488 22.073 21.013 21.78 20.72 L 3.28 2.22 Z M 17.196 14.014 L 18.342 15.16 C 18.764 14.279 19 13.292 19 12.25 L 19 11.75 L 18.993 11.648 C 18.943 11.282 18.63 11 18.25 11 C 17.836 11 17.5 11.336 17.5 11.75 L 17.5 12.25 L 17.496 12.466 C 17.474 13.008 17.37 13.528 17.196 14.014 Z M 8.138 4.956 L 15.93 12.748 C 15.976 12.506 16 12.256 16 12 L 16 6 C 16 3.791 14.209 2 12 2 C 10.152 2 8.597 3.253 8.138 4.956 Z"})),Vt||(Vt=s.createElement("path",{d:"M 2.22 2.22 C 2.513 1.927 2.987 1.927 3.28 2.22 L 21.78 20.72 C 22.073 21.013 22.073 21.488 21.78 21.781 C 21.487 22.073 21.012 22.073 20.719 21.781 L 2.22 3.28 C 1.927 2.987 1.927 2.513 2.22 2.22 Z",fill:"#D92D20"})))},Rt=(0,s.forwardRef)(Ht);var Tt;function Ft(){return Ft=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},Ft.apply(this,arguments)}const Gt=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",Ft({width:24,height:24,viewBox:"0 0 24 24",fill:"#78787C",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,Tt||(Tt=s.createElement("path",{d:"M18.25 11C18.6297 11 18.9435 11.2822 18.9932 11.6482L19 11.75V12.25C19 15.8094 16.245 18.7254 12.751 18.9817L12.75 21.25C12.75 21.6642 12.4142 22 12 22C11.6203 22 11.3065 21.7178 11.2568 21.3518L11.25 21.25L11.25 18.9818C7.83323 18.7316 5.12283 15.938 5.00406 12.4863L5 12.25V11.75C5 11.3358 5.33579 11 5.75 11C6.1297 11 6.44349 11.2822 6.49315 11.6482L6.5 11.75V12.25C6.5 15.077 8.73445 17.3821 11.5336 17.4956L11.75 17.5H12.25C15.077 17.5 17.3821 15.2656 17.4956 12.4664L17.5 12.25V11.75C17.5 11.3358 17.8358 11 18.25 11ZM12 2C14.2091 2 16 3.79086 16 6V12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12V6C8 3.79086 9.79086 2 12 2Z"})))},Ut=(0,s.forwardRef)(Gt);var Pt;function zt(){return zt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},zt.apply(this,arguments)}const Bt=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",zt({width:25,height:24,viewBox:"0 0 25 24",fill:"#344054",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,Pt||(Pt=s.createElement("path",{d:"M4.58301 4C3.34037 4 2.33301 5.00736 2.33301 6.25V17.75C2.33301 18.9926 3.34037 20 4.58301 20H20.083C21.3256 20 22.333 18.9926 22.333 17.75V6.25C22.333 5.00736 21.3256 4 20.083 4H4.58301ZM12.8633 7.46515L16.1178 10.7197C16.4107 11.0126 16.4107 11.4874 16.1178 11.7803C15.825 12.0732 15.3501 12.0732 15.0572 11.7803L13.083 9.80614V16.2528C13.083 16.6671 12.7472 17.0028 12.333 17.0028C11.9188 17.0028 11.583 16.6671 11.583 16.2528V9.80793L9.61371 11.78C9.32102 12.0731 8.84614 12.0734 8.55305 11.7807C8.25995 11.488 8.25962 11.0131 8.55231 10.72L11.8023 7.46552C11.9429 7.32471 12.1337 7.24555 12.3327 7.24548C12.5317 7.24541 12.7226 7.32444 12.8633 7.46515Z"})))},At=(0,s.forwardRef)(Bt);var Kt=l(15475);const Wt=e=>{let{type:t,visible:l,setVisible:s,devices:a}=e;const i=(0,r.CG)((e=>{var t,l;return null!==(t=null===(l=e.authData.user)||void 0===l?void 0:l.uid)&&void 0!==t?t:0})),c=(0,w.I0)(),d=e=>{const{deviceId:t="",kind:l,selected:s=""}=e.currentTarget.dataset;if(s!=t&&l)switch(l){case"audiooutput":case"audioinput":{const e=window.VOICE_TRACK_MAP[i];c((0,bt.j3)({kind:l,value:t})),e&&e.setDevice(t).then((()=>{})).catch((e=>{}))}break;case"videoinput":{const e=window.VIDEO_TRACK_MAP[i];e&&e.setDevice(t).then((()=>{c((0,bt.j3)({kind:l,value:t}))})).catch((e=>{}))}}};return(0,o.jsx)(p.ZP,{onClickOutside:()=>s(""),interactive:!0,popperOptions:{strategy:"fixed"},visible:l==t,placement:"top-start",content:(0,o.jsx)("div",{onClick:e=>{e.stopPropagation()},className:"px-3 pb-3 bg-white dark:bg-gray-800 overflow-auto rounded-lg flex flex-col gap-3 divide-gray-500/50 divide-y-[1px] items-start relative drop-shadow",children:a.map((e=>{let{title:t,list:l,selected:s}=e;return 0==l.length?null:(0,o.jsxs)("div",{className:"w-full flex flex-col items-start gap-2 pt-3",children:[(0,o.jsx)("p",{className:"text-gray-500 text-xs",children:t}),(0,o.jsx)("ul",{className:"w-full flex flex-col gap-4",children:l.map((e=>{let{deviceId:t,kind:l,label:a}=e;return(0,o.jsxs)("li",{"data-selected":s,"data-kind":l,"data-device-id":t,className:"relative rounded-sm cursor-pointer flex items-center justify-between gap-4 text-gray-500 hover:text-gray-900 dark:text-gray-300 hover:dark:text-gray-100 font-semibold text-sm whitespace-nowrap",onClick:d,children:[a,(0,o.jsx)("i",{className:"w-4 h-3",children:s==t&&(0,o.jsx)($t.Z,{className:(0,n.Z)("shrink-0")})})]},a)}))})]},t)}))}),children:(0,o.jsx)("div",{onClick:e=>{e.stopPropagation(),s((e=>e==t?"":t))},className:"group p-1 absolute rounded-sm top-0.5 right-0.5 hover:bg-gray-300/50",role:"button",children:(0,o.jsx)(Nt.Z,{className:(0,n.Z)("w-2 fill-gray-600 group-hover:fill-gray-900 dark:fill-white transition-transform",l==t&&"rotate-180")})})})},Yt=e=>{let{id:t,context:l,mode:a="channel"}=e;const i=(0,w.I0)(),c=(0,r.CG)((e=>{var t,l;return null!==(t=null===(l=e.authData.user)||void 0===l?void 0:l.uid)&&void 0!==t?t:0})),[d,u]=(0,s.useState)(""),{exitFullscreen:m,enterFullscreen:h,fullscreen:p,voicingInfo:g,leave:f,setMute:b,closeCamera:j,openCamera:y,startShareScreen:C,stopShareScreen:N,audioInputDevices:k,audioOutputDevices:Z,videoInputDevices:_,videoInputDeviceId:M,audioInputDeviceId:L,audioOutputDeviceId:I}=(0,Kt.Z)({id:t,context:l}),{t:E}=(0,x.$G)("chat");if((0,s.useEffect)((()=>{Ct().getDevices().then((e=>{i((0,bt.hG)(e.map((e=>{const{deviceId:t,groupId:l,label:s,kind:a}=e;return{deviceId:t,groupId:l,label:s,kind:a}}))))})).catch((e=>{}))}),[]),!g)return null;const{muted:D,video:O,shareScreen:V}=g,$=(0,n.Z)("flex-center py-2 px-3 rounded bg-gray-100 dark:bg-gray-900 relative disabled:pointer-events-none disabled:opacity-50"),S=(0,n.Z)("w-[25px] h-6 m-auto fill-gray-700 dark:fill-gray-300");return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(v.Z,{disabled:"audio"==d,tip:E(D?"unmute":"mute"),placement:"top",children:(0,o.jsxs)("button",{disabled:0==k.length&&0==Z.length,onClick:b.bind(null,!D),className:$,children:[D?(0,o.jsx)(Rt,{className:S}):(0,o.jsx)(Ut,{className:S}),(0,o.jsx)(Wt,{visible:d,setVisible:u,type:"audio",devices:[{title:"Input Device",list:k,selected:L},{title:"Output Device",list:Z,selected:I}]})]})}),(0,o.jsx)(v.Z,{disabled:"video"==d,tip:E(O?"camera_off":"camera_on"),placement:"top",children:(0,o.jsxs)("button",{disabled:0==_.length,onClick:O?j:y,className:$,children:[O?(0,o.jsx)(Dt,{className:S}):(0,o.jsx)(Mt,{className:S}),(0,o.jsx)(Wt,{visible:d,setVisible:u,type:"video",devices:[{title:"Camera Device",list:_,selected:M}]})]})}),(0,o.jsx)(v.Z,{tip:"Share Screen",placement:"top",children:(0,o.jsx)("button",{onClick:V?N:C,className:(0,n.Z)("py-2 px-3 rounded",V?"bg-green-700":"bg-gray-100 dark:bg-gray-900"),children:(0,o.jsx)(At,{className:(0,n.Z)("w-6 h-6 dark:fill-gray-300",V?"fill-gray-200":"fill-gray-800")})})}),(0,o.jsx)(v.Z,{tip:"Fullscreen",placement:"top",children:(0,o.jsx)("button",{onClick:p?m:h.bind(null,"dm"==l?c:void 0),className:$,children:p?(0,o.jsx)($e,{className:S}):(0,o.jsx)(Te,{className:S})})}),"dm"!==a&&(0,o.jsx)(v.Z,{tip:E("leave_voice"),placement:"top",children:(0,o.jsx)("button",{onClick:f,className:(0,n.Z)("py-2 px-3 rounded bg-red-600 hover:bg-red-700","fullscreen"!==a&&"col-span-4"),children:(0,o.jsx)(kt.Z,{className:"m-auto w-[25px] h-6"})})})]})};var qt=l(97655);const Qt=e=>{let{onlyToSelf:t,sendByMe:l,connected:s,from:a,to:r}=e;const i=[a,r].map(((e,a)=>{let{id:r,speaking:i,name:c,avatar:d,video:u,muted:m}=e;const x=1==a&&!s&&!l&&!t,h=1==a&&!s&&l,p=l?0==a:1==a,g=t&&0==a;return(0,o.jsxs)("div",{className:(0,n.Z)("group relative flex-center",u?"w-[500px] h-[280px] overflow-hidden rounded":"",g&&"hidden"),children:[(0,o.jsxs)("div",{className:(0,n.Z)("w-20 h-20 flex shrink-0 relative transition-opacity",h&&"animate-pulse",x&&"opacity-40"),children:[i&&(0,o.jsx)("div",{className:(0,n.Z)("z-10 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 opacity-0 rounded-full bg-green-500 animate-speaking","w-[86px] h-[86px]")}),h&&(0,o.jsx)("div",{className:(0,n.Z)("z-10 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full bg-gray-400","w-[88px] h-[88px]")}),(0,o.jsx)(jt.Z,{width:80,height:80,className:(0,n.Z)("z-20 w-full h-full rounded-full object-cover"),src:d,name:c,alt:"avatar"})]}),(0,o.jsx)("div",{className:(0,n.Z)("z-30 absolute left-0 top-0 w-full h-full",!u&&"hidden"),id:`CAMERA_${r}`}),u&&(0,o.jsx)("span",{className:(0,n.Z)("text-gray-300 bg-black/50 rounded absolute z-40","left-1 bottom-1 py-1 px-2 text-xs"),title:c,children:c}),m&&!p&&(0,o.jsx)("span",{className:(0,n.Z)("bg-black/50 rounded absolute z-40 right-1 bottom-1 p-1",u&&"invisible group-hover:visible"),title:c,children:(0,o.jsx)(Rt,{className:"w-4 h-4 fill-gray-300"})})]},r)}));return(0,o.jsx)(o.Fragment,{children:i})},Jt=e=>{var t,l;let{uid:a}=e;const i=(0,w.I0)(),{voice:{callingFrom:c,callingTo:d,voicingMembers:u},userData:m,loginUser:x}=(0,r.CG)((e=>({voice:e.voice,userData:e.users.byId,loginUser:e.authData.user}))),{leave:h,joinVoice:p,joining:g}=(0,yt.M)({id:d,context:"dm"});if((0,s.useEffect)((()=>{u.ids.forEach((e=>{(0,Y.L_)(e)}))}),[u.ids]),![c,d].includes(a))return null;const{name:f,avatar:b}=m[c],{name:j,avatar:y,uid:C}=m[d],N=(null===x||void 0===x?void 0:x.uid)!==C,k=1==u.ids.length&&u.ids[0]==d,Z=2==u.ids.length,{speakingVolume:_=0,muted:M=!1,video:L=!1,shareScreen:I=!1}=null!==(t=u.byId[d])&&void 0!==t?t:{},E=_>50,{speakingVolume:D=0,muted:O=!1,video:V=!1,shareScreen:$=!1}=null!==(l=u.byId[c])&&void 0!==l?l:{},S=D>50;return(0,o.jsxs)("div",{className:"py-4 px-10 flex flex-col items-center gap-3 bg-slate-200 dark:bg-slate-800",children:[(0,o.jsx)("div",{className:"flex items-center gap-4",children:(0,o.jsx)(Qt,{onlyToSelf:k,sendByMe:N,connected:Z,from:{id:c,muted:O,video:V||$,speaking:S,name:f,avatar:b},to:{muted:M,id:d,video:L||I,speaking:E,name:j,avatar:y}})}),(0,o.jsxs)("div",{className:(0,n.Z)("flex gap-3",Z?"h-full items-end":""),children:[(N||Z||k)&&(0,o.jsx)(v.Z,{tip:"Leave",placement:"top",children:(0,o.jsx)("button",{onClick:()=>{(N||2==u.ids.length||k)&&h(),(N||1==u.ids.length)&&i((0,bt.vH)({from:0,to:0}))},className:"flex-center bg-red-600 hover:bg-red-700 py-2 px-3 rounded",children:(0,o.jsx)(kt.Z,{className:"w-6 h-6"})})}),!N&&!Z&&!k&&(0,o.jsx)(v.Z,{tip:"Answer",placement:"top",children:(0,o.jsx)("button",{disabled:g,onClick:()=>{p()},className:"flex-center bg-green-600 hover:bg-green-700 py-2 px-3 rounded",children:(0,o.jsx)(qt.Z,{className:"w-6 h-6 fill-white"})})}),Z&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Yt,{id:d,context:"dm",mode:"dm"})})]})]})},Xt=e=>{let{context:t,name:l}=e;const{t:s}=(0,x.$G)("chat");return(0,o.jsx)("div",{className:"z-50 flex-center absolute left-0 top-0 w-full h-full bg-black/50",children:(0,o.jsx)("div",{className:"p-4 drop-shadow-md rounded-lg bg-primary-300",children:(0,o.jsxs)("div",{className:"p-4 pt-16 border-2 border-dashed border-primary-300 rounded-md flex flex-col items-center text-white",children:[(0,o.jsx)("h4",{className:"text-xl font-semibold",children:`${s("send_to")} ${z.rR[t]}${l}`}),(0,o.jsx)("span",{className:"text-sm",children:"Photos accept jpg, png, max size limit to 10M."})]})})})},el=()=>{const{t:e}=(0,x.$G)("chat"),t=(0,a.s0)();return(0,o.jsxs)("div",{className:"flex items-center justify-between bg-red-600 rounded-md w-full py-3 px-4",children:[(0,o.jsxs)("span",{className:"text-white",children:[(0,o.jsx)("i",{className:"text-xl mr-2",children:"\ud83d\udea8"}),e("license_tip")]}),(0,o.jsx)(q.Z,{onClick:()=>{t("/setting/license")},className:"small",children:"Upgrade License"})]})};var tl=l(21645),ll=l(47350);const sl=e=>{let{placement:t="chat"}=e;const{t:l}=(0,x.$G)("welcome"),{t:s}=(0,x.$G)(),r=(0,w.I0)(),{clearLocalData:i}=(0,ll.Z)(),c=(0,a.s0)();return(0,o.jsxs)("div",{className:(0,n.Z)("flex items-center justify-between bg-slate-200/80 dark:bg-gray-800 rounded-lg p-4 border border-solid border-gray-200 dark:border-gray-500","session"==t?"!w-[96%] md:hidden fixed bottom-2 left-1/2 -translate-x-1/2":"w-full"),children:[(0,o.jsxs)("span",{className:"text-xs md:text-base text-gray-400 dark:text-gray-100",children:[(0,o.jsx)("i",{className:"mr-2 text-xs md:text-lg ",children:"\ud83d\udc4b"}),l("sign_in_tip")]}),(0,o.jsx)(q.Z,{onClick:()=>{r((0,tl.sQ)()),i(),c("/login")},className:"small",children:s("action.login")})]})};var al=l(42452),nl=l(49637),rl=l(45625),il=l(10189);const cl=e=>{let{context:t,id:l}=e;const[a,n]=(0,s.useState)(!1),{canDelete:i}=(0,rl.Z)(),{addFavorite:c}=(0,V.Z)({}),d=(0,r.CG)((e=>e.ui.selectMessages[`${t}_${l}`])),[u,m]=(0,s.useState)(!1),x=(0,r.TL)(),h=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n((e=>!e)),e&&(x((0,N.Gy)({context:t,id:l,operation:"reset"})),U.ZP.success("Messages Deleted!"))},p=()=>{m((e=>!e))};(0,re.z)("Escape",(()=>{x((0,N.Gy)({context:t,id:l,operation:"reset"}))}));const g=i(d),f="p-2 bg-slate-100 dark:bg-slate-800 rounded md:hover:bg-slate-300 dark:md:hover:bg-slate-900";return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"relative p-4 flex-center gap-8 shadow-md",children:[(0,o.jsx)("button",{className:f,onClick:p,children:(0,o.jsx)(il.Z,{})}),(0,o.jsx)("button",{className:f,onClick:async()=>{await c(d)?(x((0,N.Gy)({context:t,id:l,operation:"reset"})),U.ZP.success("Messages Saved!")):U.ZP.error("Operation Failed!")},children:(0,o.jsx)(_.Z,{})}),(0,o.jsx)("button",{className:f,disabled:!g,onClick:h.bind(null,!1),children:(0,o.jsx)(Ye.Z,{})}),(0,o.jsx)(we.Z,{className:"cursor-pointer absolute right-5 top-1/2 -translate-y-1/2",onClick:()=>{x((0,N.Gy)({context:t,id:l,operation:"reset"}))}})]}),u&&(0,o.jsx)(nl.Z,{mids:d,closeModal:p}),a&&(0,o.jsx)(al.Z,{mids:d,closeModal:h})]})};var dl=l(85910),ol=l(67883),ul=l(24783),ml=l(7788);const xl=e=>{let{context:t,id:l,scrollToBottom:s}=e;const{t:a}=(0,x.$G)("chat"),{readIndex:i,mids:c,messageData:d,loginUid:u}=(0,r.CG)((e=>{var s,a;return{readIndex:"channel"==t?e.footprint.readChannels[l]:e.footprint.readUsers[l],mids:"dm"==t?e.userMessage.byId[l]:e.channelMessage[l],selects:e.ui.selectMessages[`${t}_${l}`],loginUid:null!==(s=null===(a=e.authData.user)||void 0===a?void 0:a.uid)&&void 0!==s?s:0,data:"channel"==t?e.channels.byId[l]:void 0,messageData:e.message||{}}})),{unreads:m=0}=(0,ml.ZP)({mids:c,readIndex:i,messageData:d,loginUid:u});return(0,o.jsx)("aside",{className:(0,n.Z)("z-[999] absolute bottom-20 right-4\n                                justify-between text-xs\n                                rounded-full py-1 px-3 text-white\n                                bg-gradient-to-tl from-[#3C8CE7] to-[#00EAFF]",m>0?"flex":"hidden"),children:(0,o.jsx)("button",{onClick:s,children:a("new_msg",{num:m})})})};var hl=l(37076);const pl=e=>{let{cid:t}=e;const{pathname:l}=(0,a.TH)(),{t:s}=(0,x.$G)("chat"),{data:n,loginUser:i}=(0,r.CG)((e=>({loginUser:e.authData.user,data:e.channels.byId[t]})));return(0,o.jsxs)("div",{className:"pt-14 px-1 md:px-0 flex flex-col items-start gap-2",children:[(0,o.jsx)("h2",{className:"font-bold text-4xl dark:text-white",children:s("welcome_channel",{name:null===n||void 0===n?void 0:n.name})}),(0,o.jsxs)("p",{className:"text-gray-600 dark:text-gray-300",children:[s("welcome_desc",{name:null===n||void 0===n?void 0:n.name})," "]}),(null===i||void 0===i?void 0:i.is_admin)&&(0,o.jsxs)(h.OL,{to:`/setting/channel/${t}/overview?f=${l}`,className:"flex items-center gap-1 bg-clip-text text-fill-transparent bg-gradient-to-r from-blue-500 to-primary-400 ",children:[(0,o.jsx)(qe.Z,{className:"w-4 h-4 fill-blue-500"}),s("edit_channel")]})]})},gl=e=>{let{context:t}=e;if(!t)return null;const{id:l,isChannel:s,loadingMore:a}=t;return(0,o.jsxs)(o.Fragment,{children:[s?(0,o.jsx)(pl,{cid:l}):null,(0,o.jsx)("div",{className:(0,n.Z)("mt-2 w-full py-2 ",a?"flex-center":"hidden"),children:(0,o.jsx)(hl.Z,{size:18,lineWeight:4,speed:1,color:"#ccc"})})]})},fl=(0,s.forwardRef)(((e,t)=>{let{style:l,...s}=e;return(0,o.jsx)("div",{style:{...l,width:"calc(100% - 2rem)"},...s,ref:t})})),vl=e=>{let{context:t,id:l}=e;const a=(0,w.I0)(),[n,i]=(0,s.useState)(!1),[c,{isLoading:d,isSuccess:u,data:m}]=(0,ul.F0)(),x=(0,s.useRef)(null),[h]=(0,ul.o5)(),p=(0,ol.N)(h,300),{historyMid:g="",mids:f=[],selects:v,messageData:b,loginUser:j,footprint:y}=(0,r.CG)((e=>({historyMid:"dm"==t?e.footprint.historyUsers[l]:e.footprint.historyChannels[l],mids:"dm"==t?e.userMessage.byId[l]:e.channelMessage[l],selects:e.ui.selectMessages[`${t}_${l}`],footprint:e.footprint,loginUser:e.authData.user,messageData:e.message||{}})));(0,s.useEffect)((()=>{if(u&&m)if(0==m.length)a((0,C.aB)({type:t,id:l,mid:"reached"}));else{const[{mid:e}]=m;a((0,C.aB)({type:t,id:l,mid:`${e}`}))}}),[u,m,f,t,l]);const N=(0,s.useCallback)((()=>{const e=x.current;e&&e.scrollToIndex(f.length-1)}),[f]),k="channel"==t?y.readChannels[l]:y.readUsers[l];return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(dl.OO,{overscan:50,context:{loadingMore:d,id:l,isChannel:"channel"==t},id:`VOCECHAT_FEED_${t}_${l}`,className:"px-1 md:px-4 py-4.5 overflow-x-hidden overflow-y-scroll",ref:x,components:{List:fl,Header:gl},initialTopMostItemIndex:f.length-1,data:f,atTopThreshold:"channel"==t?160:0,atTopStateChange:e=>{if(e){if("reached"===g)return;let e=f.slice(0,1)[0];g&&(e=+g),c({context:t,id:l,mid:e})}},atBottomStateChange:e=>{i(e)},atBottomThreshold:400,followOutput:e=>{const[t]=f?f.slice(-1):[0],l=(new Date).getTime();return!(!e&&!(l-t<1e3))&&(!e||"smooth")},itemContent:(e,s)=>{const a=b[s];if(!a)return(0,o.jsx)("div",{className:"w-full h-[1px] invisible"});const n=0==e?null:b[f[e-1]],r=(null===a||void 0===a?void 0:a.from_uid)==(null===j||void 0===j?void 0:j.uid)||s<=k;return(0,ml.R7)({selectMode:!!v,updateReadIndex:p,read:r,prev:n,curr:a,contextId:l,context:t})}}),!n&&(0,o.jsx)(xl,{context:t,id:l,scrollToBottom:N})]})},bl=e=>{var t,l;let{readonly:a=!1,header:i,aside:c=null,users:d=null,voice:u=null,dropFiles:m=[],context:x="channel",to:h}=e;const{reachLimit:p}=(0,rt.Z)(),{addStageFile:g}=(0,W.Z)({context:x,id:h}),f=(0,s.useRef)(null),{selects:v,channelsData:b,usersData:j,inputMode:y}=(0,r.CG)((e=>({inputMode:e.ui.inputMode,selects:e.ui.selectMessages[`${x}_${h}`],channelsData:e.channels.byId,usersData:e.users.byId}))),[{isActive:w},C]=(0,F.L)((()=>({accept:[G.FILE],drop(e){let{files:t}=e;if("text"===y){if(t.length){const e=t.map((e=>{const{size:t,type:l,name:s}=e;return{size:t,type:l,name:s,url:URL.createObjectURL(e)}}));g(e)}}else(0,U.Am)("DnD not allowed in this input mode",{icon:(0,o.jsx)(dt,{className:"w-5 h-5"})})},collect:e=>({isActive:e.canDrop()&&e.isOver()})})),[x,h,y]);(0,s.useEffect)((()=>{if(null!==m&&void 0!==m&&m.length){const e=m.map((e=>{const{size:t,type:l,name:s}=e;return{size:t,type:l,name:s,url:URL.createObjectURL(e)}}));g(e)}}),[m]);const N="channel"==x?null===(t=b[h])||void 0===t?void 0:t.name:null===(l=j[h])||void 0===l?void 0:l.name;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(P.Z,{container:f.current}),(0,o.jsxs)("section",{ref:C,className:"relative h-full w-full rounded-r-2xl flex",children:[(0,o.jsxs)("main",{className:"flex flex-col flex-1",children:[i,(0,o.jsx)("div",{className:"w-full h-full flex items-start justify-between relative",children:(0,o.jsxs)("div",{className:"rounded-br-2xl flex flex-col absolute bottom-0 w-full h-full",ref:f,children:["dm"==x&&(0,o.jsx)(Jt,{uid:h}),"dm"==x&&(0,o.jsx)(gt,{uid:h}),(0,o.jsx)(vl,{context:x,id:h},`${x}_${h}`),(0,o.jsxs)("div",{className:"px-2 py-0 md:p-4 "+(v?"selecting":""),children:[a?(0,o.jsx)(sl,{}):p?(0,o.jsx)(el,{}):(0,o.jsx)("div",{className:(0,n.Z)("flex justify-center",v&&"hidden"),children:(0,o.jsx)(st,{id:h,context:x},h)}),v&&(0,o.jsx)(cl,{context:x,id:h})]})]})})]}),c&&(0,o.jsx)("div",{className:(0,n.Z)("flex z-50 p-3 absolute right-0 top-14 md:right-0 md:top-0 md:translate-x-full flex-col"),children:c}),d&&(0,o.jsx)("div",{className:"hidden md:block",children:d}),u&&(0,o.jsx)("div",{className:"z-10 max-md:absolute max-md:right-11 max-md:top-14 max-md:overflow-y-scroll bg-white dark:!bg-gray-700 md:block",children:u}),!a&&"text"==y&&w&&(0,o.jsx)(Xt,{context:x,name:N})]})]})};var jl,yl=l(65809);function wl(){return wl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},wl.apply(this,arguments)}const Cl=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",wl({width:24,height:24,viewBox:"0 0 24 24",fill:"#70707B",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,jl||(jl=s.createElement("path",{d:"M12 2C17.5228 2 22 6.47715 22 12V19C22 20.6569 20.6569 22 19 22H16C15.4477 22 15 21.5523 15 21V15C15 14.4477 15.4477 14 16 14H20.5V12C20.5 7.30558 16.6944 3.5 12 3.5C7.30558 3.5 3.5 7.30558 3.5 12V14H8C8.55228 14 9 14.4477 9 15V21C9 21.5523 8.55228 22 8 22H5C3.34315 22 2 20.6569 2 19V12C2 6.47715 6.47715 2 12 2Z"})))},Nl=(0,s.forwardRef)(Cl),kl=e=>{var t,l;let{id:s,context:a="channel"}=e;const{joinVoice:n,joined:i,joining:c=!1,joinedAtThisContext:d}=(0,yt.M)({id:s,context:a}),u=(0,w.I0)(),{loginUser:m,voiceList:h,visibleAside:p}=(0,r.CG)((e=>({loginUser:e.authData.user,contextData:"channel"==a?e.channels.byId[s]:e.users.byId[s],voiceList:e.voice.list,visibleAside:"channel"==a?e.footprint.channelAsides[s]:null}))),{data:g}=(0,yl.j9)(),{t:f}=(0,x.$G)("chat");if(!m||!g)return null;const b="voice"==p,j=null!==(t=null===(l=h.find((e=>e.context==a&&e.id==s)))||void 0===l?void 0:l.memberCount)&&void 0!==t?t:0,y="absolute -top-2 -right-2 w-4 h-4 rounded-full bg-primary-400 text-white ";return(0,o.jsx)(v.Z,{disabled:b,tip:f("voice"),placement:"left",children:(0,o.jsxs)("li",{className:"relative group",children:[(0,o.jsx)(Nl,{className:b?"fill-gray-600":"fill-gray-500",role:"button",onClick:d?()=>{const e={id:s,aside:"voice"==p?null:"voice"};u("channel"==a?(0,C.Kp)(e):(0,C.dZ)(e))}:()=>{if(c||i)return void alert("You have joined another channel, please leave first!");n();const e={id:s,aside:"voice"};var t;(u("channel"==a?(0,C.Kp)(e):(0,C.dZ)(e)),d||"dm"!=a)||u((0,bt.vH)({from:null!==(t=null===m||void 0===m?void 0:m.uid)&&void 0!==t?t:0,to:s,calling:!1}))}}),b?null:(0,o.jsxs)(o.Fragment,{children:[j>0&&(0,o.jsx)("span",{className:`${y} flex-center font-bold text-[10px] group-hover:invisible`,children:j}),(0,o.jsx)("span",{className:`${y} text-xs flex-center invisible group-hover:visible`,children:(0,o.jsx)("em",{className:"not-italic",children:"+"})})]})]})})},Zl=e=>{let{id:t,context:l,info:a}=e;const i=(0,w.I0)(),{userData:c,voicingMembers:d}=(0,r.CG)((e=>({userData:e.users.byId,voicingMembers:e.voice.voicingMembers})));(0,s.useEffect)((()=>{d.ids.forEach((e=>{(0,Y.L_)(e)}))}),[d.ids]);const u=e=>{"channel"==l&&(i((0,C.Kp)({id:t,aside:"voice_fullscreen"})),e&&i((0,bt.fT)({uid:e,action:"pin"})))};if(!a)return null;const m=(0,n.Z)("text-sm text-gray-500 max-w-[120px] truncate font-semibold dark:text-white"),x=d.ids,h=d.byId;return a.joining?(0,o.jsx)("div",{className:"w-full h-full flex-center p-1 text-sm text-gray-600 dark:text-gray-400",children:"Connecting to voice channel..."}):"RECONNECTING"==a.connectionState?(0,o.jsxs)("div",{className:"w-full h-full flex-center flex-col gap-1 p-1 ",children:[(0,o.jsx)("span",{className:"text-red-300",children:"Reconnecting..."}),(0,o.jsx)("span",{className:"text-xs text-red-500",children:"Please check network connection!"})]}):(0,o.jsxs)("div",{className:"w-full h-full py-2 flex flex-col",children:[(0,o.jsx)("ul",{className:"flex grow flex-col",children:x.map((e=>{const t=c[e];if(!t)return null;const{muted:l,speakingVolume:s=0}=h[e],a=s>50;return(0,o.jsxs)("li",{className:"pb-4",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between gap-6 pb-2",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 transition-opacity",children:[(0,o.jsxs)("div",{className:(0,n.Z)("w-8 h-8 flex shrink-0 relative"),children:[a&&(0,o.jsx)("div",{className:"z-10 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 opacity-0 rounded-full bg-green-500 animate-speaking w-[36px] h-[36px]"}),(0,o.jsx)(jt.Z,{width:32,height:32,className:"w-full h-full rounded-full object-cover z-20",src:t.avatar,name:t.name,alt:"avatar"})]}),(0,o.jsx)("span",{className:m,title:null===t||void 0===t?void 0:t.name,children:null===t||void 0===t?void 0:t.name})]}),(0,o.jsx)("div",{className:"flex items-center gap-2",children:l?(0,o.jsx)(Rt,{className:"w-4 fill-gray-500 dark:fill-gray-400"}):(0,o.jsx)(Ut,{className:"w-4 fill-gray-500  dark:fill-gray-400"})})]}),(0,o.jsxs)("div",{className:"overflow-hidden group rounded relative",onDoubleClick:u.bind(null,e),children:[(0,o.jsx)("div",{id:`CAMERA_${e}`,className:"w-[98%] m-auto"}),(0,o.jsx)("button",{onClick:u.bind(null,e),className:"invisible group-hover:visible w-5 h-5 p-1 bg-black/40 top-1 right-1.5 absolute rounded",children:(0,o.jsx)(Te,{className:"w-full h-full fill-white"})})]})]},e)}))}),(0,o.jsx)("div",{className:"grid grid-rows-2 grid-cols-4 gap-2",children:(0,o.jsx)(Yt,{id:t,context:l})})]})},_l=e=>{let{context:t="channel",id:l,visible:s}=e;const{voicingInfo:a}=(0,yt.M)({id:l,context:t});return(0,o.jsx)("div",{className:"h-full flex-col gap-1 w-[226px] overflow-y-scroll overflow-x-hidden p-2 border border-black/10 md:border-none md:shadow-[inset_1px_0px_0px_rgba(0,_0,_0,_0.1)] "+(s?"flex":"hidden"),children:(0,o.jsx)(Zl,{id:l,context:t,info:a})})};var Ml=l(24007),Ll=l(94291);const Il=e=>{let{uids:t,addVisible:l,ownerId:a,cid:n,membersVisible:r}=e;const{t:i}=(0,x.$G)("chat"),c=(0,s.useRef)(null),[d,u]=(0,s.useState)(!1),m=()=>{u((e=>!e))};return(0,o.jsxs)(o.Fragment,{children:[d&&(0,o.jsx)(Ll.Z,{cid:n,closeModal:m}),(0,o.jsxs)("div",{ref:c,className:"h-full flex-col gap-1 w-[226px] overflow-y-scroll p-2 shadow-[inset_1px_0px_0px_rgba(0,_0,_0,_0.1)] "+(r?"flex":"hidden"),children:[l&&(0,o.jsxs)("div",{className:"cursor-pointer flex items-center justify-start gap-1 select-none rounded-lg p-2.5 md:hover:bg-gray-500/10",onClick:m,children:[(0,o.jsx)(g.Z,{className:"w-6 h-6 dark:fill-slate-300"}),(0,o.jsx)("div",{className:"font-semibold text-sm text-gray-600 dark:text-gray-50",children:i("add_channel_members")})]}),(0,o.jsx)(Ml.b,{initialPrerender:15,viewportRef:c,items:t,children:e=>(0,o.jsx)(de.Z,{enableContextMenu:!0,cid:n,owner:a==e,uid:e,dm:!0,popover:!0},e)})]})]})};var El=l(7699),Dl=l.n(El),Ol=l(3713);const Vl=e=>{var t,l,s;let{data:a}=e;const{msgData:n,usersData:i}=(0,r.CG)((e=>({msgData:e.message,usersData:e.users.byId}))),{mid:c=0}=a,d=(0,Y.PW)(a)||{},{content_type:u,content:m,properties:x,thumbnail:h=""}={...a,...d},p=(null===(t=n[c])||void 0===t?void 0:t.from_uid)||0,g=(null===(l=n[c])||void 0===l?void 0:l.created_at)||0,{name:f,avatar:v}=null!==(s=i[p])&&void 0!==s?s:{};return(0,o.jsxs)("div",{className:"w-full relative flex items-start gap-3 p-2 my-2 rounded-lg",children:[(0,o.jsx)("div",{className:"rounded-full overflow-hidden w-10 h-10 shrink-0",children:(0,o.jsx)(jt.Z,{width:40,height:40,src:v,name:f})}),(0,o.jsxs)("div",{className:"w-full flex flex-col items-start gap-1  text-sm",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 font-semibold",children:[(0,o.jsx)("span",{className:"text-gray-500",children:f}),(0,o.jsx)("time",{className:"text-xs text-gray-400",children:Dl()(g).format("YYYY-MM-DD h:mm:ss A")})]}),(0,o.jsx)("div",{className:"select-text text-gray-600 break-all whitespace-pre-wrap dark:text-white",children:(0,Ol.Z)({content_type:u,content:m,thumbnail:h,from_uid:p,properties:x})})]})]})};var $l=l(22922);const Sl=e=>{let{id:t}=e;const{t:l}=(0,x.$G)("chat"),{pins:s,unpinMessage:a,canPin:n}=(0,$l.Z)(t),r=e=>{const{mid:t}=e.currentTarget.dataset;t&&a(+t)},i=0==s.length;return(0,o.jsxs)("div",{className:"p-4 drop-shadow-md overflow-y-scroll min-w-[320px] md:min-w-[486px] md:max-h-[90vh] rounded-xl bg-gray-50 dark:bg-gray-800",children:[(0,o.jsxs)("h4",{className:" text-gray-600 dark:text-gray-400 mb-4 font-semibold",children:[l("pinned_msg"),"(",s.length,")"]}),i?(0,o.jsxs)("div",{className:"flex flex-col items-center gap-2 w-full p-4",children:[(0,o.jsx)(R,{}),(0,o.jsx)("div",{className:"w-60 font-semibold text-gray-500 dark:text-gray-300 text-center",children:l("pin_empty_tip")})]}):(0,o.jsx)("ul",{className:"flex flex-col gap-2",children:s.map((e=>(0,o.jsxs)("li",{className:"group relative border border-solid border-slate-100 dark:border-slate-600 rounded-md ",children:[(0,o.jsx)(Vl,{data:e}),(0,o.jsx)("div",{className:"invisible group-hover:visible flex items-center gap-1 absolute top-1 right-1 p-1 border border-solid border-black/10 dark:border-gray-500 rounded-md",children:n&&(0,o.jsx)("button",{className:"flex bg-none border-none","data-mid":e.mid,onClick:r,children:(0,o.jsx)($.Z,{className:"fill-slate-900 dark:fill-slate-300"})})})]},e.mid)))})]})};function Hl(e){var t;let{cid:l=0,dropFiles:n=[]}=e;const{t:i}=(0,x.$G)("chat"),{pathname:c}=(0,a.TH)(),d=(0,a.s0)(),u=(0,w.I0)(),{userIds:m,data:h,loginUser:g,visibleAside:f}=(0,r.CG)((e=>({loginUser:e.authData.user,userIds:e.users.ids,data:e.channels.byId[l],visibleAside:e.footprint.channelAsides[l]})));(0,s.useEffect)((()=>{h||d("/chat")}),[h]),(0,s.useEffect)((()=>(u((0,N.cp)()),()=>{u((0,N.cp)({path:c}))})),[c]);if(!h)return null;const{name:b,description:j,is_public:y,members:M=[],owner:L}=h,E=y?m:M.slice(0).sort((e=>e==L?-1:0)),O=(null===g||void 0===g?void 0:g.is_admin)||L==(null===g||void 0===g?void 0:g.uid),V=(null===h||void 0===h||null===(t=h.pinned_messages)||void 0===t?void 0:t.length)||0,$="relative cursor-pointer hidden md:block";return(0,o.jsx)(bl,{to:l,context:"channel",dropFiles:n,aside:(0,o.jsxs)("ul",{className:"flex flex-col gap-6",children:[(0,o.jsx)(v.Z,{tip:i("pin"),placement:"left",children:(0,o.jsx)(p.ZP,{placement:"left-start",popperOptions:{strategy:"fixed"},offset:[0,150],interactive:!0,trigger:"click",content:(0,o.jsx)(Sl,{id:l}),children:(0,o.jsxs)("li",{className:`${$}`,children:[V>0?(0,o.jsx)("span",{className:"absolute -top-2 -right-2 flex-center w-4 h-4 rounded-full bg-primary-400 text-white font-bold text-[10px]",children:V}):null,(0,o.jsx)(D.Z,{className:"fill-gray-500"})]})})}),(0,o.jsx)(kl,{context:"channel",id:l}),(0,o.jsx)(v.Z,{tip:i("fav"),placement:"left",children:(0,o.jsx)(p.ZP,{placement:"left-start",popperOptions:{strategy:"fixed"},offset:[0,164],interactive:!0,trigger:"click",content:(0,o.jsx)(T,{cid:l}),children:(0,o.jsx)("li",{className:`${$}`,children:(0,o.jsx)(_.Z,{className:"fill-gray-500"})})})}),(0,o.jsx)("li",{className:`${$}`,onClick:()=>{u((0,C.Kp)({id:l,aside:"members"!==f?"members":null}))},children:(0,o.jsx)(v.Z,{tip:i("channel_members"),placement:"left",children:(0,o.jsx)(I,{className:"members"==f?"fill-gray-600":""})})})]}),header:(0,o.jsxs)("header",{className:"px-5 py-4 flex items-center justify-center md:justify-between shadow-[inset_0_-1px_0_rgb(0_0_0_/_10%)]",children:[(0,o.jsx)(Z.Z,{}),(0,o.jsxs)("div",{className:"flex items-center gap-1",children:[(0,o.jsx)(k.Z,{personal:!y}),(0,o.jsx)("span",{className:"text-gray-800 dark:text-white",children:b}),(0,o.jsx)("span",{className:"ml-2 text-gray-500 hidden md:block",children:j})]})]}),users:(0,o.jsx)(Il,{uids:E,addVisible:O,cid:l,ownerId:L,membersVisible:"members"==f}),voice:(0,o.jsx)(_l,{visible:"voice"==f,id:l,context:"channel"})})}const Rl=(0,s.memo)(Hl,((e,t)=>e.cid==t.cid)),Tl=e=>{let{uid:t=0,dropFiles:l}=e;const n=(0,a.s0)(),{currUser:i}=(0,r.CG)((e=>({currUser:e.users.byId[t]})));return(0,s.useEffect)((()=>{i||n("/chat")}),[i]),i?(0,o.jsx)(bl,{to:t,context:"dm",dropFiles:l,aside:(0,o.jsxs)("ul",{className:"flex flex-col gap-6",children:[(0,o.jsx)(kl,{context:"dm",id:t}),(0,o.jsx)(v.Z,{tip:"Saved Items",placement:"left",children:(0,o.jsx)(p.ZP,{placement:"left-start",popperOptions:{strategy:"fixed"},offset:[0,180],interactive:!0,trigger:"click",content:(0,o.jsx)(T,{uid:t}),children:(0,o.jsx)("li",{className:"relative cursor-pointer fav",children:(0,o.jsx)(_.Z,{className:"fill-gray-500"})})})})]}),header:(0,o.jsxs)("header",{className:"box-border px-5 py-1 flex items-center justify-center md:justify-between shadow-[inset_0_-1px_0_rgb(0_0_0_/_10%)]",children:[(0,o.jsx)(Z.Z,{}),(0,o.jsx)(de.Z,{interactive:!1,uid:i.uid})]})}):null};var Fl=l(93929);const Gl=()=>{const{t:e}=(0,x.$G)("auth"),t=(0,w.I0)(),{clearLocalData:l}=(0,ll.Z)(),s=(0,a.s0)(),n=(0,r.CG)((e=>e.server.name)),i=`http://voce.chat/url?s=${encodeURIComponent(z.Ci)}`;return(0,o.jsxs)("section",{className:"flex flex-col items-center text-center",children:[(0,o.jsx)("h2",{className:"text-3xl text-gray-600 dark:text-gray-50 font-bold",children:e("welcome",{name:n})}),(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsx)("span",{className:"text-gray-400 dark:text-gray-200 my-3 text-sm",children:e("guest_login_tip")}),(0,o.jsx)("div",{className:"w-44 h-44 self-center mb-4",children:(0,o.jsx)(Fl.Z,{level:"Q",size:1200,link:i})}),!1,(0,o.jsx)(q.Z,{onClick:()=>{t((0,tl.sQ)()),l(),s("/login")},className:"small",children:e("sign_in")})]})]})};function Ul(e){let{cid:t=0}=e;const{data:l}=(0,r.CG)((e=>({data:e.channels.byId[t]})));if(!l)return null;const{name:s,description:a,is_public:n}=l;return(0,o.jsx)(bl,{readonly:!0,to:t,context:"channel",header:(0,o.jsxs)("header",{className:"px-5 py-4 flex items-center justify-center md:justify-between shadow-[inset_0_-1px_0_rgb(0_0_0_/_10%)]",children:[(0,o.jsx)(Z.Z,{}),(0,o.jsxs)("div",{className:"flex items-center gap-1",children:[(0,o.jsx)(k.Z,{personal:!n}),(0,o.jsx)("span",{className:"text-gray-800 dark:text-white",children:s}),(0,o.jsx)("span",{className:"ml-2 text-gray-500 hidden md:block ",children:a})]})]})})}const Pl=e=>{let{id:t,mid:l}=e;const[a,i]=(0,s.useState)(),{messageData:c,userData:d,channelData:u}=(0,r.CG)((e=>({messageData:e.message,userData:e.users.byId,channelData:e.channels.byId})));if((0,s.useEffect)((()=>{const e=u[t];if(!e)return;const{name:s,icon:a="",is_public:n}=e;i({name:s,icon:a,mid:l,is_public:n})}),[t,l,d,u]),!a)return null;const m=c[l]||{},{name:x,icon:p}=a;return(0,o.jsx)("li",{className:"session",children:(0,o.jsxs)(h.OL,{className:e=>{let{isActive:t}=e;return(0,n.Z)("nav flex gap-2 rounded-lg p-2 w-full md:hover:bg-gray-500/20",t&&"bg-gray-500/20")},to:`/chat/channel/${t}`,children:[(0,o.jsx)("div",{className:"flex shrink-0",children:(0,o.jsx)(jt.Z,{width:40,height:40,className:"icon rounded-full",type:"channel",name:x,src:p})}),(0,o.jsxs)("div",{className:"w-full flex flex-col justify-between",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("span",{className:(0,n.Z)("flex items-center gap-2 font-semibold text-sm text-gray-500 dark:text-white truncate",m.created_at&&"max-w-[190px]"),children:x}),(0,o.jsx)("span",{className:"text-xs text-gray-600 max-w-[80px] truncate",children:(0,Y.Lf)(m.created_at)})]}),(0,o.jsx)("div",{className:"flex items-center justify-between",children:(0,o.jsx)("span",{className:"text-xs text-gray-500 w-36 truncate",children:(0,ml.DH)(m)})})]})]})})},zl=()=>{const[e,t]=(0,s.useState)([]),{channelIDs:l,readChannels:a,readUsers:n,channelMessage:i,userMessage:c,loginUid:d}=(0,r.CG)((e=>{var t;return{loginUid:null===(t=e.authData.user)||void 0===t?void 0:t.uid,channelIDs:e.channels.ids,userMessage:e.userMessage.byId,channelMessage:e.channelMessage,readChannels:e.footprint.readChannels,readUsers:e.footprint.readUsers}}));return(0,s.useEffect)((()=>{const e=[...l.map((e=>{const t=i[e];if(!t||0==t.length)return{key:`channel_${e}`,unreads:0,id:e,type:"channel"};return{key:`channel_${e}`,id:e,mid:[...t].sort().pop(),type:"channel"}}))].sort(((e,t)=>{const{mid:l=0}=e,{mid:s=0}=t;return s-l}));t(e)}),[l,i,a,n,d,c]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("ul",{className:"flex-1 flex flex-col gap-0.5 p-2 overflow-auto",children:e.map((e=>{const{key:t,id:l,mid:s=0}=e;return(0,o.jsx)(Pl,{id:l,mid:s},t)}))}),(0,o.jsx)(sl,{placement:"session"})]})};var Bl,Al;function Kl(){return Kl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},Kl.apply(this,arguments)}const Wl=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",Kl({width:24,height:24,viewBox:"0 0 24 24",fill:"#78787C",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,Bl||(Bl=s.createElement("path",{d:"M15 4.25V19.7456C15 20.8243 13.7255 21.3965 12.9194 20.6797L8.42793 16.686C8.29063 16.5639 8.11329 16.4965 7.92956 16.4965H4.25C3.00736 16.4965 2 15.4891 2 14.2465V9.74859C2 8.50595 3.00736 7.49859 4.25 7.49859H7.92961C8.11333 7.49859 8.29065 7.43116 8.42794 7.30909L12.9195 3.31583C13.7255 2.59915 15 3.17138 15 4.25ZM18.9916 5.89733C19.3244 5.65079 19.7941 5.72077 20.0407 6.05362C21.2717 7.7157 22 9.7739 22 12C22 14.2261 21.2717 16.2843 20.0407 17.9464C19.7941 18.2793 19.3244 18.3492 18.9916 18.1027C18.6587 17.8562 18.5888 17.3865 18.8353 17.0536C19.8815 15.6411 20.5 13.8939 20.5 12C20.5 10.1062 19.8815 8.35896 18.8353 6.94641C18.5888 6.61356 18.6587 6.14387 18.9916 5.89733ZM17.143 8.36933C17.5072 8.17214 17.9624 8.30757 18.1596 8.67184C18.6958 9.66245 19 10.7968 19 12C19 13.2032 18.6958 14.3376 18.1596 15.3282C17.9624 15.6924 17.5072 15.8279 17.143 15.6307C16.7787 15.4335 16.6432 14.9783 16.8404 14.6141C17.2609 13.8373 17.5 12.9477 17.5 12C17.5 11.0523 17.2609 10.1627 16.8404 9.38593C16.6432 9.02167 16.7787 8.56652 17.143 8.36933Z"})),Al||(Al=s.createElement("path",{d:"M2.88667 2.21966C3.17956 1.92677 3.65444 1.92678 3.94733 2.21968L22.4471 20.7198C22.74 21.0127 22.74 21.4876 22.4471 21.7805C22.1542 22.0734 21.6793 22.0734 21.3864 21.7805L2.88666 3.28032C2.59377 2.98743 2.59377 2.51255 2.88667 2.21966Z",fill:"#D92D20"})))},Yl=(0,s.forwardRef)(Wl);var ql;function Ql(){return Ql=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},Ql.apply(this,arguments)}const Jl=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",Ql({width:24,height:24,viewBox:"0 0 24 24",fill:"#78787C",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,ql||(ql=s.createElement("path",{d:"M15 4.25V19.7456C15 20.8243 13.7255 21.3965 12.9194 20.6797L8.42793 16.686C8.29063 16.5639 8.11329 16.4965 7.92956 16.4965H4.25C3.00736 16.4965 2 15.4891 2 14.2465V9.74859C2 8.50595 3.00736 7.49859 4.25 7.49859H7.92961C8.11333 7.49859 8.29065 7.43116 8.42794 7.30909L12.9195 3.31583C13.7255 2.59915 15 3.17138 15 4.25ZM18.9916 5.89733C19.3244 5.65079 19.7941 5.72077 20.0407 6.05362C21.2717 7.7157 22 9.7739 22 12C22 14.2261 21.2717 16.2843 20.0407 17.9464C19.7941 18.2793 19.3244 18.3492 18.9916 18.1027C18.6587 17.8562 18.5888 17.3865 18.8353 17.0536C19.8815 15.6411 20.5 13.8939 20.5 12C20.5 10.1062 19.8815 8.35896 18.8353 6.94641C18.5888 6.61356 18.6587 6.14387 18.9916 5.89733ZM17.143 8.36933C17.5072 8.17214 17.9624 8.30757 18.1596 8.67184C18.6958 9.66245 19 10.7968 19 12C19 13.2032 18.6958 14.3376 18.1596 15.3282C17.9624 15.6924 17.5072 15.8279 17.143 15.6307C16.7787 15.4335 16.6432 14.9783 16.8404 14.6141C17.2609 13.8373 17.5 12.9477 17.5 12C17.5 11.0523 17.2609 10.1627 16.8404 9.38593C16.6432 9.02167 16.7787 8.56652 17.143 8.36933Z"})))},Xl=(0,s.forwardRef)(Jl),es=e=>{let{strength:t=0}=e;const l=6-t,s=l<=2?"bg-red-700":3==l?"bg-yellow-700":"bg-green-700";let a=" bg-gray-500";return(0,o.jsx)("div",{className:"w-6 h-6 flex-center",children:(0,o.jsxs)("div",{className:"w-[18px] h-[15px] flex items-end gap-[2px]",children:[(0,o.jsx)("span",{className:(0,n.Z)("h-1/5 w-[2px]",0==l?a:s)}),(0,o.jsx)("span",{className:(0,n.Z)("h-2/5 w-[2px]",l<=1?a:s)}),(0,o.jsx)("span",{className:(0,n.Z)("h-3/5 w-[2px]",l<=2?a:s)}),(0,o.jsx)("span",{className:(0,n.Z)("h-4/5 w-[2px]",l<=3?a:s)}),(0,o.jsx)("span",{className:(0,n.Z)("h-full w-[2px]",l<=4?a:s)})]})})},ts=e=>{var t,l,s;let{id:a,context:i="channel"}=e;const{t:c}=(0,x.$G)("chat"),{leave:d,voicingInfo:u,setMute:m,setDeafen:h,joining:p=!0,openCamera:g,closeCamera:f,startShareScreen:b,stopShareScreen:j}=(0,yt.M)({context:i,id:a}),{callFrom:y,callTo:w,loginUser:C,channelData:N,userData:k}=(0,r.CG)((e=>({callFrom:e.voice.callingFrom,callTo:e.voice.callingTo,userData:e.users.byId,channelData:e.channels.byId,loginUser:e.authData.user})));if(!C||!u||p)return null;const Z="RECONNECTING"==u.connectionState,_=y==C.uid?null===(t=k[w])||void 0===t?void 0:t.name:null===(l=k[y])||void 0===l?void 0:l.name;return(0,o.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-900 flex flex-col p-2 rounded-3xl m-3 mb-4 text-sm",children:[(0,o.jsxs)("div",{className:"border-b border-b-gray-200 dark:border-b-gray-800 pb-2",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center",children:[(0,o.jsxs)("div",{className:"flex flex-1 items-center gap-1",children:[(0,o.jsx)(es,{strength:u.downlinkNetworkQuality}),(0,o.jsxs)("div",{className:"flex flex-col",children:[(0,o.jsx)("span",{className:(0,n.Z)("text-green-800 font-bold",Z&&"text-red-500"),children:Z?"Voice Reconnecting...":"Voice Connected"}),(0,o.jsxs)("span",{className:"text-gray-600 dark:text-gray-400 text-xs truncate max-w-[170px]",children:["channel"==u.context?"Channel":"DM"," /"," ","channel"==u.context?null===(s=N[u.id])||void 0===s?void 0:s.name:_]})]})]}),(0,o.jsx)(v.Z,{tip:c("leave_voice"),placement:"top",children:(0,o.jsx)(Nl,{onClick:d,role:"button",className:"fill-red-600"})})]}),(0,o.jsxs)("div",{className:(0,n.Z)("flex items-center justify-around gap-2 mt-3 text-sm font-semibold text-gray-800 dark:text-gray-200"),children:[(0,o.jsxs)("button",{onClick:u.video?f:g,className:(0,n.Z)("rounded-lg py-2 px-5 flex items-center gap-1",u.video?"bg-green-700 text-gray-200":"bg-white/50 dark:bg-black/50 "),children:[(0,o.jsx)(Dt,{className:(0,n.Z)("dark:fill-gray-200 w-6 h-6",u.video?"fill-gray-200":"fill-gray-800")}),(0,o.jsx)("span",{children:"Video"})]}),(0,o.jsxs)("button",{onClick:u.shareScreen?j:b,className:(0,n.Z)("rounded-lg py-2 px-5 flex items-center gap-1",u.shareScreen?"bg-green-700 text-gray-200":"bg-white/50 dark:bg-black/50 "),children:[(0,o.jsx)(At,{className:(0,n.Z)("dark:fill-gray-200 w-6 h-6",u.shareScreen?"fill-gray-200":"fill-gray-800")}),(0,o.jsx)("span",{children:"Screen"})]})]})]}),(0,o.jsxs)("div",{className:"flex justify-between items-center pt-2",children:[(0,o.jsxs)("div",{className:"flex items-center gap-3",children:[(0,o.jsx)(de.Z,{uid:C.uid,compact:!0}),(0,o.jsxs)("div",{className:"flex flex-col",children:[(0,o.jsx)("span",{className:"dark:text-white text-sm font-bold",children:C.name}),(0,o.jsxs)("span",{className:"text-gray-400 text-xs",children:["#",C.uid]})]})]}),(0,o.jsxs)("div",{className:"flex gap-2 px-1",children:[(0,o.jsx)(v.Z,{tip:u.deafen?c("undeafen"):c("deafen"),placement:"top",children:u.deafen?(0,o.jsx)(Yl,{role:"button",onClick:h.bind(null,!1)}):(0,o.jsx)(Xl,{role:"button",onClick:h.bind(null,!0)})}),(0,o.jsx)(v.Z,{tip:u.muted?c("unmute"):c("mute"),placement:"top",children:u.muted?(0,o.jsx)(Rt,{className:"w-6 h-6",onClick:m.bind(null,!1),role:"button"}):(0,o.jsx)(Ut,{className:"w-6 h-6",onClick:m.bind(null,!0),role:"button"})})]})]})]})};var ls,ss=l(77493),as=l(89282);function ns(){return ns=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},ns.apply(this,arguments)}const rs=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",ns({width:5,height:8,viewBox:"0 0 5 8",fill:"#616161",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,ls||(ls=s.createElement("path",{d:"M4.1875 3.16699V2.33366C4.1875 1.40033 3.375 0.666992 2.5 0.666992C1.625 0.666992 0.833333 1.40033 0.833333 2.33366V3.16699C0.373083 3.16699 0 3.54009 0 4.00032V6.50032C0 6.96056 0.373083 7.33366 0.833333 7.33366H2.5H4.16667C4.62692 7.33366 5 6.96056 5 6.50032V3.97949C5 3.53076 4.63625 3.16699 4.1875 3.16699ZM3.33333 3.16699H1.66667V2.33366C1.66667 1.85747 2.05558 1.50033 2.5 1.50033C2.94442 1.50033 3.33333 1.85747 3.33333 2.33366V3.16699Z"})))},is=(0,s.forwardRef)(rs);var cs;function ds(){return ds=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},ds.apply(this,arguments)}const os=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",ds({width:24,height:24,viewBox:"0 0 24 24",fill:"#D2D1D1",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,cs||(cs=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.02618 13.4991V9.01525C3.02618 4.06024 7.04347 0.0427975 11.9998 0.0427975C13.5448 0.0518677 15.063 0.462697 16.401 1.23953L2.88215 14.7543C2.97517 14.3433 3.02321 13.9234 3.02618 13.5006V13.4991ZM23.5176 2.61634L20.3328 5.79838C20.7454 6.82118 20.963 7.91295 20.9674 9.01525V13.4991C20.9614 15.3857 21.8495 17.1612 23.36 18.2859C23.8761 18.6729 24.0861 19.3477 23.8807 19.9597C23.6751 20.5715 23.1005 20.9823 22.4555 20.9793H14.9745C14.9745 22.629 13.6349 23.9682 11.9817 23.9682C10.3287 23.9682 8.98911 22.6304 8.98911 20.9793H5.14434L2.60166 23.5288C2.22366 23.9276 1.66113 24.0895 1.13159 23.9516C0.599032 23.8137 0.1835 23.3967 0.046977 22.8673C-0.0880248 22.3365 0.0724881 21.7726 0.470035 21.3978L21.3874 0.482303C21.7625 0.0774777 22.3296 -0.0904547 22.865 0.047466C23.4006 0.182452 23.8176 0.602218 23.9542 1.13629C24.0891 1.6701 23.9211 2.23699 23.5161 2.61341L23.5176 2.61634Z"})))},us=(0,s.forwardRef)(os);var ms,xs,hs;function ps(){return ps=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s])}return e},ps.apply(this,arguments)}const gs=(e,t)=>{let{title:l,titleId:a,...n}=e;return s.createElement("svg",ps({width:28,height:28,viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},n),l?s.createElement("title",{id:a},l):null,ms||(ms=s.createElement("rect",{x:2,y:2,width:24,height:24,rx:12,fill:"#12B76A"})),xs||(xs=s.createElement("path",{d:"M14.9995 8.50001C14.9995 8.29898 14.8791 8.11749 14.6939 8.03934C14.5086 7.96119 14.2946 8.00157 14.1506 8.14185L11.2239 10.9927H9.49951C8.67108 10.9927 7.99951 11.6643 7.99951 12.4927V15.4817C7.99951 16.3101 8.67108 16.9817 9.49951 16.9817H11.2227L14.1491 19.8567C14.2928 19.9978 14.5071 20.039 14.6929 19.9611C14.8786 19.8832 14.9995 19.7014 14.9995 19.5V8.50001ZM16.1108 11.1887C16.2827 10.9726 16.5972 10.9368 16.8133 11.1087L16.8142 11.1094L16.8151 11.1102L16.8173 11.1119L16.8226 11.1163L16.8376 11.1288C16.8494 11.1388 16.8647 11.1522 16.883 11.169C16.9196 11.2026 16.9684 11.2499 17.0252 11.3112C17.1387 11.4336 17.2852 11.613 17.4302 11.8514C17.7217 12.331 18.0038 13.0444 18.0038 13.9986C18.0038 14.9527 17.7217 15.6669 17.4304 16.1471C17.2855 16.3859 17.1392 16.5657 17.0258 16.6884C16.9691 16.7498 16.9203 16.7973 16.8837 16.8309C16.8641 16.849 16.8439 16.8666 16.8235 16.8838L16.815 16.8907L16.8142 16.8914C16.8142 16.8914 16.3679 17.1337 16.1115 16.8129C15.9399 16.5983 15.9738 16.2858 16.1866 16.1128L16.1882 16.1115L16.1874 16.1122L16.1891 16.1108L16.1882 16.1115C16.1911 16.109 16.1974 16.1036 16.2065 16.0952C16.2247 16.0784 16.2542 16.05 16.2913 16.0098C16.3658 15.9292 16.4699 15.8025 16.5754 15.6285C16.785 15.283 17.0038 14.7461 17.0038 13.9986C17.0038 13.2511 16.785 12.7152 16.5757 12.3709C16.4702 12.1974 16.3662 12.0712 16.2919 11.9911C16.2548 11.951 16.2254 11.9228 16.2072 11.9061C16.1981 11.8978 16.1919 11.8924 16.189 11.89L16.19 11.8907C15.9743 11.7187 15.939 11.4047 16.1108 11.1887ZM17.8126 9.10886C17.5965 8.93686 17.282 8.97255 17.11 9.18858C16.938 9.40451 16.9742 9.71932 17.1899 9.89138L17.201 9.9006C17.2118 9.90975 17.2293 9.92484 17.2526 9.94582C17.2993 9.98781 17.3688 10.0532 17.4537 10.1413C17.6238 10.3179 17.8536 10.5841 18.084 10.9351C18.5445 11.6364 19.0028 12.6685 19.0028 14.004C19.0028 15.3395 18.5445 16.3694 18.0843 17.0685C17.854 17.4184 17.6243 17.6835 17.4544 17.8593C17.3696 17.947 17.3001 18.0121 17.2535 18.0538C17.2302 18.0747 17.2127 18.0897 17.2019 18.0988L17.1903 18.1083L17.1894 18.1091C16.9741 18.2808 16.9381 18.5945 17.1092 18.8105C17.2807 19.0269 17.5959 19.0628 17.8124 18.8913L17.8453 18.8642C17.8639 18.8487 17.8893 18.8268 17.9208 18.7986C17.9837 18.7423 18.0705 18.6607 18.1734 18.5543C18.3788 18.3418 18.6495 18.0286 18.9196 17.6183C19.4603 16.797 20.0028 15.5788 20.0028 14.004C20.0028 12.4293 19.4603 11.2094 18.9199 10.3863C18.6499 9.97503 18.3793 9.66089 18.1741 9.4477C18.0713 9.34097 17.9844 9.25908 17.9216 9.20255C17.8902 9.17426 17.8647 9.15228 17.8462 9.13665L17.8238 9.11798L17.8167 9.11222L17.8143 9.11024L17.8126 9.10886ZM16.189 11.89L16.1876 11.8887L16.189 11.89Z",fill:"white"})),hs||(hs=s.createElement("rect",{x:2,y:2,width:24,height:24,rx:12,stroke:"white",strokeWidth:4})))},fs=(0,s.forwardRef)(gs);var vs=l(57384);const bs=e=>{let{pinned:t,context:l="dm",id:s,visible:n,mid:i,hide:c,deleteChannel:d,setInviteChannelId:u,children:m}=e;const{t:h}=(0,x.$G)(),{canCopyEmail:g,copyEmail:f,canDeleteChannel:v,canInviteChannel:b}=(0,se.Z)({uid:"dm"==l?s:void 0,cid:"channel"==l?s:void 0}),[j]=(0,pt.bI)(),[y]=(0,pt.Ks)(),[C]=(0,pt.eM)(),[N]=(0,ul.o5)(),k=(0,a.bS)(`/chat/dm/${s}`),Z=(0,w.I0)(),_=(0,a.s0)(),{pathname:M}=(0,a.TH)(),{channelMuted:L}=(0,r.CG)((e=>({channelMuted:"channel"==l&&e.footprint.muteChannels[s]}))),I=()=>{if(i){N("dm"==l?{users:[{uid:+s,mid:i}]}:{groups:[{gid:+s,mid:i}]})}},E=()=>{const e="dm"==l?{uid:s}:{gid:s};t?C(e):y(e)},D=h(t?"unpin_chat":"pin_chat",{ns:"chat"}),O="dm"==l?[{title:D,handler:E},{title:h("action.mark_read"),handler:I},{title:h("setting"),handler:()=>{_(`/setting/dm/${s}/overview?f=${M}`)}},g&&{title:h("action.copy_email"),handler:f},{title:h("action.hide_session"),danger:!0,handler:()=>{Z((0,ee.So)(s)),k&&_("/chat")}}]:[{title:D,handler:E},{title:h("setting"),underline:!0,handler:()=>{_(`/setting/channel/${s}/overview?f=${M}`)}},{title:h("action.mark_read"),handler:I},{title:h(L?"action.unmute":"action.mute"),handler:()=>{j(L?{remove_groups:[s]}:{add_groups:[{gid:s}]})}},b&&{title:h("action.invite_people"),handler:u.bind(null,s)},v&&{title:h("action.delete_channel"),danger:!0,handler:d.bind(null,s)}];return(0,o.jsx)(p.ZP,{interactive:!0,placement:"right-start",popperOptions:{strategy:"fixed"},followCursor:"initial",visible:n,onClickOutside:c,content:(0,o.jsx)(vs.Z,{hideMenu:c,items:O.filter(Boolean)}),children:m})},js=e=>{let{type:t="dm",pinned:l=!1,id:i,mid:c,setDeleteChannelId:d,setInviteChannelId:u}=e;const m="dm"==t?`/chat/dm/${i}`:`/chat/channel/${i}`,x=(0,a.bS)(m),p=(0,a.s0)(),{addStageFile:g}=(0,W.Z)({context:t,id:i}),[{isActive:f},v]=(0,F.L)((()=>({accept:[G.FILE],drop(e){let{files:l}=e;if(l.length){const e=l.map((e=>{const{size:t,type:l,name:s}=e;return{size:t,type:l,name:s,url:URL.createObjectURL(e)}}));g(e),p("dm"==t?`/chat/dm/${i}`:`/chat/channel/${i}`)}},collect:e=>({isActive:e.canDrop()&&e.isOver()})})),[t,i]),{visible:b,handleContextMenuEvent:j,hideContextMenu:y}=(0,as.Z)(),[w,C]=(0,s.useState)(),{callingFrom:N,callingTo:k,messageData:Z,userData:_,channelData:M,readIndex:L,loginUid:I,mids:E,muted:D,voiceList:O}=(0,r.CG)((e=>{var l;return{callingFrom:e.voice.callingFrom,callingTo:e.voice.callingTo,voiceList:e.voice.list,mids:"dm"==t?e.userMessage.byId[i]:e.channelMessage[i],loginUid:(null===(l=e.authData.user)||void 0===l?void 0:l.uid)||0,readIndex:"dm"==t?e.footprint.readUsers[i]:e.footprint.readChannels[i],messageData:e.message,userData:e.users.byId,channelData:e.channels.byId,muted:"dm"==t?e.footprint.muteUsers[i]:e.footprint.muteChannels[i]}}));if((0,s.useEffect)((()=>{const e="dm"==t?_[i]:M[i];if(e)if("dm"==t){const{name:t,avatar:l}=e;C({name:t,icon:l,mid:c,is_public:!0})}else{const{name:t,icon:l="",is_public:s}=e;C({name:t,icon:l,mid:c,is_public:s})}}),[i,c,t,_,M]),!w)return null;const V=Z[c]||{},{name:$,icon:S,is_public:H}=w,{unreads:R=0}=(0,ml.ZP)({mids:E,readIndex:L,messageData:Z,loginUid:I}),T="channel"==t?O.some((e=>e.context==t&&e.id===i)):i==N||i==k;return(0,o.jsx)("li",{className:(0,n.Z)("session"),children:(0,o.jsx)(bs,{visible:b,hide:y,context:t,id:i,mid:c,pinned:l,setInviteChannelId:u,deleteChannel:d,children:(0,o.jsxs)(h.OL,{ref:v,className:e=>{let{isActive:t}=e;return(0,n.Z)("nav flex gap-2 rounded-lg p-2 w-full",f&&"shadow-[inset_0_0_0_2px_#52edff]",t&&"bg-gray-500/20",l?"md:hover:bg-gray-300/20":"md:hover:bg-gray-500/20")},to:m,onContextMenu:j,children:[(0,o.jsxs)("div",{className:"flex shrink-0 relative w-10 h-10",children:["dm"==t?(0,o.jsx)(de.Z,{avatarSize:40,compact:!0,interactive:!1,uid:i}):(0,o.jsx)(jt.Z,{width:40,height:40,className:"icon rounded-full object-cover",type:"channel",name:$,src:S}),T&&(0,o.jsx)(fs,{className:"top-0 -right-[7px] absolute w-6 h-6"})]}),(0,o.jsxs)("div",{className:"w-full flex flex-col justify-between overflow-hidden",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between ",children:[(0,o.jsxs)("span",{className:(0,n.Z)("flex items-center gap-1"),children:[(0,o.jsx)("i",{className:(0,n.Z)("not-italic font-semibold text-sm text-gray-500 dark:text-white max-w-[120px] truncate",!V.created_at&&"max-w-[190px]"),children:$}),!H&&(0,o.jsx)(is,{className:"dark:fill-gray-400"})]}),(0,o.jsx)("span",{className:(0,n.Z)("text-xs text-gray-500 max-w-[80px] truncate font-semibold"),children:(0,Y.Lf)(V.created_at)})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("span",{className:(0,n.Z)("text-xs text-gray-500  truncate",R>0?"w-36":""),children:(0,ml.DH)(V)}),R>0&&!x?(0,o.jsx)("strong",{className:(0,n.Z)("text-white px-1.5 py-[3px] font-bold text-[10px] leading-[10px] rounded-[10px]",D?"bg-black/10 dark:bg-gray-500":"bg-primary-400"),children:R>99?"99+":R}):D&&(0,o.jsx)(us,{className:"w-3 h-3 fill-black/10 dark:fill-gray-500"})]})]})]})})})},ys=e=>{let{tempSession:t}=e;const l=(0,s.useRef)(null),[a,n]=(0,s.useState)(),[i,c]=(0,s.useState)(),[d,u]=(0,s.useState)([]),[m,x]=(0,s.useState)([]),{pins:h,channelIDs:p,DMs:g,readChannels:f,readUsers:v,channelMessage:b,userMessage:j,loginUid:y}=(0,r.CG)((e=>{var t;return{pins:e.footprint.pinChats,loginUid:null===(t=e.authData.user)||void 0===t?void 0:t.uid,channelIDs:e.channels.ids,DMs:e.userMessage.ids,userMessage:e.userMessage.byId,channelMessage:e.channelMessage,readChannels:e.footprint.readChannels,readUsers:e.footprint.readUsers}}));return(0,s.useEffect)((()=>{const e=(e,t)=>{const l="dm"==t?j[e]:b[e];if(!l||0==l.length)return{unread:0,id:e,type:t};return{id:e,mid:[...l].sort(((e,t)=>+e-+t)).pop(),type:t}},l=h.map((t=>{const{target:l}=t;return"uid"in l?e(l.uid,"dm"):"gid"in l?e(l.gid,"channel"):null})).filter((e=>!!e)),s=h.map((e=>e.target.gid?e.target.gid:null)).filter((e=>!!e)),a=h.map((e=>e.target.uid?e.target.uid:null)).filter((e=>!!e)),n=[...p.filter((e=>!s.includes(e))).map((t=>e(t,"channel"))),...g.filter((e=>!a.includes(e))).map((t=>e(t,"dm")))].sort(((e,t)=>{const{mid:l=0}=e,{mid:s=0}=t;return s-l})),r=t?[t,...n]:n;u(r),x(l)}),[p,g,b,f,v,y,j,t,h]),(0,o.jsxs)(o.Fragment,{children:[m.length?(0,o.jsx)("ul",{className:"flex flex-col gap-0.5 py-1 px-2 bg-primary-500/10",children:m.map((e=>{const{type:t,id:l,mid:s=0}=e,a=`${t}_${l}`;return(0,o.jsx)(js,{type:t,pinned:!0,id:l,mid:s,setInviteChannelId:c,setDeleteChannelId:n},a)}))}):null,(0,o.jsx)("ul",{ref:l,className:"flex flex-1 flex-col gap-0.5 p-2 overflow-auto",children:(0,o.jsx)(Ml.b,{initialPrerender:10,viewportRef:l,items:d,children:e=>{const{type:t,id:l,mid:s=0}=e,a=`${t}_${l}`;return(0,o.jsx)(js,{type:t,id:l,mid:s,setInviteChannelId:c,setDeleteChannelId:n},a)}})}),!!a&&(0,o.jsx)(ss.Z,{id:a,closeModal:()=>{n(0)}}),!!i&&(0,o.jsx)(Ll.Z,{type:"channel",cid:i,closeModal:()=>{c(0)}})]})},ws=(0,s.memo)(ys),Cs=e=>{let{id:t,context:l}=e;const a=(0,w.I0)(),[i,c]=(0,s.useState)(0),{name:d,userData:u,voicingMembers:m}=(0,r.CG)((e=>({userData:e.users.byId,voicingMembers:e.voice.voicingMembers,name:"channel"==l?e.channels.byId[t].name:e.users.byId[t].name})));(0,s.useEffect)((()=>{m.ids.forEach((e=>{(0,Y.L_)(e);const{speakingVolume:t=0}=m.byId[e];t>50&&c(e)}))}),[m]);const x=e=>{const t=e.currentTarget.dataset.uid;t&&a((0,bt.fT)({uid:+t,action:"pin"}))},h=e=>{var t,l;const s=null!==(t=e.currentTarget.dataset.uid)&&void 0!==t?t:"",n=null!==(l=e.currentTarget.dataset.action)&&void 0!==l?l:"pin";a("unpin"==n?(0,bt.fT)({uid:+s,action:n}):(0,bt.fT)({uid:+s,action:"pin"}))},p=m.pin,g="channel"==l?`# ${d}`:`@ ${d}`,f=m.ids,b=m.byId,j="undefined"!==typeof p;return(0,o.jsxs)("div",{className:"h-full bg-black text-gray-300 flex flex-col justify-between rounded-r-2xl",children:[(0,o.jsx)("div",{className:"px-7 py-6 flex justify-between",children:(0,o.jsx)("span",{className:"text-sm font-semibold",children:g})}),(0,o.jsx)("ul",{className:"flex grow justify-center items-end relative gap-2",children:f.map((e=>{const t=u[e];if(!t)return null;const{muted:l,speakingVolume:s=0,shareScreen:a}=b[e],r=s>50,c=j?p==e:e==i,d=c&&!j;return(0,o.jsxs)("li",{"data-uid":e,onDoubleClick:x,className:(0,n.Z)("bg-gray-700 group overflow-hidden",c?"absolute left-0 top-0 w-full h-[calc(100%_-_110px)] flex-center":"relative border border-gray-600/50 rounded-lg py-1.5 px-12"),children:[(0,o.jsxs)("div",{className:(0,n.Z)("w-20 h-20 flex shrink-0 relative transition-opacity"),children:[r&&(0,o.jsx)("div",{className:(0,n.Z)("absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 opacity-0 rounded-full bg-green-500 animate-speaking",c?"w-[88px] h-[88px]":"w-[86px] h-[86px]")}),(0,o.jsx)(jt.Z,{width:80,height:80,className:"w-full h-full rounded-full object-cover z-20",src:t.avatar,name:t.name,alt:"avatar"})]}),a?(0,o.jsx)("div",{className:(0,n.Z)("w-1 h-1 absolute z-40 rounded-full bg-green-700/60",c?"top-2 left-2":"top-1 left-1 px-2")}):null,!d&&(0,o.jsx)(v.Z,{tip:"Remove pin",disabled:!c,placement:"right",children:(0,o.jsx)("button",{"data-uid":e,"data-action":c?"unpin":"pin",role:"button",onClick:h,className:(0,n.Z)("absolute left-1 top-1 z-40 rounded bg-black/50",c?"px-2 py-0.5":"px-1 invisible group-hover:visible"),children:(0,o.jsx)(D.Z,{className:(0,n.Z)(c?"w-4 fill-green-600":"w-3 fill-gray-200")})})}),(0,o.jsx)("span",{className:(0,n.Z)("text-gray-300 bg-black/50 rounded-lg absolute  z-40",c?"left-2 bottom-2 px-2 py-1 text-sm ":"left-1 bottom-1 p-1 text-xs"),title:null===t||void 0===t?void 0:t.name,children:null===t||void 0===t?void 0:t.name}),(0,o.jsx)("div",{className:(0,n.Z)("flex items-center gap-2 absolute z-40 rounded bg-black/50",c?"bottom-2 right-2  px-2 py-0.5":"bottom-1 right-1 px-2"),children:l?(0,o.jsx)(Rt,{className:(0,n.Z)("fill-gray-200",c?"w-4":"w-3")}):(0,o.jsx)(Ut,{className:(0,n.Z)("fill-gray-200 ",c?"w-4":"w-3")})}),(0,o.jsx)("div",{id:`CAMERA_${e}`,className:(0,n.Z)("absolute top-0 left-0 z-30 w-full h-full overflow-hidden m-auto",c?"":"rounded")})]},e)}))}),(0,o.jsx)("div",{className:"py-4 flex justify-center gap-2",children:(0,o.jsx)(Yt,{id:t,context:l,mode:"fullscreen"})})]})};function Ns(){var e;const t=(0,a.bS)("/"),l=(0,a.bS)("/chat"),[d,u]=(0,s.useState)(!1),[x,h]=(0,s.useState)(!1),[p,g]=(0,s.useState)(!1),{channel_id:f=0,user_id:v=0}=(0,a.UO)(),{sessionUids:j,isGuest:w,aside:C="",callingTo:N}=(0,r.CG)((e=>({callingTo:e.voice.callingTo,isGuest:e.authData.guest,sessionUids:e.userMessage.ids,aside:f?e.footprint.channelAsides[+f]:e.footprint.dmAsides[e.voice.callingTo]}))),k=0==v?void 0:-1==j.findIndex((e=>e==+v))?{mid:0,unread:0,id:+v,type:"dm"}:void 0,Z=0==f&&0==v,_="voice_fullscreen"===C,M=0!=f&&"voice_fullscreen"!==C,L=0!=v&&"voice_fullscreen"!==C,I=t||l,E=0!==f?"channel":"dm",D=null!==(e=+f||N)&&void 0!==e?e:0;return(0,o.jsxs)(m,{children:[x&&(0,o.jsx)(c.Z,{closeModal:()=>{h((e=>!e))},personal:!0}),p&&(0,o.jsx)(y.Z,{closeModal:()=>{g((e=>!e))}}),(0,o.jsxs)("div",{className:(0,n.Z)("flex h-screen md:h-full md:pt-2 md:pb-2.5 md:pr-1",w?"guest-container md:px-1":"md:pr-12"),children:[d&&(0,o.jsx)("div",{onClick:()=>{u((e=>!e))},className:"z-30 fixed top-0 left-4 w-screen h-screen bg-black/50 transition-all backdrop-blur-sm"}),(0,o.jsxs)("div",{className:(0,n.Z)("left-container pb-14 md:pb-0 flex-col md:rounded-l-2xl w-full h-screen md:h-full md:max-w-[250px] md:min-w-[268px] shadow-[rgb(0_0_0_/_10%)_-1px_0px_0px_inset] bg-white dark:!bg-gray-800",I?"flex":"hidden md:flex"),children:[(0,o.jsx)(b,{readonly:w}),w?(0,o.jsx)(zl,{}):(0,o.jsx)(ws,{tempSession:k}),(0,o.jsx)(ts,{id:+D,context:E})]}),(0,o.jsxs)("div",{className:(0,n.Z)("right-container md:rounded-r-2xl w-full bg-white dark:!bg-gray-700",Z&&"h-full flex-center",I&&"hidden md:flex"),children:[_&&(0,o.jsx)(Cs,{id:D,context:E}),Z&&(w?(0,o.jsx)(Gl,{}):(0,o.jsx)(i.Z,{})),M&&(w?(0,o.jsx)(Ul,{cid:+f}):(0,o.jsx)(Rl,{cid:+f})),L&&(0,o.jsx)(Tl,{uid:+v})]})]})]})}const ks=(0,s.memo)(Ns)},77493:(e,t,l)=>{l.d(t,{Z:()=>m});var s=l(70537),a=l(27418),n=l(14566),r=l(15924),i=l(6144),c=l(97601),d=l(4472),o=l(70254),u=l(80683);const m=e=>{let{id:t,closeModal:l}=e;const{t:m}=(0,n.$G)("setting"),{t:x}=(0,n.$G)(),h=(0,r.s0)(),[p,{isLoading:g,isSuccess:f}]=(0,i.kE)();return(0,s.useEffect)((()=>{f&&(a.ZP.success(x("tip.delete")),l(),h("/chat"))}),[f]),t?(0,u.jsx)(c.Z,{id:"modal-modal",children:(0,u.jsx)(o.Z,{className:"compact",title:m("channel.delete"),description:m("channel.delete_desc"),buttons:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d.Z,{onClick:l.bind(null,void 0),className:"cancel",children:x("action.cancel")}),(0,u.jsx)(d.Z,{onClick:()=>{p(t)},className:"danger",children:g?"Deleting":x("action.remove")})]})})}):null}}}]);