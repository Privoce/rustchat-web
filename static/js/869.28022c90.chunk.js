"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[869],{79884:(e,n,s)=>{s.d(n,{Z:()=>c});var l,a=s(70537);function t(){return t=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},t.apply(this,arguments)}const i=(e,n)=>{let{title:s,titleId:i,...c}=e;return a.createElement("svg",t({width:20,height:20,viewBox:"0 0 20 20",fill:"#616161",xmlns:"http://www.w3.org/2000/svg",ref:n,"aria-labelledby":i},c),s?a.createElement("title",{id:i},s):null,l||(l=a.createElement("path",{d:"M6.48667 11.6667L6.83667 8.33333H3.325V6.66667H7L7.43333 2.5H9.10833L8.66667 6.66667H11.9833L12.4167 2.5H14.0917L13.65 6.66667H16.625V8.33333H13.4667L13.1167 11.6667H16.6167V13.3333H12.9333L12.4917 17.5H10.8083L11.2417 13.3333H7.91667L7.475 17.5H5.8L6.23333 13.3333H3.25V11.6667H6.4H6.48667ZM8.1625 11.6667H11.4875L11.8375 8.33333H8.5125L8.1625 11.6667Z"})))},c=(0,a.forwardRef)(i)},11089:(e,n,s)=>{s.d(n,{Z:()=>u});var l=s(70537),a=s(27418),t=s(14566),i=s(52334),c=s(66160),r=s(24563),d=s(15621),o=s(80683);const u=e=>{var n,s;let{id:u,type:v="channel"}=e;const h=(0,c.CG)((e=>"channel"==v?e.footprint.autoDeleteMsgChannels.find((e=>e.gid==u)):e.footprint.autoDeleteMsgUsers.find((e=>e.uid==u)))),[m,{isSuccess:x}]=(0,i.ar)(),[p,f]=(0,l.useState)(null!==(n=null===h||void 0===h?void 0:h.expires_in)&&void 0!==n?n:0),{t:g}=(0,t.$G)("setting",{keyPrefix:"auto_delete_msg"}),{t:j}=(0,t.$G)(),Z=[{title:g("off"),value:0},{title:g("5_min"),value:300},{title:g("10_min"),value:600},{title:g("1_hour"),value:3600},{title:g("1_day"),value:86400},{title:g("1_week"),value:604800}];(0,l.useEffect)((()=>{x&&a.Am.success(j("tip.update"))}),[x]);const b=null!==(s=null===h||void 0===h?void 0:h.expires_in)&&void 0!==s?s:0;return(0,o.jsxs)("section",{className:"max-w-[512px] h-full relative",children:[(0,o.jsxs)("div",{className:"text-sm",children:[(0,o.jsx)("h2",{className:"dark:text-white",children:g("title")}),(0,o.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:g("desc")})]}),(0,o.jsx)("div",{className:"mt-4",children:(0,o.jsx)(d.Z,{options:Z.map((e=>{let{title:n}=e;return n})),values:Z.map((e=>{let{value:n}=e;return n})),value:p||0,onChange:e=>{f(e)}})}),b!==p&&(0,o.jsx)(r.Z,{saveHandler:()=>{m("user"==v?{users:[{uid:u,expires_in:p}]}:{groups:[{gid:u,expires_in:p}]})},resetHandler:()=>{var e;f(null!==(e=null===h||void 0===h?void 0:h.expires_in)&&void 0!==e?e:0)}})]})}},77493:(e,n,s)=>{s.d(n,{Z:()=>v});var l=s(70537),a=s(27418),t=s(15924),i=s(80874),c=s(6144),r=s(40698),d=s(69885),o=s(14566),u=s(80683);const v=e=>{let{id:n,closeModal:s}=e;const{t:v}=(0,o.$G)("setting"),{t:h}=(0,o.$G)(),m=(0,t.s0)(),[x,{isLoading:p,isSuccess:f}]=(0,c.kE)();return(0,l.useEffect)((()=>{f&&(a.ZP.success(h("tip.delete")),s(),m("/chat"))}),[f]),n?(0,u.jsx)(i.Z,{id:"modal-modal",children:(0,u.jsx)(r.Z,{className:"compact",title:v("channel.delete"),description:v("channel.delete_desc"),buttons:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d.Z,{onClick:s.bind(null,void 0),className:"cancel",children:h("action.cancel")}),(0,u.jsx)(d.Z,{onClick:()=>{x(n)},className:"danger",children:p?"Deleting":h("action.remove")})]})})}):null}},20869:(e,n,s)=>{s.r(n),s.d(n,{default:()=>O});var l=s(70537),a=s(15924),t=s(64084),i=s(27418),c=s(80874),r=s(6144),d=s(66160);function o(e){const{channel:n,loginUid:s}=(0,d.CG)((n=>{var s;return{channel:n.channels.byId[e],loginUid:null===(s=n.authData.user)||void 0===s?void 0:s.uid}})),[l,{isLoading:a,isSuccess:t}]=(0,r.tW)(),[i,{isLoading:c,isSuccess:o}]=(0,r.VJ)(),u=s==(null===n||void 0===n?void 0:n.owner);return{otherMembers:(null===n||void 0===n?void 0:n.members.filter((e=>e!=s)))||[],transferOwner:n=>{n&&l({id:e,owner:n})},leaveChannel:()=>{e&&i(e)},leaving:c,leaveSuccess:o,isOwner:u,transferring:a,transferSuccess:t}}var u=s(40698),v=s(69885),h=s(33941),m=s(14566),x=s(57425),p=s(80683);const f=e=>{let{id:n,closeModal:s,withLeave:t=!0}=e;const{t:r}=(0,m.$G)(),{transferOwner:d,otherMembers:f,leaving:g,leaveChannel:j,leaveSuccess:Z,transferSuccess:b,transferring:w}=o(n),[C,N]=(0,l.useState)(null),_=(0,a.s0)(),y=e=>{N(e)};if((0,l.useEffect)((()=>{b&&Z&&(i.ZP.success("Leave channel successfully!"),s(),_("/chat"))}),[Z,b,t]),!n)return null;const S=g||w;return(0,p.jsx)(c.Z,{id:"modal-modal",children:(0,p.jsx)(u.Z,{className:"compact",title:"Transfer Ownership",description:"This cannot be undone.",buttons:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(v.Z,{onClick:s.bind(null,void 0),className:"cancel",children:r("action.cancel")}),(0,p.jsx)(v.Z,{disabled:!C,onClick:async()=>{C&&(await d(C),t&&await j())},className:"danger",children:S?"Assigning":"Assign and Leave"})]}),children:(0,p.jsx)("ul",{className:"flex flex-col max-h-[260px] py-4 overflow-y-scroll",children:f.map((e=>(0,p.jsx)("li",{className:(0,x.Z)("cursor-pointer flex items-center px-2 md:hover:bg-gray-500/10",C==e?"bg-gray-500/10":""),onClick:y.bind(null,e),children:(0,p.jsx)(h.Z,{uid:e,interactive:!1})},e)))})})})},g=e=>{let{id:n,closeModal:s,handleNextStep:t}=e;const{t:r}=(0,m.$G)("setting"),d=(0,a.s0)(),{isOwner:h,leaving:x,leaveChannel:f,leaveSuccess:g}=o(n);return(0,l.useEffect)((()=>{g&&(i.ZP.success("Leave channel successfully!"),s(),d("/chat"))}),[g]),n?(0,p.jsx)(c.Z,{id:"modal-modal",children:(0,p.jsx)(u.Z,{className:"compact",title:r("channel.leave"),description:r(h?"channel.transfer_desc":"channel.leave_desc"),buttons:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(v.Z,{onClick:s.bind(null,void 0),className:"cancel",children:r("action.cancel",{ns:"common"})}),h?(0,p.jsx)(v.Z,{onClick:t,className:"main",children:"Next"}):(0,p.jsx)(v.Z,{onClick:f,className:"danger",children:x?"Leaving":"Leave"})]})})}):null},j=e=>{let{id:n,isOwner:s=!1,closeModal:a}=e;const[t,i]=(0,l.useState)(s);return t?(0,p.jsx)(f,{id:n,closeModal:a}):(0,p.jsx)(g,{id:n,closeModal:a,handleNextStep:()=>{i(!0)}})};var Z=s(90442),b=s(77493),w=s(95727),C=s(17237),N=s(48540),_=s(15621),y=s(64884),S=s(24563),L=s(79884);function H(e){let{id:n=0}=e;const{t:s}=(0,m.$G)("setting",{keyPrefix:"channel"}),{t:a}=(0,m.$G)(),{loginUser:t,channel:c}=(0,d.CG)((e=>({loginUser:e.authData.user,channel:e.channels.byId[n]}))),{data:o,refetch:u}=(0,r.aw)(n),[h,x]=(0,l.useState)(!1),[f,g]=(0,l.useState)(),[j]=(0,r.kG)(),[Z,{isSuccess:b}]=(0,r.cF)(),[H,{isSuccess:k}]=(0,r.tW)(),[M,{isSuccess:G}]=(0,r.Cl)(),E=e=>{const n=e.target.value,{type:s=""}=e.target.dataset;g((e=>e?{...e,[s]:n}:e))};if((0,l.useEffect)((()=>{o&&g(o)}),[o]),(0,l.useEffect)((()=>{b&&i.ZP.success("Cleared!")}),[b]),(0,l.useEffect)((()=>{if(o&&f){const{name:e,description:n}=f,{name:s,description:l}=o;x(s!==e||l!==n)}}),[o,f]),(0,l.useEffect)((()=>{k&&(i.ZP.success(a("tip.update")),u())}),[k]),(0,l.useEffect)((()=>{G&&i.ZP.success(a("tip.update"))}),[G]),!f||!n||!c)return null;const{name:O,description:$}=f,P=!(null!==t&&void 0!==t&&t.is_admin)&&(null===c||void 0===c?void 0:c.owner)!=(null===t||void 0===t?void 0:t.uid),F="w-full flex flex-col items-start gap-2 relative";return(0,p.jsxs)("div",{className:"relative w-[512px] flex flex-col gap-6 h-full",children:[(0,p.jsx)(w.Z,{type:"channel",url:null===c||void 0===c?void 0:c.icon,name:O,uploadImage:e=>{j({gid:n,image:e})}}),(0,p.jsxs)("div",{className:"flex flex-col gap-6 items-start",children:[(0,p.jsxs)("div",{className:F,children:[(0,p.jsx)(N.Z,{htmlFor:"name",children:s("name")}),(0,p.jsx)(C.Z,{disabled:P,className:"!pl-8","data-type":"name",onChange:E,value:O,name:"name",id:"name",placeholder:s("name")}),(0,p.jsx)(L.Z,{className:"absolute bottom-2.5 left-2"})]}),(0,p.jsxs)("div",{className:F,children:[(0,p.jsx)(N.Z,{htmlFor:"desc",children:s("topic")}),(0,p.jsx)(y.Z,{disabled:P,"data-type":"description",onChange:E,value:null!==$&&void 0!==$?$:"",rows:4,name:"name",id:"name",placeholder:s("topic_placeholder")})]}),!P&&t.is_admin&&(0,p.jsxs)("div",{className:F,children:[(0,p.jsx)(N.Z,{htmlFor:"desc",children:s("visibility")}),(0,p.jsx)(_.Z,{options:[s("public"),s("private")],values:["true","false"],value:String(c.is_public),onChange:e=>{M({is_public:"true"===e.toLowerCase(),id:n})}})]}),(0,p.jsx)(v.Z,{className:"danger",onClick:()=>{confirm("are you sure?")&&Z(n)},children:"Clear Message"})]}),h&&(0,p.jsx)(S.Z,{saveHandler:()=>{if(!f)return;const{name:e,description:s}=f;H({id:n,name:e,description:s})},resetHandler:()=>{g(o)}})]})}var k=s(11089),M=s(65321);const G=e=>{const{t:n}=(0,m.$G)("setting");return[{title:n("nav.general"),items:[{name:"overview",title:n("nav.overview"),component:(0,p.jsx)(H,{id:e})},{name:"auto_delete_msg",title:n("nav.auto_delete_msg"),component:(0,p.jsx)(k.Z,{id:e})},{name:"members",title:n("nav.members"),component:(0,p.jsx)(M.Z,{cid:e})}]}]};let E="";function O(){const{t:e}=(0,m.$G)("setting"),{cid:n=0,nav:s}=(0,a.UO)(),{loginUser:i,channel:c}=(0,d.CG)((e=>({loginUser:e.authData.user,channel:n?e.channels.byId[+n]:void 0}))),r=(0,a.s0)(),[o]=(0,t.lr)(),u=G(+n),v=u.map((e=>{let{items:n}=e;return n})).flat();E=E||(o.get("f")||"/");const[h,x]=(0,l.useState)(!1),[f,g]=(0,l.useState)(!1),w=()=>{x((e=>!e))},C=()=>{g((e=>!e))};if(!n)return null;const N=v.find((e=>e.name==s)),_=(null===i||void 0===i?void 0:i.is_admin)||(null===c||void 0===c?void 0:c.owner)==(null===i||void 0===i?void 0:i.uid),y=!(null!==c&&void 0!==c&&c.is_public);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Z.Z,{pathPrefix:`/setting/channel/${n}`,nav:N,closeModal:()=>{r(E),E=""},title:"Channel Settings",navs:u,dangers:[y&&{title:e("channel.leave"),handler:C},_&&{title:e("channel.delete"),handler:w}],children:s?null===N||void 0===N?void 0:N.component:null}),h&&(0,p.jsx)(b.Z,{closeModal:w,id:+n}),f&&(0,p.jsx)(j,{closeModal:C,id:+n})]})}}}]);