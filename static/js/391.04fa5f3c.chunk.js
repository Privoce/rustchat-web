"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[391],{11089:(e,n,s)=>{s.d(n,{Z:()=>u});var l=s(70537),a=s(27418),i=s(14566),t=s(52334),c=s(66160),d=s(24563),r=s(15621),o=s(80683);const u=e=>{var n,s;let{id:u,type:v="channel"}=e;const m=(0,c.CG)((e=>"channel"==v?e.footprint.autoDeleteMsgChannels.find((e=>e.gid==u)):e.footprint.autoDeleteMsgUsers.find((e=>e.uid==u)))),[h,{isSuccess:p}]=(0,t.ar)(),[x,g]=(0,l.useState)(null!==(n=null===m||void 0===m?void 0:m.expires_in)&&void 0!==n?n:0),{t:f}=(0,i.$G)("setting",{keyPrefix:"auto_delete_msg"}),{t:j}=(0,i.$G)(),b=[{title:f("off"),value:0},{title:f("5_min"),value:300},{title:f("10_min"),value:600},{title:f("1_hour"),value:3600},{title:f("1_day"),value:86400},{title:f("1_week"),value:604800}];(0,l.useEffect)((()=>{p&&a.Am.success(j("tip.update"))}),[p]);const Z=null!==(s=null===m||void 0===m?void 0:m.expires_in)&&void 0!==s?s:0;return(0,o.jsxs)("section",{className:"max-w-[512px] h-full relative",children:[(0,o.jsxs)("div",{className:"text-sm",children:[(0,o.jsx)("h2",{children:f("title")}),(0,o.jsx)("p",{className:"text-gray-500",children:f("desc")})]}),(0,o.jsx)("div",{className:"mt-4",children:(0,o.jsx)(r.Z,{options:b.map((e=>{let{title:n}=e;return n})),values:b.map((e=>{let{value:n}=e;return n})),value:x||0,onChange:e=>{g(e)}})}),Z!==x&&(0,o.jsx)(d.Z,{saveHandler:()=>{h("user"==v?{users:[{uid:u,expires_in:x}]}:{groups:[{gid:u,expires_in:x}]})},resetHandler:()=>{var e;g(null!==(e=null===m||void 0===m?void 0:m.expires_in)&&void 0!==e?e:0)}})]})}},77493:(e,n,s)=>{s.d(n,{Z:()=>v});var l=s(70537),a=s(27418),i=s(15924),t=s(80874),c=s(6144),d=s(40698),r=s(69885),o=s(14566),u=s(80683);const v=e=>{let{id:n,closeModal:s}=e;const{t:v}=(0,o.$G)("setting"),{t:m}=(0,o.$G)(),h=(0,i.s0)(),[p,{isLoading:x,isSuccess:g}]=(0,c.kE)();return(0,l.useEffect)((()=>{g&&(a.ZP.success(m("tip.delete")),s(),h("/chat"))}),[g]),n?(0,u.jsx)(t.Z,{id:"modal-modal",children:(0,u.jsx)(d.Z,{className:"compact",title:v("channel.delete"),description:v("channel.delete_desc"),buttons:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(r.Z,{onClick:s.bind(null,void 0),className:"cancel",children:m("action.cancel")}),(0,u.jsx)(r.Z,{onClick:()=>{p(n)},className:"danger",children:x?"Deleting":m("action.remove")})]})})}):null}},75157:(e,n,s)=>{s.r(n),s.d(n,{default:()=>F});var l=s(70537),a=s(15924),i=s(64084),t=s(27418),c=s(80874),d=s(6144),r=s(66160);function o(e){const{channel:n,loginUid:s}=(0,r.CG)((n=>{var s;return{channel:n.channels.byId[e],loginUid:null===(s=n.authData.user)||void 0===s?void 0:s.uid}})),[l,{isLoading:a,isSuccess:i}]=(0,d.tW)(),[t,{isLoading:c,isSuccess:o}]=(0,d.VJ)(),u=s==(null===n||void 0===n?void 0:n.owner);return{otherMembers:(null===n||void 0===n?void 0:n.members.filter((e=>e!=s)))||[],transferOwner:n=>{n&&l({id:e,owner:n})},leaveChannel:()=>{e&&t(e)},leaving:c,leaveSuccess:o,isOwner:u,transferring:a,transferSuccess:i}}var u=s(40698),v=s(69885),m=s(18951),h=s(14566),p=s(57425),x=s(80683);const g=e=>{let{id:n,closeModal:s,withLeave:i=!0}=e;const{t:d}=(0,h.$G)(),{transferOwner:r,otherMembers:g,leaving:f,leaveChannel:j,leaveSuccess:b,transferSuccess:Z,transferring:w}=o(n),[_,C]=(0,l.useState)(null),y=(0,a.s0)(),N=e=>{C(e)};if((0,l.useEffect)((()=>{Z&&b&&(t.ZP.success("Leave channel successfully!"),s(),y("/chat"))}),[b,Z,i]),!n)return null;const k=f||w;return(0,x.jsx)(c.Z,{id:"modal-modal",children:(0,x.jsx)(u.Z,{className:"compact",title:"Transfer Ownership",description:"This cannot be undone.",buttons:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(v.Z,{onClick:s.bind(null,void 0),className:"cancel",children:d("action.cancel")}),(0,x.jsx)(v.Z,{disabled:!_,onClick:async()=>{_&&(await r(_),i&&await j())},className:"danger",children:k?"Assigning":"Assign and Leave"})]}),children:(0,x.jsx)("ul",{className:"flex flex-col max-h-[260px] py-4 overflow-y-scroll",children:g.map((e=>(0,x.jsx)("li",{className:(0,p.Z)("cursor-pointer flex items-center px-2 hover:bg-gray-500/10",_==e?"bg-gray-500/10":""),onClick:N.bind(null,e),children:(0,x.jsx)(m.Z,{uid:e,interactive:!1})},e)))})})})},f=e=>{let{id:n,closeModal:s,handleNextStep:i}=e;const{t:d}=(0,h.$G)("setting"),r=(0,a.s0)(),{isOwner:m,leaving:p,leaveChannel:g,leaveSuccess:f}=o(n);return(0,l.useEffect)((()=>{f&&(t.ZP.success("Leave channel successfully!"),s(),r("/chat"))}),[f]),n?(0,x.jsx)(c.Z,{id:"modal-modal",children:(0,x.jsx)(u.Z,{className:"compact",title:d("channel.leave"),description:d(m?"channel.transfer_desc":"channel.leave_desc"),buttons:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(v.Z,{onClick:s.bind(null,void 0),className:"cancel",children:d("action.cancel",{ns:"common"})}),m?(0,x.jsx)(v.Z,{onClick:i,className:"main",children:"Next"}):(0,x.jsx)(v.Z,{onClick:g,className:"danger",children:p?"Leaving":"Leave"})]})})}):null},j=e=>{let{id:n,isOwner:s=!1,closeModal:a}=e;const[i,t]=(0,l.useState)(s);return i?(0,x.jsx)(g,{id:n,closeModal:a}):(0,x.jsx)(f,{id:n,closeModal:a,handleNextStep:()=>{t(!0)}})};var b=s(7477),Z=s(77493),w=s(57889),_=s(95727),C=s(17237),y=s(48540),N=s(15621),k=s(64884),S=s(24563);const G=s.p+"static/media/channel.0d6da91df9cd5abbd471.svg",M=w.ZP.div`
  position: relative;
  width: 512px;
  height: 100%;
  display: flex;
  flex-direction: column;
  gap: 24px;
  .inputs {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 24px;
    .input {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 8px;
      .name {
        padding-left: 36px;
        background-image: url(${G});
        background-size: 20px;
        background-position-x: 8px;
        background-position-y: 8px;
        background-repeat: no-repeat;
      }

    }
  }
`;function $(e){let{id:n=0}=e;const{t:s}=(0,h.$G)("setting",{keyPrefix:"channel"}),{t:a}=(0,h.$G)(),{loginUser:i,channel:c}=(0,r.CG)((e=>({loginUser:e.authData.user,channel:e.channels.byId[n]}))),{data:o,refetch:u}=(0,d.aw)(n),[v,m]=(0,l.useState)(!1),[p,g]=(0,l.useState)(),[f]=(0,d.kG)(),[j,{isSuccess:b}]=(0,d.tW)(),[Z,{isSuccess:w}]=(0,d.Cl)(),G=e=>{const n=e.target.value,{type:s=""}=e.target.dataset;g((e=>e?{...e,[s]:n}:e))};if((0,l.useEffect)((()=>{o&&g(o)}),[o]),(0,l.useEffect)((()=>{if(o&&p){const{name:e,description:n}=p,{name:s,description:l}=o;m(s!==e||l!==n)}}),[o,p]),(0,l.useEffect)((()=>{b&&(t.ZP.success(a("tip.update")),u())}),[b]),(0,l.useEffect)((()=>{w&&t.ZP.success(a("tip.update"))}),[w]),!p||!n)return null;const{name:$,description:L}=p,E=!(null!==i&&void 0!==i&&i.is_admin)&&(null===c||void 0===c?void 0:c.owner)!=(null===i||void 0===i?void 0:i.uid);return(0,x.jsxs)(M,{children:[(0,x.jsx)(_.Z,{type:"channel",url:null===c||void 0===c?void 0:c.icon,name:$,uploadImage:e=>{f({gid:n,image:e})}}),(0,x.jsxs)("div",{className:"inputs",children:[(0,x.jsxs)("div",{className:"input",children:[(0,x.jsx)(y.Z,{htmlFor:"name",children:s("name")}),(0,x.jsx)(C.Z,{disabled:E,className:"name","data-type":"name",onChange:G,value:$,name:"name",id:"name",placeholder:s("name")})]}),(0,x.jsxs)("div",{className:"input",children:[(0,x.jsx)(y.Z,{htmlFor:"desc",children:s("topic")}),(0,x.jsx)(k.Z,{disabled:E,"data-type":"description",onChange:G,value:null!==L&&void 0!==L?L:"",rows:4,name:"name",id:"name",placeholder:s("topic_placeholder")})]}),!E&&(0,x.jsxs)("div",{className:"input",children:[(0,x.jsx)(y.Z,{htmlFor:"desc",children:s("visibility")}),(0,x.jsx)(N.Z,{options:[s("public"),s("private")],values:["true","false"],value:String(c.is_public),onChange:e=>{Z({is_public:"true"===e.toLowerCase(),id:n})}})]})]}),v&&(0,x.jsx)(S.Z,{saveHandler:()=>{if(!p)return;const{name:e,description:s}=p;j({id:n,name:e,description:s})},resetHandler:()=>{g(o)}})]})}var L=s(11089),E=s(93826);const P=e=>{const{t:n}=(0,h.$G)("setting");return[{title:n("nav.general"),items:[{name:"overview",title:n("nav.overview"),component:(0,x.jsx)($,{id:e})},{name:"auto_delete_msg",title:n("nav.auto_delete_msg"),component:(0,x.jsx)(L.Z,{id:e})},{name:"members",title:n("nav.members"),component:(0,x.jsx)(E.Z,{cid:e})}]}]};let U="";function F(){const{t:e}=(0,h.$G)("setting"),{cid:n=0}=(0,a.UO)(),{loginUser:s,channel:t}=(0,r.CG)((e=>({loginUser:e.authData.user,channel:n?e.channels.byId[+n]:void 0}))),c=(0,a.s0)(),[d]=(0,i.lr)(),o=P(+n),u=o.map((e=>{let{items:n}=e;return n})).flat(),v=d.get("nav");U=U||(d.get("f")||"/");const[m,p]=(0,l.useState)(!1),[g,f]=(0,l.useState)(!1),w=()=>{p((e=>!e))},_=()=>{f((e=>!e))};if(!n)return null;const C=u.find((e=>e.name==v))||u[0],y=(null===s||void 0===s?void 0:s.is_admin)||(null===t||void 0===t?void 0:t.owner)==(null===s||void 0===s?void 0:s.uid),N=!(null!==t&&void 0!==t&&t.is_public);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(b.Z,{nav:C,closeModal:()=>{c(U),U=""},title:"Channel Setting",navs:o,dangers:[N&&{title:e("channel.leave"),handler:_},y&&{title:e("channel.delete"),handler:w}],children:C.component}),m&&(0,x.jsx)(Z.Z,{closeModal:w,id:+n}),g&&(0,x.jsx)(j,{closeModal:_,id:+n})]})}}}]);