"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[816],{52816:(e,a,t)=>{t.r(a),t.d(a,{default:()=>j});var s=t(70537),n=t(27418),r=t(14566),o=t(64084),l=t(15924),i=t(80308),c=t(17237),d=t(69885),m=t(15312),u=t(80683);function g(){return(0,u.jsxs)("div",{className:"flex flex-col items-center",children:[(0,u.jsx)("div",{className:"font-bold text-3xl text-gray-800 dark:text-white mt-3",children:"Magic link Sent"}),(0,u.jsx)("p",{className:"text-center text-gray-400 dark:text-gray-300 mb-6",children:"Login to your email client, and continue next step"}),(0,u.jsx)("p",{className:"text-center text-gray-400 dark:text-gray-300",children:"You can close this window now."})]})}var p=t(22421),x=t(88143),h=t(65809),f=t(44917),w=t(21645),y=t(3074),v=t(66160);function j(){var e;const a=(0,v.CG)((e=>e.server.name)),{t:t}=(0,r.$G)("auth"),{t:j}=(0,r.$G)();let[_]=(0,o.lr)(new URLSearchParams(location.search));const[k,{isLoading:N,data:b,isSuccess:P}]=(0,m.uk)(),Z=(0,y.I0)(),[S,{isLoading:L,data:C,isSuccess:$}]=(0,m.l4)(),[q,{isLoading:E}]=(0,m.N0)(),{data:G,isSuccess:I}=(0,h.ww)(),O=(0,l.s0)(),[R,T]=(0,s.useState)({name:"",email:"",password:"",confirmPassword:""}),U=null!==(e=_.get("magic_token"))&&void 0!==e?e:void 0;U&&localStorage.setItem(i.LJ,U),(0,s.useEffect)((()=>{if(P&&b){const{new_magic_token:e,mail_is_sent:a}=b;!a&&e&&O(`/register/set_name?magic_token=${e}`)}}),[P,b]),(0,s.useEffect)((()=>{$&&C&&(n.ZP.success(j("tip.reg")),Z((0,w.A3)(C)),location.href="/#/")}),[$,C]);const z=e=>{const{type:a}=e.target.dataset,{value:t}=e.target;T((e=>(e[a]=t,{...e})))};if(!I)return null;const{who_can_sign_up:A}=G;if("EveryOne"!==A&&!U)return(0,u.jsx)("span",{className:"dark:text-white",children:"Sign up method is updated to Invitation Link Only"});const{name:B,email:D,password:F,confirmPassword:J}=R;if(null!==b&&void 0!==b&&b.mail_is_sent)return(0,u.jsx)(g,{});const M=L||N||E;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"flex-center flex-col pb-6",children:[(0,u.jsx)("img",{src:`${i.ZP}/resource/organization/logo`,alt:"logo",className:"w-14 h-14 md:mb-7 rounded-full"}),(0,u.jsx)("h2",{className:"font-semibold text-2xl text-gray-800 dark:text-white md:mb-2",children:t("reg.title",{name:a})}),(0,u.jsx)("span",{className:"hidden md:block text-gray-400 dark:text-gray-100",children:t("reg.desc")})]}),(0,u.jsxs)("form",{className:"flex flex-col gap-5 w-80 md:min-w-[360px]",onSubmit:async e=>{e.preventDefault();const{name:a,email:t,password:s,confirmPassword:r}=R;if(s!==r)return void n.ZP.error("Not Same Password!");const{data:o}=await q(t);o?U?k({magic_token:U,email:t,password:s}):S({name:a,email:t,password:s}):n.ZP.error("Email already registered!")},autoSave:"false",autoComplete:"true",children:[!U&&(0,u.jsx)(c.Z,{className:"large",name:"name",value:B,required:!0,type:"name",placeholder:t("placeholder_name"),"data-type":"name",onChange:z}),(0,u.jsx)(c.Z,{className:"large",name:"email",value:D,required:!0,type:"email",placeholder:t("placeholder_email"),"data-type":"email",onChange:z}),(0,u.jsx)(c.Z,{className:"large",type:"password",value:F,name:"password",required:!0,minLength:6,"data-type":"password",onChange:z,placeholder:t("placeholder_pwd")}),(0,u.jsx)(c.Z,{className:"large",required:!0,onBlur:()=>{const{password:e,confirmPassword:a}=R;e!==a&&n.ZP.error("Not Same Password!")},type:"password",minLength:6,name:"confirmPassword",value:J,"data-type":"confirmPassword",onChange:z,placeholder:t("placeholder_confirm_pwd")}),(0,u.jsx)(d.Z,{type:"submit",disabled:M,children:t(M?"signing_up":"sign_up")})]}),(0,u.jsx)(x.Z,{content:"OR"}),(0,u.jsx)("div",{className:"flex flex-col gap-3 py-3",children:(0,u.jsx)(f.Z,{type:"register"})}),(0,u.jsx)(p.Z,{token:U})]})}},22421:(e,a,t)=>{t.d(a,{Z:()=>i});var s=t(70537),n=t(14566),r=t(64084),o=t(21812),l=t(80683);function i(e){let{token:a}=e;const{t:t}=(0,n.$G)("auth");return(0,s.useEffect)((()=>{(0,o.tq)()&&a&&(location.href=`https://join.voce.chat/download?link=${encodeURIComponent(`${location.origin}&magic_token=${a}`)}`)}),[a]),(0,l.jsxs)("div",{className:"flex gap-1 mt-7 text-sm text-slate-500 dark:text-gray-100 justify-center",children:[(0,l.jsx)("span",{children:t("reg.have_account")}),(0,l.jsx)(r.OL,{to:"/login",className:"text-primary-400 cursor-pointer",children:t("sign_in")})]})}}}]);