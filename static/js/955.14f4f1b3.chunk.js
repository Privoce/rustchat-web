"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[955],{13706:(e,n,s)=>{s.d(n,{Z:()=>m});var l=s(70537),a=s(27418),t=s(14566),i=s(52334),c=s(6144),r=s(66160),d=s(78806),o=s(4472),u=s(27459),v=s(80683);const m=({id:e,type:n="channel"})=>{var s,m;const{setting:h,channel:x,loginUser:g}=(0,r.CG)((s=>({setting:"channel"==n?s.footprint.autoDeleteMsgChannels.find((n=>n.gid==e)):s.footprint.autoDeleteMsgUsers.find((n=>n.uid==e)),loginUser:s.authData.user,channel:"channel"==n?s.channels.byId[e]:null}))),[f,{isSuccess:p}]=(0,i.ar)(),[j,{isSuccess:Z}]=(0,c.cF)(),[b,N]=(0,l.useState)(null!==(s=null===h||void 0===h?void 0:h.expires_in)&&void 0!==s?s:0),{t:_}=(0,t.$G)("setting",{keyPrefix:"auto_delete_msg"}),{t:w}=(0,t.$G)(),C=[{title:_("off"),value:0},{title:_("5_min"),value:300},{title:_("10_min"),value:600},{title:_("1_hour"),value:3600},{title:_("1_day"),value:86400},{title:_("1_week"),value:604800}];(0,l.useEffect)((()=>{p&&a.Am.success(w("tip.update"))}),[p]),(0,l.useEffect)((()=>{Z&&a.Am.success("Cleared!")}),[Z]);const y=null!==(m=null===h||void 0===h?void 0:h.expires_in)&&void 0!==m?m:0,k="channel"==n&&((null===x||void 0===x?void 0:x.owner)==(null===g||void 0===g?void 0:g.uid)||(null===g||void 0===g?void 0:g.is_admin));return(0,v.jsxs)("section",{className:"max-w-[512px] h-full relative",children:[(0,v.jsxs)("div",{className:"text-sm",children:[(0,v.jsx)("h2",{className:"dark:text-white",children:_("title")}),(0,v.jsx)("p",{className:"text-gray-400 text-xs",children:_("desc")})]}),(0,v.jsx)("div",{className:"mt-4",children:(0,v.jsx)(u.Z,{options:C.map((({title:e})=>e)),values:C.map((({value:e})=>e)),value:b||0,onChange:e=>{N(e)}})}),y!==b&&(0,v.jsx)(d.Z,{saveHandler:()=>{f("dm"==n?{users:[{uid:e,expires_in:b}]}:{groups:[{gid:e,expires_in:b}]})},resetHandler:()=>{var e;N(null!==(e=null===h||void 0===h?void 0:h.expires_in)&&void 0!==e?e:0)}}),k&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"text-sm mt-8",children:[(0,v.jsx)("h2",{className:"dark:text-white",children:_("clear_title")}),(0,v.jsx)("p",{className:"text-gray-400 text-xs",children:_("clear_desc")})]}),(0,v.jsx)("div",{className:"mt-4",children:(0,v.jsx)(o.Z,{className:"danger",onClick:()=>{confirm("are you sure?")&&j(e)},children:_("clear")})})]})]})}},77493:(e,n,s)=>{s.d(n,{Z:()=>v});var l=s(70537),a=s(27418),t=s(14566),i=s(15924),c=s(6144),r=s(97601),d=s(4472),o=s(70254),u=s(80683);const v=({id:e,closeModal:n})=>{const{t:s}=(0,t.$G)("setting"),{t:v}=(0,t.$G)(),m=(0,i.s0)(),[h,{isLoading:x,isSuccess:g}]=(0,c.kE)();return(0,l.useEffect)((()=>{g&&(a.ZP.success(v("tip.delete")),n(),m("/chat"))}),[g]),e?(0,u.jsx)(r.Z,{id:"modal-modal",children:(0,u.jsx)(o.Z,{compact:!0,title:s("channel.delete"),description:s("channel.delete_desc"),buttons:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d.Z,{onClick:n.bind(null,void 0),className:"cancel",children:v("action.cancel")}),(0,u.jsx)(d.Z,{onClick:()=>{h(e)},className:"danger",children:x?"Deleting":v("action.remove")})]})})}):null}},24629:(e,n,s)=>{s.r(n),s.d(n,{default:()=>F});var l=s(70537),a=s(14566),t=s(15924),i=s(64084),c=s(66160),r=s(27418),d=s(6144);function o(e){const{channel:n,loginUid:s}=(0,c.CG)((n=>{var s;return{channel:n.channels.byId[e],loginUid:null===(s=n.authData.user)||void 0===s?void 0:s.uid}})),[l,{isLoading:a,isSuccess:t}]=(0,d.tW)(),[i,{isLoading:r,isSuccess:o}]=(0,d.VJ)(),u=s==(null===n||void 0===n?void 0:n.owner);return{otherMembers:(null===n||void 0===n?void 0:n.members.filter((e=>e!=s)))||[],transferOwner:n=>{n&&l({id:e,owner:n})},leaveChannel:()=>{e&&i(e)},leaving:r,leaveSuccess:o,isOwner:u,transferring:a,transferSuccess:t}}var u=s(97601),v=s(4472),m=s(70254),h=s(80683);const x=({id:e,closeModal:n,handleNextStep:s})=>{const{t:i}=(0,a.$G)("setting"),c=(0,t.s0)(),{isOwner:d,leaving:x,leaveChannel:g,leaveSuccess:f}=o(e);return(0,l.useEffect)((()=>{f&&(r.ZP.success("Leave channel successfully!"),n(),c("/chat"))}),[f]),e?(0,h.jsx)(u.Z,{id:"modal-modal",children:(0,h.jsx)(m.Z,{compact:!0,title:i("channel.leave"),description:i(d?"channel.transfer_desc":"channel.leave_desc"),buttons:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(v.Z,{onClick:n.bind(null,void 0),className:"cancel",children:i("action.cancel",{ns:"common"})}),d?(0,h.jsx)(v.Z,{onClick:s,className:"main",children:"Next"}):(0,h.jsx)(v.Z,{onClick:g,className:"danger",children:x?"Leaving":"Leave"})]})})}):null};var g=s(75649),f=s(65487);const p=({id:e,closeModal:n,withLeave:s=!0})=>{const{t:i}=(0,a.$G)(),{transferOwner:c,otherMembers:d,leaving:x,leaveChannel:p,leaveSuccess:j,transferSuccess:Z,transferring:b}=o(e),[N,_]=(0,l.useState)(null),w=(0,t.s0)(),C=e=>{_(e)};if((0,l.useEffect)((()=>{Z&&j&&(r.ZP.success("Leave channel successfully!"),n(),w("/chat"))}),[j,Z,s]),!e)return null;const y=x||b;return(0,h.jsx)(u.Z,{id:"modal-modal",children:(0,h.jsx)(m.Z,{compact:!0,title:"Transfer Ownership",description:"This cannot be undone.",buttons:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(v.Z,{onClick:n.bind(null,void 0),className:"cancel",children:i("action.cancel")}),(0,h.jsx)(v.Z,{disabled:!N,onClick:async()=>{N&&(await c(N),s&&await p())},className:"danger",children:y?"Assigning":"Assign and Leave"})]}),children:(0,h.jsx)("ul",{className:"flex flex-col max-h-[260px] py-4 overflow-y-scroll",children:d.map((e=>(0,h.jsx)("li",{className:(0,g.Z)("cursor-pointer flex items-center px-2 md:hover:bg-gray-500/10",N==e?"bg-gray-500/10":""),onClick:C.bind(null,e),children:(0,h.jsx)(f.Z,{uid:e,interactive:!1})},e)))})})})},j=({id:e,isOwner:n=!1,closeModal:s})=>{const[a,t]=(0,l.useState)(n);return a?(0,h.jsx)(p,{id:e,closeModal:s}):(0,h.jsx)(x,{id:e,closeModal:s,handleNextStep:()=>{t(!0)}})};var Z=s(37954),b=s(77493),N=s(85225),_=s(13706),w=s(87808),C=s(78806),y=s(99487),k=s(54443),S=s(27459),E=s(96825),G=s(79884);function L({id:e=0}){const{t:n}=(0,a.$G)("setting",{keyPrefix:"channel"}),{t:s}=(0,a.$G)(),{loginUser:t,channel:i}=(0,c.CG)((n=>({loginUser:n.authData.user,channel:n.channels.byId[e]}))),{data:o,refetch:u}=(0,d.aw)(e),[v,m]=(0,l.useState)(!1),[x,g]=(0,l.useState)(),[f]=(0,d.kG)(),[p,{isSuccess:j}]=(0,d.tW)(),[Z,{isSuccess:b}]=(0,d.Cl)(),N=e=>{const n=e.target.value,{type:s=""}=e.target.dataset;g((e=>e?{...e,[s]:n}:e))};if((0,l.useEffect)((()=>{o&&g(o)}),[o]),(0,l.useEffect)((()=>{if(o&&x){const{name:e,description:n}=x,{name:s,description:l}=o;m(s!==e||l!==n)}}),[o,x]),(0,l.useEffect)((()=>{j&&(r.ZP.success(s("tip.update")),u())}),[j]),(0,l.useEffect)((()=>{b&&r.ZP.success(s("tip.update"))}),[b]),!x||!e||!i)return null;const{name:_,description:L}=x,M=!(null!==t&&void 0!==t&&t.is_admin)&&(null===i||void 0===i?void 0:i.owner)!=(null===t||void 0===t?void 0:t.uid),$="w-full flex flex-col items-start gap-2 relative";return(0,h.jsxs)("div",{className:"relative w-[512px] flex flex-col gap-6 h-full",children:[(0,h.jsx)(w.Z,{type:"channel",url:null===i||void 0===i?void 0:i.icon,name:_,uploadImage:n=>{f({gid:e,image:n})}}),(0,h.jsxs)("div",{className:"flex flex-col gap-6 items-start",children:[(0,h.jsxs)("div",{className:"flex items-center gap-1",children:[(0,h.jsx)(k.Z,{htmlFor:"name",children:n("id")}),(0,h.jsxs)("span",{className:"text-gray-500",children:["#",e]})]}),(0,h.jsxs)("div",{className:$,children:[(0,h.jsx)(k.Z,{htmlFor:"name",children:n("name")}),(0,h.jsx)(y.Z,{disabled:M,className:"!pl-8","data-type":"name",onChange:N,value:_,name:"name",id:"name",placeholder:n("name")}),(0,h.jsx)(G.Z,{className:"absolute bottom-2.5 left-2 dark:fill-gray-300"})]}),(0,h.jsxs)("div",{className:$,children:[(0,h.jsx)(k.Z,{htmlFor:"desc",children:n("topic")}),(0,h.jsx)(E.Z,{disabled:M,"data-type":"description",onChange:N,value:null!==L&&void 0!==L?L:"",rows:4,name:"name",id:"name",placeholder:n("topic_placeholder")})]}),!M&&t.is_admin&&(0,h.jsxs)("div",{className:$,children:[(0,h.jsx)(k.Z,{htmlFor:"desc",children:n("visibility")}),(0,h.jsx)(S.Z,{options:[n("public"),n("private")],values:["true","false"],value:String(i.is_public),onChange:n=>{Z({is_public:"true"===n.toLowerCase(),id:e})}})]})]}),v&&(0,h.jsx)(C.Z,{saveHandler:()=>{if(!x)return;const{name:n,description:s}=x;p({id:e,name:n,description:s})},resetHandler:()=>{g(o)}})]})}const M=e=>{const{t:n}=(0,a.$G)("setting");return[{title:n("nav.general"),items:[{name:"overview",title:n("nav.overview"),component:(0,h.jsx)(L,{id:e})},{name:"auto_delete_msg",title:n("nav.auto_delete_msg"),component:(0,h.jsx)(_.Z,{id:e})},{name:"members",title:n("nav.members"),component:(0,h.jsx)(N.Z,{cid:e})}]}]};let $="";function F(){const{t:e}=(0,a.$G)("setting"),{cid:n=0,nav:s}=(0,t.UO)(),{loginUser:r,channel:d}=(0,c.CG)((e=>({loginUser:e.authData.user,channel:n?e.channels.byId[+n]:void 0}))),o=(0,t.s0)(),[u]=(0,i.lr)(),v=M(+n),m=v.map((({items:e})=>e)).flat();$=$||(u.get("f")||"/");const[x,g]=(0,l.useState)(!1),[f,p]=(0,l.useState)(!1),N=()=>{g((e=>!e))},_=()=>{p((e=>!e))};if(!n)return null;const w=m.find((e=>e.name==s)),C=(null===r||void 0===r?void 0:r.is_admin)||(null===d||void 0===d?void 0:d.owner)==(null===r||void 0===r?void 0:r.uid),y=!(null!==d&&void 0!==d&&d.is_public);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Z.Z,{pathPrefix:`/setting/channel/${n}`,nav:w,closeModal:()=>{o($),$=""},title:"Channel Settings",navs:v,dangers:[y&&{title:e("channel.leave"),handler:_},C&&{title:e("channel.delete"),handler:N}],children:s?null===w||void 0===w?void 0:w.component:null}),x&&(0,h.jsx)(b.Z,{closeModal:N,id:+n}),f&&(0,h.jsx)(j,{closeModal:_,id:+n})]})}},97943:(e,n,s)=>{s.d(n,{O:()=>t});var l=s(70537),a=s(2978);function t(e,n,s=!0){const t=(0,l.useRef)(n),i=(0,l.useCallback)((n=>{e.current&&!e.current.contains(n.target)&&t.current(n)}),[e]);(0,l.useEffect)((()=>{t.current=n})),(0,l.useEffect)((()=>s?(document.addEventListener("click",i,!0),document.addEventListener("ontouchstart",i,!0),()=>{document.removeEventListener("click",i,!0),document.removeEventListener("ontouchstart",i,!0)}):a.Z),[e,n,s,i])}},2978:(e,n,s)=>{s.d(n,{Z:()=>l});const l=()=>{}}}]);