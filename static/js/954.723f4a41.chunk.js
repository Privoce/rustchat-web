"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[954],{24041:(e,t,i)=>{i.d(t,{Z:()=>l});var n,s=i(70537);function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r.apply(this,arguments)}const a=(e,t)=>{let{title:i,titleId:a,...l}=e;return s.createElement("svg",r({width:16,height:16,viewBox:"0 0 16 16",fill:"#6C737F",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},l),i?s.createElement("title",{id:a},i):null,n||(n=s.createElement("path",{d:"M8.11904 0C3.91105 0 0.5 3.41105 0.5 7.61905C0.5 11.827 3.91105 15.2381 8.11904 15.2381C12.3271 15.2381 15.7381 11.827 15.7381 7.61905C15.7381 3.41105 12.3263 0 8.11904 0ZM11.7053 10.128L10.628 11.2053L8.11904 8.69714L5.61009 11.2053L4.53277 10.128L7.04095 7.61905L4.532 5.1101L5.60934 4.03353L8.11829 6.54248L10.6272 4.03353L11.7045 5.1101L9.19638 7.61905L11.7053 10.128Z"})))},l=(0,s.forwardRef)(a)},11972:(e,t,i)=>{i.d(t,{Z:()=>l});var n,s=i(70537);function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r.apply(this,arguments)}const a=(e,t)=>{let{title:i,titleId:a,...l}=e;return s.createElement("svg",r({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},l),i?s.createElement("title",{id:a},i):null,n||(n=s.createElement("path",{d:"M16.5303 11.7204L16.4462 11.6478C16.1526 11.4299 15.7359 11.4541 15.4697 11.7204L12.7503 14.4397L12.75 7.75003L12.7432 7.64826C12.6935 7.28218 12.3797 7.00003 12 7.00003L11.8982 7.00688C11.5322 7.05654 11.25 7.37033 11.25 7.75003L11.2503 14.4417L8.52961 11.7198L8.4455 11.6472C8.15193 11.4293 7.73527 11.4534 7.46895 11.7196C7.176 12.0124 7.17591 12.4873 7.46875 12.7803L11.4687 16.7818L11.5529 16.8544C11.8465 17.0724 12.2632 17.0482 12.5295 16.7819L16.5303 12.7811L16.6029 12.6969C16.8208 12.4033 16.7966 11.9867 16.5303 11.7204ZM6.25 3C4.45507 3 3 4.45507 3 6.25V17.75C3 19.5449 4.45507 21 6.25 21H17.75C19.5449 21 21 19.5449 21 17.75V6.25C21 4.45507 19.5449 3 17.75 3H6.25ZM4.5 6.25C4.5 5.2835 5.2835 4.5 6.25 4.5H17.75C18.7165 4.5 19.5 5.2835 19.5 6.25V17.75C19.5 18.7165 18.7165 19.5 17.75 19.5H6.25C5.2835 19.5 4.5 18.7165 4.5 17.75V6.25Z",fill:"#fff"})))},l=(0,s.forwardRef)(a)},10189:(e,t,i)=>{i.d(t,{Z:()=>l});var n,s=i(70537);function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r.apply(this,arguments)}const a=(e,t)=>{let{title:i,titleId:a,...l}=e;return s.createElement("svg",r({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},l),i?s.createElement("title",{id:a},i):null,n||(n=s.createElement("path",{d:"M14.2958 16.2945C13.9055 16.6853 13.906 17.3184 14.2968 17.7087C14.6876 18.0989 15.3207 18.0985 15.711 17.7077L20.7076 12.7043C21.0976 12.3137 21.0974 11.681 20.7072 11.2906L15.7106 6.29297C15.3201 5.9024 14.6869 5.90234 14.2964 6.29282C13.9058 6.6833 13.9057 7.31647 14.2962 7.70703L17.589 11H11C6.66509 11 3.13546 14.4478 3.00381 18.7508L3 19C3 19.5523 3.44772 20 4 20C4.55228 20 5 19.5523 5 19C5 15.7616 7.56557 13.1224 10.7751 13.0041L11 13H17.586L14.2958 16.2945Z",fill:"#667085"})))},l=(0,s.forwardRef)(a)},79180:(e,t,i)=>{i.d(t,{Z:()=>f});var n=i(70537),s=i(57889),r=i(97943),a=i(81721),l=i(18225),o=i(80874),d=i(80683);const c=s.F4`
  from {
    background: transparent;
  }
  to {
    background: rgba(1, 1, 1, 0.9);
  }
`,p=s.ZP.div`
  transition: all 0.5s ease;
  width: 100vw;
  height: 100vh;
  animation: ${c} 0.3s ease-in-out forwards;
  display: flex;
  align-items: center;
  justify-content: center;

  .box {
    position: relative;
    transition: all 0.2s ease;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    gap: 10px;

    > .loading {
      position: absolute;
      top: 40%;
      left: 50%;
      transform: translateX(-50%);
    }

    > .image {
      overflow: auto;

      img {
        max-width: 70vw;
        max-height: 80vh;
      }
    }

    &.loading .image img {
      filter: blur(2px);
    }
  }
`,f=e=>{let{download:t=!0,data:i,closeModal:s}=e;const[c,f]=(0,n.useState)(null===i||void 0===i?void 0:i.thumbnail),[u,h]=(0,n.useState)(!0),x=(0,n.useRef)(null);if((0,r.O)(x,s),(0,a.z)("Escape",(()=>{s()}),{eventTypes:["keyup"]}),(0,n.useEffect)((()=>{if(i){const{originUrl:e}=i;e||h(!1);const t=new Image;t.src=e,t.onload=()=>{f(e),h(!1)},t.onerror=()=>{h(!1)}}}),[i]),!i)return null;const{originUrl:m,downloadLink:g,name:v,type:w}=i;return(0,d.jsx)(o.Z,{children:(0,d.jsx)(p,{children:(0,d.jsxs)("div",{className:"box "+(u?"loading":""),ref:x,children:[(0,d.jsx)("div",{className:"image",children:(0,d.jsx)("img",{src:c,alt:"preview"})}),t&&(0,d.jsx)("a",{className:"font-semibold text-sm text-gray-600 hover:underline hover:text-white",download:v,type:w,href:g||m,rel:"noreferrer",children:"Download original"}),u&&(0,d.jsx)("div",{className:"loading",children:(0,d.jsx)(l.Z,{})})]})})})}},7935:(e,t,i)=>{i.d(t,{Z:()=>m});var n=i(24533),s=(i(34376),i(70537)),r=i(57889),a=i(24783),l=i(80683);const o=r.ZP.a`
  background: #f3f4f6;
  border: 1px solid #d4d4d4;
  box-sizing: border-box;
  border-radius: 6px;
  padding: 12px 8px;
  display: flex;
  align-items: center;
  gap: 8px;
  width: 380px;
  .favicon {
    display: flex;
    width: 48px;
    height: 48px;
    border-radius: 4px;
    img {
      object-fit: contain;
    }
  }
  .info {
    display: flex;
    flex-direction: column;
    .title {
      font-style: normal;
      font-weight: 600;
      font-size: 14px;
      line-height: 20px;
      color: #1c1c1e;
    }
    .desc {
      font-weight: 500;
      font-size: 12px;
      line-height: 18px;
      color: #616161;
    }
    .link {
      font-weight: 400;
      font-size: 10px;
      line-height: 18px;
      color: #616161;
    }
    .dots {
      width: 288px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }
`,d=r.ZP.a`
  width: 380px;
  padding: 12px;
  background: #f3f4f6;
  border: 1px solid #d4d4d4;
  box-sizing: border-box;
  border-radius: 6px;
  display: flex;
  flex-direction: column;
  .title {
    font-weight: 600;
    font-size: 16px;
    line-height: 24px;
    color: #06aed4;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .desc {
    font-weight: 400;
    font-size: 12px;
    line-height: 18px;
    color: #616161;
    margin-bottom: 8px;
    width: 356px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .image {
    width: 100%;
    height: 180px;
    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  }
`;function c(e){let{url:t=""}=e;const[i,n]=(0,s.useState)(""),[r]=(0,a.rf)(),[c,p]=(0,s.useState)(null);(0,s.useEffect)((()=>{(async e=>{var t;let i="";try{i=`${new URL(e).origin}/favicon.ico`}catch{i=`${location.origin}/favicon.ico`}const{data:s}=await r(e),a=(null===s||void 0===s?void 0:s.title)||(null===s||void 0===s?void 0:s.site_name)||"",l=(null===s||void 0===s?void 0:s.description)||"",o=(null===s||void 0===s||null===(t=s.images.find((e=>!!e.url)))||void 0===t?void 0:t.url)||"",d=(null===s||void 0===s?void 0:s.favicon_url)||i;n(d),p({title:a,description:l,ogImage:o})})(t)}),[t]);if(!t||!c||!c.title)return null;const{title:f,description:u,ogImage:h}=c;return h?(0,l.jsxs)(d,{href:t,target:"_blank",children:[(0,l.jsx)("h3",{className:"title",children:f}),(0,l.jsx)("p",{className:"desc dots",children:u}),(0,l.jsx)("div",{className:"image",children:(0,l.jsx)("img",{src:h,alt:"og image"})})]}):(0,l.jsxs)(o,{href:t,target:"_blank",children:[i&&(0,l.jsx)("div",{className:"favicon",children:(0,l.jsx)("img",{onError:()=>{n("")},src:i,alt:"favicon"})}),(0,l.jsxs)("div",{className:"info",children:[(0,l.jsx)("h3",{className:"title",children:f}),(0,l.jsx)("p",{className:"desc dots",children:u}),(0,l.jsx)("span",{className:"link dots",children:t})]})]})}var p=i(7829),f=i(71044),u=i(66160);const h=r.ZP.span`
  padding: 0 2px;
  color: #1fe1f9;
  &.clickable {
    cursor: pointer;
  }
`,x=e=>{let{uid:t,popover:i=!0,cid:n,textOnly:s=!1}=e;const r=(0,u.CG)((e=>e.users.byId))[t];return r?s?(0,l.jsx)(l.Fragment,{children:`@${r.name}`}):i?(0,l.jsx)(p.ZP,{interactive:!0,placement:"top",trigger:"click",content:(0,l.jsx)(f.Z,{uid:t,type:"card",cid:n}),children:(0,l.jsx)(h,{className:"clickable",children:`@${r.name}`})}):(0,l.jsx)(h,{children:`@${r.name}`}):null},m=e=>{let{url:t=!0,mention:i=!0,mentionTextOnly:s=!1,mentionPopOver:r=!0,text:a,cid:o}=e;return(0,l.jsx)(n.Z,{options:{render:{email:e=>{let{content:t,attributes:{href:i}}=e;return s?(0,l.jsx)(l.Fragment,{children:t}):(0,l.jsx)("a",{className:"link",href:i,rel:"noreferrer",children:t})},url:e=>{let{content:i,attributes:{href:n}}=e;return t?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("a",{className:"link",target:"_blank",href:n,rel:"noreferrer",children:i}),(0,l.jsx)(c,{url:n})]}):(0,l.jsx)(l.Fragment,{children:i})},mention:e=>{let{content:t}=e;if(!i)return(0,l.jsx)(l.Fragment,{children:t});if(/@[0-9]+/.test(t)){const e=t.trim().slice(1);return(0,l.jsx)(x,{uid:+e,cid:o,popover:r,textOnly:s})}return(0,l.jsx)(l.Fragment,{children:t})}}},children:a})}},84006:(e,t,i)=>{i.d(t,{Z:()=>p});var n=i(70537),s=(i(85012),i(69495),i(55403)),r=i.n(s),a=i(85606),l=i(57889),o=i(79180),d=i(80683);const c=l.ZP.div`
  * {
    user-select: text;
  }
  .toastui-editor-contents {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
  }
`,p=e=>{let{content:t}=e;const i=(0,n.useRef)(null),[s,l]=(0,n.useState)(null);(0,n.useEffect)((()=>{const e=null===i||void 0===i?void 0:i.current;e&&e.addEventListener("click",(e=>{e.stopPropagation();const t=e.target;if(t&&"IMG"==t.nodeName){const e=new URL(t.src),i=`${e.origin}${e.pathname}?file_path=${e.searchParams.get("file_path")}`;l({originUrl:i})}}),!0)}),[]);return(0,d.jsxs)(d.Fragment,{children:[s&&(0,d.jsx)(o.Z,{download:!1,data:s,closeModal:()=>{l(null)}}),(0,d.jsx)(c,{ref:i,children:(0,d.jsx)(a.A,{initialValue:t,plugins:[r()]})})]})}},96954:(e,t,i)=>{i.d(t,{Z:()=>p});var n=i(70537),s=i(57889),r=i(17150),a=i(27281),l=i(64631),o=i(11855),d=i(80683);const c=s.ZP.div`
  display: flex;
  flex-direction: column;
  border-radius: var(--br);
  background-color: #f4f4f5;
`,p=e=>{let{id:t=""}=e;const{favorites:i}=(0,o.Z)({}),[s,p]=(0,n.useState)(null);return(0,n.useEffect)((()=>{const e=i.find((e=>e.id==t)),{messages:n}=e||{};if(!n)return;const s=n.map((e=>{let{from_mid:t}=e;return+t}))||[];p((0,d.jsx)(c,{"data-favorite-mids":s.join(","),className:"favorite",children:(0,d.jsx)("div",{className:"list",children:n.map(((e,t)=>{const{user:i={},download:n,content:s,content_type:o,properties:c,thumbnail:p}=e;return(0,d.jsxs)(r.Z,{className:"archive",children:[i&&(0,d.jsx)("div",{className:"avatar",children:(0,d.jsx)(l.Z,{width:40,height:40,src:i.avatar,name:i.name})}),(0,d.jsxs)("div",{className:"details",children:[(0,d.jsx)("div",{className:"up",children:(0,d.jsx)("span",{className:"name",children:(null===i||void 0===i?void 0:i.name)||"Deleted User"})}),(0,d.jsx)("div",{className:"down",children:(0,a.Z)({download:n,content:s,content_type:o,properties:c,thumbnail:p})})]})]},t)}))})}))}),[i,t]),t?s:null}},27281:(e,t,i)=>{i.d(t,{Z:()=>D});var n=i(7699),s=i.n(n),r=i(18541),a=i(80308),l=i(70537),o=i(57889),d=i(17150),c=i(64631),p=i(10189),f=i(21812),u=i(24783);var h=i(14566),x=i(80683);const m=o.ZP.div`
  display: flex;
  flex-direction: column;
  border-radius: var(--br);
  background-color: #f4f4f5;
  > .tip {
    padding: 8px 8px 0 8px;
    display: flex;
    align-items: center;
    gap: 4px;
    .icon {
      width: 16px;
      height: 16px;
      path {
        fill: #98a2b3;
      }
    }
    font-weight: 400;
    font-size: 12px;
    line-height: 18px;
    color: #98a2b3;
  }
`,g=e=>{let{context:t,to:i,from_uid:n,id:s}=e;const{t:r}=(0,h.$G)(),{normalizeMessage:a,messages:o}=function(){const[e,t]=(0,l.useState)(null),[i,n]=(0,l.useState)(null),[s,{data:r,isError:a,isLoading:o,isSuccess:d}]=(0,u.uv)();return(0,l.useEffect)((()=>{if(r&&d){const t=(0,f.Hr)(r,e);n(t)}}),[r,d,e]),(0,l.useEffect)((()=>{e&&s(e)}),[e]),{normalizeMessage:e=>{t(e)},messages:i,isError:a,isLoading:o,isSuccess:d}}(),[g,v]=(0,l.useState)(null);return(0,l.useEffect)((()=>{s&&a(s)}),[s]),(0,l.useEffect)((()=>{if(o){const e=o.map((e=>{let{from_mid:t}=e;return t}))||[];v((0,x.jsxs)(m,{"data-forwarded-mids":e.join(","),children:[(0,x.jsxs)("h4",{className:"tip",children:[(0,x.jsx)(p.Z,{className:"icon"}),r("action.forward")]}),(0,x.jsx)("div",{className:"list",children:o.map(((e,s)=>{const{user:r={},download:a,content:l,content_type:o,properties:p,thumbnail:f}=e;return(0,x.jsxs)(d.Z,{className:"archive",children:[r&&(0,x.jsx)("div",{className:"avatar",children:(0,x.jsx)(c.Z,{width:24,height:24,src:r.avatar,name:r.name})}),(0,x.jsxs)("div",{className:"details",children:[(0,x.jsx)("div",{className:"up",children:(0,x.jsx)("span",{className:"name",children:(null===r||void 0===r?void 0:r.name)||"Deleted User"})}),(0,x.jsx)("div",{className:"down",children:D({download:a,context:t,to:i,from_uid:n,content:l,content_type:o,properties:p,thumbnail:f})})]})]},s)}))})]}))}}),[o,t,i,n]),s?g:null};var v=i(84006);const w=o.ZP.div`
  background: #f3f4f6;
  border: 1px solid #d4d4d4;
  box-sizing: border-box;
  border-radius: 6px;
  width: 370px;
  height: 66px;
  &.sending {
    opacity: 0.9;
  }
  * {
    user-select: text;
  }
  .basic {
    padding: 8px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    .icon {
      width: 36px;
      height: 48px;
     
    }
    .info {
      display: flex;
      flex-direction: column;
      gap: 4px;
      width: 100%;
      overflow: hidden;
      .name {
        font-weight: 600;
        font-size: 14px;
        line-height: 20px;
        color: #1c1c1e;
        white-space: nowrap;
        text-overflow: ellipsis;
      }
      .details {
        white-space: nowrap;
        font-weight: 400;
        font-size: 12px;
        line-height: 18px;
        color: #616161;
        display: flex;
        gap: 16px;
        .from strong {
          font-weight: bold;
        }
      }
    }
    .download {
      white-space: nowrap;
      svg path{
        fill: #616161;
      }
    }
    .cancel {
      cursor: pointer;
    }
  }
`;var b=i(51091);const j=e=>{let{uploading:t,progress:i,thumbnail:n,download:s,content:r,properties:a}=e;const[o,d]=(0,l.useState)(n),{width:c=0,height:p=0}=(0,f.CW)(a);return(0,l.useEffect)((()=>{const e=n,t=new Image;t.onload=()=>{d(e)},t.onerror=()=>{d("")},t.src=e}),[n]),(0,x.jsxs)("div",{className:"relative w-fit h-fit",children:[t&&(0,x.jsxs)("div",{className:"absolute left-0 top-0 w-full h-full bg-white/40 flex flex-col justify-center items-center gap-1",children:[(0,x.jsx)(b.Z,{size:45,speed:2,color:"#666"}),(0,x.jsxs)("span",{className:"text-xs text-gray-600",children:[i,"%"]})]}),(0,x.jsx)("img",{className:"max-w-[480px] cursor-zoom-in object-cover preview",style:{width:c?`${c}px`:"",height:p?`${p}px`:""},"data-meta":JSON.stringify(a),"data-origin":r,"data-download":s,src:o})]})};var y=i(53517),N=i(1823),_=i(88332),Z=i(66160);var L=i(34265),k=i(62432);const C=e=>{let{value:t,width:i="100%"}=e;return(0,x.jsx)("div",{className:"bg-[#ecfdff] rounded h-2 overflow-hidden",style:{width:i},children:(0,x.jsx)("div",{className:"h-2 bg-[#088ab2] rounded transition-all",style:{width:`${t}%`}})})};var E=i(11972),z=i(24041),S=i(66673),$=i(8969);const P=e=>{let{url:t,name:i,size:n,download:s}=e;const[r,a]=(0,l.useState)(!1),[o,d]=(0,l.useState)(!1),c=(0,f.td)(n),p="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2";return(0,x.jsxs)("div",{className:"w-96 h-52 relative rounded-md border border-solid border-gray-300 overflow-hidden group",children:[(0,x.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-black/40 z-20 group-hover:hidden"}),(0,x.jsxs)("div",{className:"absolute top-0 left-0 w-full flex justify-between z-30 px-3 py-2 overflow-hidden group-hover:bg-black/20",children:[(0,x.jsxs)("div",{className:"flex gap-2 ",children:[(0,x.jsx)($.Z,{className:"w-9 h-auto"}),(0,x.jsxs)("div",{className:"flex flex-col gap-1 text-sm text-white",children:[(0,x.jsx)("span",{title:i,className:"font-bold whitespace-nowrap text-ellipsis w-[240px] overflow-hidden",children:i}),(0,x.jsx)("span",{children:c})]})]}),(0,x.jsx)("a",{href:s,className:"mt-2",children:(0,x.jsx)(E.Z,{className:"fill-white"})})]}),r?o?(0,x.jsx)("span",{className:`${p} text-red-500`,children:"Error"}):null:(0,x.jsx)("div",{className:p,children:(0,x.jsx)(S.Z,{color:"#fff"})}),(0,x.jsx)("video",{onPlay:e=>{const t=e.currentTarget.previousSibling;t&&t.classList.add("hidden")},onError:()=>{a(!1),d(!0)},onCanPlay:()=>{a(!0)},onPause:e=>{const t=e.currentTarget.previousSibling;t&&t.classList.remove("hidden")},controls:r,className:"absolute left-0 top-0 w-full h-full object-cover z-10",children:(0,x.jsx)("source",{src:t,type:"video/mp4"})})]})};var F=i(20814),O=i(57425);const M=e=>{let{url:t,name:i,size:n,download:s}=e;const[r,a]=(0,l.useState)(!1),o=(0,f.td)(n);return(0,x.jsxs)("div",{className:"w-96 flex flex-col gap-2 px-3 py-2 rounded-md border border-solid border-gray-300 overflow-hidden bg-[#f1f3f4]",children:[(0,x.jsxs)("div",{className:"flex justify-between z-30 overflow-hidden",children:[(0,x.jsxs)("div",{className:"flex gap-2 ",children:[(0,x.jsx)(F.Z,{className:"w-9 h-auto"}),(0,x.jsxs)("div",{className:"flex flex-col gap-1 text-sm text-gray-700",children:[(0,x.jsx)("span",{title:i,className:"font-bold whitespace-nowrap text-ellipsis w-[240px] overflow-hidden",children:i}),(0,x.jsx)("span",{children:o})]})]}),(0,x.jsx)("a",{href:s,className:"mt-2",children:(0,x.jsx)(E.Z,{className:"download_icon gray"})})]}),(0,x.jsx)("audio",{src:t,onCanPlay:()=>{a(!0)},controls:!0,className:(0,O.Z)("w-full object-cover z-10",r?"":"hidden")})]})},R=e=>e.startsWith("blob:"),U=e=>{let{context:t,to:i,created_at:n,from_uid:r,content:a="",download:o="",thumbnail:d="",properties:c={local_id:0,name:"",size:0,content_type:""}}=e;const[p,u]=(0,l.useState)(null),[h,m]=(0,l.useState)(!1),g=function(e){let{context:t="user",id:i=0}=e;const n=(0,Z.TL)(),s="channel"==t?N.nF:_.Fs;return e=>{n(s({id:i,mid:e})),n((0,y.Gd)(e))}}({context:t,id:i}),{sendMessage:v,isSuccess:b,isSending:S}=(0,k.Z)({context:t,from:r,to:i}),{stopUploading:$,data:F,uploadFile:O,progress:U,isSuccess:T}=(0,L.Z)(),D=(0,Z.CG)((e=>e.users.byId[r])),{size:I=0,name:G,content_type:H}=null!==c&&void 0!==c?c:{};(0,l.useEffect)((()=>{R(a)&&(async e=>{let{url:t,name:i,type:n}=e;try{if(m(!0),n.startsWith("image")){const e=await(0,f.Ad)(t);u(e)}let e=await fetch(t).then((e=>e.blob())).then((e=>new File([e],i,{type:n})));await O(e),m(!1)}catch(s){m(!1)}})({url:a,name:G,type:H})}),[a,G,H]),(0,l.useEffect)((()=>{const e=null!==c&&void 0!==c?c:{},t=p?{...e,...p}:e;if(T&&R(a)){const{path:e}=F;v({ignoreLocal:!0,type:"file",content:{path:e},properties:t})}}),[T,F,c,a]),(0,l.useEffect)((()=>{b&&URL.revokeObjectURL(a)}),[b,a]);if(!c)return null;const A=(0,f.LP)(H,G);if(!a||!G)return null;const V=h||S;return(0,f.Or)(H,I)?(0,x.jsx)(j,{uploading:V,progress:U,properties:{...p,...c},content:a,download:o,thumbnail:d},null===c||void 0===c?void 0:c.local_id):H.startsWith("video")&&!V?(0,x.jsx)(P,{size:I,url:a,name:G,download:o}):H.startsWith("audio")&&!V?(0,x.jsx)(M,{size:I,url:a,name:G,download:o}):(0,x.jsx)(w,{className:"file_message "+(V?"sending":""),children:(0,x.jsxs)("div",{className:"basic",children:[A,(0,x.jsxs)("div",{className:"info",children:[(0,x.jsx)("span",{className:"name",children:G}),(0,x.jsx)("span",{className:"details",children:V?(0,x.jsx)(C,{value:U,width:"80%"}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"size",children:(0,f.td)(I)}),(0,x.jsx)("i",{className:"time",children:s()(n).fromNow()}),D&&(0,x.jsxs)("i",{className:"from",children:["by ",(0,x.jsx)("strong",{children:D.name})]})]})})]}),V?(0,x.jsx)(z.Z,{className:"cancel",onClick:()=>{$(),URL.revokeObjectURL(a),g(c.local_id)}}):(0,x.jsx)("a",{className:"download",download:G,href:`${a}&download=true`,children:(0,x.jsx)(E.Z,{})})]})})};var T=i(7935);const D=e=>{let{context:t,to:i=0,from_uid:n=0,created_at:l,properties:o,content_type:d,content:c,download:p,thumbnail:f,edited:u=!1}=e,h=null;switch(d){case a.bT.text:h=(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(T.Z,{text:c,cid:i}),u&&(0,x.jsxs)("span",{className:"edited",title:s()(+u).format("YYYY-MM-DD h:mm:ss A"),children:["(",r.ZP.t("edited",{ns:"chat"}),")"]})]});break;case a.bT.markdown:h=(0,x.jsx)(v.Z,{content:c});break;case a.bT.file:h=(0,x.jsx)(U,{properties:o,context:t,to:i,download:p,thumbnail:f,from_uid:n,created_at:l,content:c});break;case a.bT.archive:h=(0,x.jsx)(g,{properties:o,context:t,to:i,from_uid:n,created_at:l,id:c,thumbnail:f})}return h}},17150:(e,t,i)=>{i.d(t,{Z:()=>n});const n=i(57889).ZP.div`
  position: relative;
  display: flex;
  align-items: flex-start;
  gap: 16px;
  padding: 4px 8px;
  margin: 8px 0;
  border-radius: 8px;
  &[data-highlight="true"] {
    background: #f5f6f7;
  }
  &.auto_delete {
    background: #f1d1ca50;
  }
  &.pinned {
    background: #ecfdff;
  }
  &:hover,
  &.contextVisible,
  &.preview {
    background: #f5f6f7;
    .cmds {
      visibility: visible;
    }
  }
  &.readonly:hover {
    background: none;
  }
  > .avatar {
    flex-shrink: 0;
    cursor: pointer;
    width: 40px;
    height: 40px;
    img {
      object-fit: cover;
      width: 100%;
      height: 100%;
      border-radius: 50%;
    }
  }
  > .details {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 8px;
    .up {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
      .name {
        color: #06b6d4;
        font-style: normal;
        font-size: 14px;
        line-height: 20px;
      }
      .time {
        color: #bfbfbf;
        font-size: 12px;
        line-height: 18px;
      }
    }
    .down {
      user-select: text;
      color: #374151;
      font-weight: normal;
      font-size: 14px;
      line-height: 20px;
      word-break: break-all;
      white-space: pre-wrap;
      .edited {
        margin-left: 5px;
        color: #999;
        font-size: 10px;
      }
      &.sending {
        opacity: 0.9;
      }
      > .link {
        text-decoration: none;
        border-radius: 2px;
        /* background-color: #f5feff; */
        padding: 2px;
        color: #1fe1f9;
      }
      /* 下载图标颜色 */
      .download_icon.gray{
        path{
            fill: #616161;
          }
      }
    }
  }
  &.archive {
    gap: 8px;
    > .details {
      gap: 0;
      .up .name {
        font-weight: 600;
        color: #475467;
      }
      .down {
        color: #475467;
      }
    }
  }
  &.pinned {
    padding-top: 26px;
    > .details {
      position: relative;
      &:before {
        position: absolute;
        left: 0;
        top: -4px;
        transform: translateY(-100%);
        content: attr(data-pin-tip);
        font-weight: 400;
        font-size: 12px;
        line-height: 18px;
        color: #98a2b3;
      }
    }
  }
`},11855:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(70537),s=i(24783),r=i(66160);function a(e){let{cid:t=null,uid:i=null}=e;const[a]=(0,s.DJ)(),[l]=(0,s.mK)(),[o,d]=(0,n.useState)([]),{favs:c=[]}=(0,r.CG)((e=>({favs:e.favorites})));return(0,n.useEffect)((()=>{let e=[];e=t?c.filter((e=>!!e.messages&&e.messages.every((e=>e.source.gid==t)))):c,e=i?e.filter((e=>!!e.messages&&e.messages.every((e=>e.source.uid==i)))):e,d(e)}),[t,i,c]),{isFavorited:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!e)return!1;let t=[];return o.forEach((e=>{var i;if(1==(null===e||void 0===e||null===(i=e.messages)||void 0===i?void 0:i.length)){const i=e.messages.map((e=>e.from_mid));t=[...t,...i]}})),t.findIndex((t=>t==e))>-1},addFavorite:async e=>{const t=Array.isArray(e)?e.map((e=>+e)):[+e];if(0==t.length)return;return!("error"in await l(t))},removeFavorite:e=>{e&&a(e)},favorites:o}}},62432:(e,t,i)=>{i.d(t,{Z:()=>d});var n=i(27418),s=i(53517),r=i(6144),a=i(52334),l=i(24783),o=i(66160);const d=e=>{const{context:t="user",from:i=0,to:d=0}=e||{},c=(0,o.TL)(),p=(0,o.CG)((e=>e.ui.uploadFiles[`${t}_${d}`]||[])),[f,{isError:u,isLoading:h,isSuccess:x}]=(0,l.qt)(),[m,{isLoading:g,isSuccess:v,isError:w}]=(0,r.R4)(),[b,{isLoading:j,isSuccess:y,isError:N}]=(0,a.bm)(),_="user"==t?b:m,Z=()=>{c((0,s.XS)(`${t}_${d}`))};return{setReplying:e=>{0===p.length?c((0,s.MQ)({mid:e,key:`${t}_${d}`})):n.ZP.error("Only text is supported when replying a message")},removeReplying:Z,sendMessages:async e=>{let{type:t="text",content:i,users:n=[],channels:s=[]}=e;if(n.length)for await(const r of n)await b({type:t,id:r,content:i});if(s.length)for await(const r of s)await m({type:t,id:r,content:i})},sendMessage:async e=>{let{type:t="text",content:n="",properties:s,reply_mid:r,...a}=e;r?(Z(),await f({from_uid:i,reply_mid:r,type:t,content:n,properties:s})):await _({id:d,content:n,properties:s,type:t,from_uid:i,...a})},isError:w||N||u,isSending:j||g||h,isSuccess:v||y||x}}},34265:(e,t,i)=>{i.d(t,{Z:()=>d});var n=i(70537),s=i(27418),r=i(12564),a=i(80308),l=i(24783),o=i(66160);const d=e=>{const{context:t,id:i}=e||{context:"channel",id:0},d=(0,o.TL)(),{stageFiles:c,replying:p}=(0,o.CG)((e=>({stageFiles:e.ui.uploadFiles[`${t}_${i}`]||[],replying:e.message.replying[`${t}_${i}`]}))),[f,u]=(0,n.useState)(null),h=(0,n.useRef)(!1),x=(0,n.useRef)(0),m=(0,n.useRef)(1),[g,{isLoading:v}]=(0,l.$_)(),[w,{isLoading:b,isError:j}]=(0,l.Yh)(),y=e=>{const{file_id:t,chunk:i,is_last:n}=e,s=new FormData;return s.append("file_id",t),s.append("chunk_data",i),s.append("chunk_is_last",`${n}`),w(s)};return{stopUploading:()=>{h.current=!0},data:f,isUploading:v||b,progress:+Number(x.current/m.current*100).toFixed(2),uploadFile:async e=>{if(!e)return;u(null);const{name:t=`-${+new Date}.${e.type.split("/")[1]}`,type:i,size:n}=e,r=await g({content_type:i,filename:t});if("error"in r)return void s.ZP.error("Prepare Upload File Error");const l=r.data;let o=null;if(h.current=!1,m.current=1,x.current=0,n<=2e6)o=await y({file_id:l,chunk:e,is_last:!0}),x.current=1;else{m.current=Math.ceil(n/a.Pb);const t=m.current,s=new Array(t);for await(const[n]of s.entries()){if(h.current)break;try{const t=e.slice(a.Pb*n,a.Pb*(n+1),i);o=await y({file_id:l,chunk:t,is_last:n==s.length-1}),x.current++}catch(w){return void(h.current=!0)}}}if(!o||"error"in o)return;const{path:d,size:c,hash:p}=o.data,f=encodeURIComponent(d),v={name:t,file_type:i,path:d,size:c,hash:p,url:`${a.ZP}/resource/file?file_path=${f}`,thumbnail:i.startsWith("image")?`${a.ZP}/resource/file?file_path=${f}&thumbnail=true`:"",download:`${a.ZP}/resource/file?file_path=${f}&download=true`};return u(v),v},isError:j,isSuccess:!!f,stageFiles:c,addStageFile:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p?s.ZP.error("Only text is supported when replying a message"):d((0,r.tD)({context:t,id:i,data:e}))},resetStageFiles:()=>{d((0,r.tD)({context:t,id:i,operation:"reset"}))},removeStageFile:e=>{d((0,r.tD)({context:t,id:i,operation:"remove",index:e}))},updateStageFile:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d((0,r.tD)({context:t,id:i,operation:"update",index:e,...n}))}}}}}]);