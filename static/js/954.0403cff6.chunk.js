"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[954],{24041:(e,t,s)=>{s.d(t,{Z:()=>l});var n,r=s(70537);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},a.apply(this,arguments)}const i=(e,t)=>{let{title:s,titleId:i,...l}=e;return r.createElement("svg",a({width:16,height:16,viewBox:"0 0 16 16",fill:"#6C737F",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":i},l),s?r.createElement("title",{id:i},s):null,n||(n=r.createElement("path",{d:"M8.11904 0C3.91105 0 0.5 3.41105 0.5 7.61905C0.5 11.827 3.91105 15.2381 8.11904 15.2381C12.3271 15.2381 15.7381 11.827 15.7381 7.61905C15.7381 3.41105 12.3263 0 8.11904 0ZM11.7053 10.128L10.628 11.2053L8.11904 8.69714L5.61009 11.2053L4.53277 10.128L7.04095 7.61905L4.532 5.1101L5.60934 4.03353L8.11829 6.54248L10.6272 4.03353L11.7045 5.1101L9.19638 7.61905L11.7053 10.128Z"})))},l=(0,r.forwardRef)(i)},11972:(e,t,s)=>{s.d(t,{Z:()=>l});var n,r=s(70537);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},a.apply(this,arguments)}const i=(e,t)=>{let{title:s,titleId:i,...l}=e;return r.createElement("svg",a({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":i},l),s?r.createElement("title",{id:i},s):null,n||(n=r.createElement("path",{d:"M16.5303 11.7204L16.4462 11.6478C16.1526 11.4299 15.7359 11.4541 15.4697 11.7204L12.7503 14.4397L12.75 7.75003L12.7432 7.64826C12.6935 7.28218 12.3797 7.00003 12 7.00003L11.8982 7.00688C11.5322 7.05654 11.25 7.37033 11.25 7.75003L11.2503 14.4417L8.52961 11.7198L8.4455 11.6472C8.15193 11.4293 7.73527 11.4534 7.46895 11.7196C7.176 12.0124 7.17591 12.4873 7.46875 12.7803L11.4687 16.7818L11.5529 16.8544C11.8465 17.0724 12.2632 17.0482 12.5295 16.7819L16.5303 12.7811L16.6029 12.6969C16.8208 12.4033 16.7966 11.9867 16.5303 11.7204ZM6.25 3C4.45507 3 3 4.45507 3 6.25V17.75C3 19.5449 4.45507 21 6.25 21H17.75C19.5449 21 21 19.5449 21 17.75V6.25C21 4.45507 19.5449 3 17.75 3H6.25ZM4.5 6.25C4.5 5.2835 5.2835 4.5 6.25 4.5H17.75C18.7165 4.5 19.5 5.2835 19.5 6.25V17.75C19.5 18.7165 18.7165 19.5 17.75 19.5H6.25C5.2835 19.5 4.5 18.7165 4.5 17.75V6.25Z",fill:"#fff"})))},l=(0,r.forwardRef)(i)},10189:(e,t,s)=>{s.d(t,{Z:()=>l});var n,r=s(70537);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},a.apply(this,arguments)}const i=(e,t)=>{let{title:s,titleId:i,...l}=e;return r.createElement("svg",a({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":i},l),s?r.createElement("title",{id:i},s):null,n||(n=r.createElement("path",{d:"M14.2958 16.2945C13.9055 16.6853 13.906 17.3184 14.2968 17.7087C14.6876 18.0989 15.3207 18.0985 15.711 17.7077L20.7076 12.7043C21.0976 12.3137 21.0974 11.681 20.7072 11.2906L15.7106 6.29297C15.3201 5.9024 14.6869 5.90234 14.2964 6.29282C13.9058 6.6833 13.9057 7.31647 14.2962 7.70703L17.589 11H11C6.66509 11 3.13546 14.4478 3.00381 18.7508L3 19C3 19.5523 3.44772 20 4 20C4.55228 20 5 19.5523 5 19C5 15.7616 7.56557 13.1224 10.7751 13.0041L11 13H17.586L14.2958 16.2945Z",fill:"#667085"})))},l=(0,r.forwardRef)(i)},79180:(e,t,s)=>{s.d(t,{Z:()=>c});var n=s(70537),r=s(97943),a=s(81721),i=s(18225),l=s(80874),o=s(80683);const c=e=>{let{download:t=!0,data:s,closeModal:c}=e;const[d,u]=(0,n.useState)(null===s||void 0===s?void 0:s.thumbnail),[p,f]=(0,n.useState)(!0),h=(0,n.useRef)(null);if((0,r.O)(h,c),(0,a.z)("Escape",(()=>{c()}),{eventTypes:["keyup"]}),(0,n.useEffect)((()=>{if(s){const{originUrl:e}=s;e||f(!1);const t=new Image;t.src=e,t.onload=()=>{u(e),f(!1)},t.onerror=()=>{f(!1)}}}),[s]),!s)return null;const{originUrl:x,downloadLink:m,name:g,type:v}=s;return(0,o.jsx)(l.Z,{children:(0,o.jsx)("div",{className:"w-screen h-screen flex-center bg-black/90",children:(0,o.jsxs)("div",{className:"relative flex flex-col justify-start gap-3 "+(p?"absolute top-1/3 left-1/2 -translate-x-1/2":""),ref:h,children:[(0,o.jsx)("div",{className:"overflow-auto",children:(0,o.jsx)("img",{className:"max-w-[70vw] max-h-[80vh] "+(p?"blur-sm":""),src:d,alt:"preview"})}),t&&(0,o.jsx)("a",{className:"font-semibold text-sm text-gray-600 hover:underline hover:text-white",download:g,type:v,href:m||x,rel:"noreferrer",children:"Download original"}),p&&(0,o.jsx)("div",{className:"loading",children:(0,o.jsx)(i.Z,{})})]})})})}},7935:(e,t,s)=>{s.d(t,{Z:()=>h});var n=s(24533),r=(s(34376),s(70537)),a=s(24783),i=s(80683);function l(e){let{url:t=""}=e;const[s,n]=(0,r.useState)(""),[l]=(0,a.rf)(),[o,c]=(0,r.useState)(null);(0,r.useEffect)((()=>{(async e=>{var t;let s="";try{s=`${new URL(e).origin}/favicon.ico`}catch{s=`${location.origin}/favicon.ico`}const{data:r}=await l(e),a=(null===r||void 0===r?void 0:r.title)||(null===r||void 0===r?void 0:r.site_name)||"",i=(null===r||void 0===r?void 0:r.description)||"",o=(null===r||void 0===r||null===(t=r.images.find((e=>!!e.url)))||void 0===t?void 0:t.url)||"",d=(null===r||void 0===r?void 0:r.favicon_url)||s;n(d),c({title:a,description:i,ogImage:o})})(t)}),[t]);if(!t||!o||!o.title)return null;const{title:d,description:u,ogImage:p}=o,f="flex items-center border border-solid border-gray-300 box-border rounded-md w-[380px]",h="overflow-hidden whitespace-nowrap text-ellipsis";return p?(0,i.jsxs)("a",{className:`${f} flex-col !items-start p-3`,href:t,target:"_blank",rel:"noreferrer",children:[(0,i.jsx)("h3",{className:`text-base text-primary-500 w-full ${h}`,children:d}),(0,i.jsx)("p",{className:`text-xs text-gray-400 mb-2 w-full ${h}`,children:u}),(0,i.jsx)("div",{className:"w-full h-[180px]",children:(0,i.jsx)("img",{className:"w-full h-full object-cover",src:p,alt:"og image"})})]}):(0,i.jsxs)("a",{className:`${f} gap-2  px-2 py-3`,href:t,target:"_blank",rel:"noreferrer",children:[s&&(0,i.jsx)("div",{className:"flex w-12 h-12 rounded",children:(0,i.jsx)("img",{onError:()=>{n("")},className:"object-contain",src:s,alt:"favicon"})}),(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("h3",{className:"text-sm text-gray-900",children:d}),(0,i.jsx)("p",{className:`text-xs text-gray-500 w-[288px] ${h}`,children:u}),(0,i.jsx)("span",{className:`text-[10px] text-gray-500 w-[288px] ${h}`,children:t})]})]})}var o=s(7829),c=s(57889),d=s(78468),u=s(66160);const p=c.ZP.span`
  padding: 0 2px;
  color: #1fe1f9;
  &.clickable {
    cursor: pointer;
  }
`,f=e=>{let{uid:t,popover:s=!0,cid:n,textOnly:r=!1}=e;const a=(0,u.CG)((e=>e.users.byId))[t];return a?r?(0,i.jsx)(i.Fragment,{children:`@${a.name}`}):s?(0,i.jsx)(o.ZP,{interactive:!0,placement:"top",trigger:"click",content:(0,i.jsx)(d.Z,{uid:t,type:"card",cid:n}),children:(0,i.jsx)(p,{className:"clickable",children:`@${a.name}`})}):(0,i.jsx)(p,{children:`@${a.name}`}):null},h=e=>{let{url:t=!0,mention:s=!0,mentionTextOnly:r=!1,mentionPopOver:a=!0,text:o,cid:c}=e;return(0,i.jsx)(n.Z,{options:{render:{email:e=>{let{content:t,attributes:{href:s}}=e;return r?(0,i.jsx)(i.Fragment,{children:t}):(0,i.jsx)("a",{className:"link",href:s,rel:"noreferrer",children:t})},url:e=>{let{content:s,attributes:{href:n}}=e;return t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("a",{className:"link",target:"_blank",href:n,rel:"noreferrer",children:s}),(0,i.jsx)(l,{url:n})]}):(0,i.jsx)(i.Fragment,{children:s})},mention:e=>{let{content:t}=e;if(!s)return(0,i.jsx)(i.Fragment,{children:t});if(/@[0-9]+/.test(t)){const e=t.trim().slice(1);return(0,i.jsx)(f,{uid:+e,cid:c,popover:a,textOnly:r})}return(0,i.jsx)(i.Fragment,{children:t})}}},children:o})}},84006:(e,t,s)=>{s.d(t,{Z:()=>u});var n=s(70537),r=(s(85012),s(69495),s(55403)),a=s.n(r),i=s(85606),l=s(57889),o=s(79180),c=s(80683);const d=l.ZP.div`
  * {
    user-select: text;
  }
  .toastui-editor-contents {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
  }
`,u=e=>{let{content:t}=e;const s=(0,n.useRef)(null),[r,l]=(0,n.useState)(null);(0,n.useEffect)((()=>{const e=null===s||void 0===s?void 0:s.current;e&&e.addEventListener("click",(e=>{e.stopPropagation();const t=e.target;if(t&&"IMG"==t.nodeName){const e=new URL(t.src),s=`${e.origin}${e.pathname}?file_path=${e.searchParams.get("file_path")}`;l({originUrl:s})}}),!0)}),[]);return(0,c.jsxs)(c.Fragment,{children:[r&&(0,c.jsx)(o.Z,{download:!1,data:r,closeModal:()=>{l(null)}}),(0,c.jsx)(d,{ref:s,children:(0,c.jsx)(i.A,{initialValue:t,plugins:[a()]})})]})}},96954:(e,t,s)=>{s.d(t,{Z:()=>c});var n=s(70537),r=s(17150),a=s(27281),i=s(64631),l=s(11855),o=s(80683);const c=e=>{let{id:t=""}=e;const{favorites:s}=(0,l.Z)({}),[c,d]=(0,n.useState)(null);return(0,n.useEffect)((()=>{const e=s.find((e=>e.id==t)),{messages:n}=e||{};if(!n)return;const l=n.map((e=>{let{from_mid:t}=e;return+t}))||[];d((0,o.jsx)("div",{"data-favorite-mids":l.join(","),className:"favorite flex flex-col rounded-md bg-slate-200",children:(0,o.jsx)("div",{className:"list",children:n.map(((e,t)=>{const{user:s={},download:n,content:l,content_type:c,properties:d,thumbnail:u}=e;return(0,o.jsxs)(r.Z,{className:"archive",children:[s&&(0,o.jsx)("div",{className:"avatar",children:(0,o.jsx)(i.Z,{width:40,height:40,src:s.avatar,name:s.name})}),(0,o.jsxs)("div",{className:"details",children:[(0,o.jsx)("div",{className:"up",children:(0,o.jsx)("span",{className:"name",children:(null===s||void 0===s?void 0:s.name)||"Deleted User"})}),(0,o.jsx)("div",{className:"down",children:(0,a.Z)({download:n,content:l,content_type:c,properties:d,thumbnail:u})})]})]},t)}))})}))}),[s,t]),t?c:null}},27281:(e,t,s)=>{s.d(t,{Z:()=>D});var n=s(7699),r=s.n(n),a=s(18541),i=s(80308),l=s(70537),o=s(57889),c=s(17150),d=s(64631),u=s(10189),p=s(21812),f=s(24783);var h=s(14566),x=s(80683);const m=o.ZP.div`
  display: flex;
  flex-direction: column;
  border-radius: var(--br);
  background-color: #f4f4f5;
  > .tip {
    padding: 8px 8px 0 8px;
    display: flex;
    align-items: center;
    gap: 4px;
    .icon {
      width: 16px;
      height: 16px;
      path {
        fill: #98a2b3;
      }
    }
    font-weight: 400;
    font-size: 12px;
    line-height: 18px;
    color: #98a2b3;
  }
`,g=e=>{let{context:t,to:s,from_uid:n,id:r}=e;const{t:a}=(0,h.$G)(),{normalizeMessage:i,messages:o}=function(){const[e,t]=(0,l.useState)(null),[s,n]=(0,l.useState)(null),[r,{data:a,isError:i,isLoading:o,isSuccess:c}]=(0,f.uv)();return(0,l.useEffect)((()=>{if(a&&c){const t=(0,p.Hr)(a,e);n(t)}}),[a,c,e]),(0,l.useEffect)((()=>{e&&r(e)}),[e]),{normalizeMessage:e=>{t(e)},messages:s,isError:i,isLoading:o,isSuccess:c}}(),[g,v]=(0,l.useState)(null);return(0,l.useEffect)((()=>{r&&i(r)}),[r]),(0,l.useEffect)((()=>{if(o){const e=o.map((e=>{let{from_mid:t}=e;return t}))||[];v((0,x.jsxs)(m,{"data-forwarded-mids":e.join(","),children:[(0,x.jsxs)("h4",{className:"tip",children:[(0,x.jsx)(u.Z,{className:"icon"}),a("action.forward")]}),(0,x.jsx)("div",{className:"list",children:o.map(((e,r)=>{const{user:a={},download:i,content:l,content_type:o,properties:u,thumbnail:p}=e;return(0,x.jsxs)(c.Z,{className:"archive",children:[a&&(0,x.jsx)("div",{className:"avatar",children:(0,x.jsx)(d.Z,{width:24,height:24,src:a.avatar,name:a.name})}),(0,x.jsxs)("div",{className:"details",children:[(0,x.jsx)("div",{className:"up",children:(0,x.jsx)("span",{className:"name",children:(null===a||void 0===a?void 0:a.name)||"Deleted User"})}),(0,x.jsx)("div",{className:"down",children:D({download:i,context:t,to:s,from_uid:n,content:l,content_type:o,properties:u,thumbnail:p})})]})]},r)}))})]}))}}),[o,t,s,n]),r?g:null};var v=s(84006);const w=o.ZP.div`
  background: #f3f4f6;
  border: 1px solid #d4d4d4;
  box-sizing: border-box;
  border-radius: 6px;
  width: 370px;
  height: 66px;
  &.sending {
    opacity: 0.9;
  }
  * {
    user-select: text;
  }
  .basic {
    padding: 8px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    .icon {
      width: 36px;
      height: 48px;
     
    }
    .info {
      display: flex;
      flex-direction: column;
      gap: 4px;
      width: 100%;
      overflow: hidden;
      .name {
        font-weight: 600;
        font-size: 14px;
        line-height: 20px;
        color: #1c1c1e;
        white-space: nowrap;
        text-overflow: ellipsis;
      }
      .details {
        white-space: nowrap;
        font-weight: 400;
        font-size: 12px;
        line-height: 18px;
        color: #616161;
        display: flex;
        gap: 16px;
        .from strong {
          font-weight: bold;
        }
      }
    }
    .download {
      white-space: nowrap;
      svg path{
        fill: #616161;
      }
    }
    .cancel {
      cursor: pointer;
    }
  }
`;var b=s(51091);const j=e=>{let{uploading:t,progress:s,thumbnail:n,download:r,content:a,properties:i}=e;const[o,c]=(0,l.useState)(n),{width:d=0,height:u=0}=(0,p.CW)(i);return(0,l.useEffect)((()=>{const e=n,t=new Image;t.onload=()=>{c(e)},t.onerror=()=>{c("")},t.src=e}),[n]),(0,x.jsxs)("div",{className:"relative w-fit h-fit",children:[t&&(0,x.jsxs)("div",{className:"absolute left-0 top-0 w-full h-full bg-white/40 flex flex-col justify-center items-center gap-1",children:[(0,x.jsx)(b.Z,{size:45,speed:2,color:"#666"}),(0,x.jsxs)("span",{className:"text-xs text-gray-600",children:[s,"%"]})]}),(0,x.jsx)("img",{className:"max-w-[480px] cursor-zoom-in object-cover preview",style:{width:d?`${d}px`:"",height:u?`${u}px`:""},"data-meta":JSON.stringify(i),"data-origin":a,"data-download":r,src:o})]})};var y=s(53517),N=s(1823),_=s(88332),Z=s(66160);var L=s(34265),k=s(62432);const C=e=>{let{value:t,width:s="100%"}=e;return(0,x.jsx)("div",{className:"bg-[#ecfdff] rounded h-2 overflow-hidden",style:{width:s},children:(0,x.jsx)("div",{className:"h-2 bg-[#088ab2] rounded transition-all",style:{width:`${t}%`}})})};var $=s(11972),E=s(24041),S=s(66673),F=s(8969);const z=e=>{let{url:t,name:s,size:n,download:r}=e;const[a,i]=(0,l.useState)(!1),[o,c]=(0,l.useState)(!1),d=(0,p.td)(n),u="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2";return(0,x.jsxs)("div",{className:"w-96 h-52 relative rounded-md border border-solid border-gray-300 overflow-hidden group",children:[(0,x.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-black/40 z-20 group-hover:hidden"}),(0,x.jsxs)("div",{className:"absolute top-0 left-0 w-full flex justify-between z-30 px-3 py-2 overflow-hidden group-hover:bg-black/20",children:[(0,x.jsxs)("div",{className:"flex gap-2 ",children:[(0,x.jsx)(F.Z,{className:"w-9 h-auto"}),(0,x.jsxs)("div",{className:"flex flex-col gap-1 text-sm text-white",children:[(0,x.jsx)("span",{title:s,className:"font-bold whitespace-nowrap text-ellipsis w-[240px] overflow-hidden",children:s}),(0,x.jsx)("span",{children:d})]})]}),(0,x.jsx)("a",{href:r,className:"mt-2",children:(0,x.jsx)($.Z,{className:"fill-white"})})]}),a?o?(0,x.jsx)("span",{className:`${u} text-red-500`,children:"Error"}):null:(0,x.jsx)("div",{className:u,children:(0,x.jsx)(S.Z,{color:"#fff"})}),(0,x.jsx)("video",{onPlay:e=>{const t=e.currentTarget.previousSibling;t&&t.classList.add("hidden")},onError:()=>{i(!1),c(!0)},onCanPlay:()=>{i(!0)},onPause:e=>{const t=e.currentTarget.previousSibling;t&&t.classList.remove("hidden")},controls:a,className:"absolute left-0 top-0 w-full h-full object-cover z-10",children:(0,x.jsx)("source",{src:t,type:"video/mp4"})})]})};var P=s(20814),O=s(57425);const M=e=>{let{url:t,name:s,size:n,download:r}=e;const[a,i]=(0,l.useState)(!1),o=(0,p.td)(n);return(0,x.jsxs)("div",{className:"w-96 flex flex-col gap-2 px-3 py-2 rounded-md border border-solid border-gray-300 overflow-hidden bg-[#f1f3f4]",children:[(0,x.jsxs)("div",{className:"flex justify-between z-30 overflow-hidden",children:[(0,x.jsxs)("div",{className:"flex gap-2 ",children:[(0,x.jsx)(P.Z,{className:"w-9 h-auto"}),(0,x.jsxs)("div",{className:"flex flex-col gap-1 text-sm text-gray-700",children:[(0,x.jsx)("span",{title:s,className:"font-bold whitespace-nowrap text-ellipsis w-[240px] overflow-hidden",children:s}),(0,x.jsx)("span",{children:o})]})]}),(0,x.jsx)("a",{href:r,className:"mt-2",children:(0,x.jsx)($.Z,{className:"download_icon gray"})})]}),(0,x.jsx)("audio",{src:t,onCanPlay:()=>{i(!0)},controls:!0,className:(0,O.Z)("w-full object-cover z-10",a?"":"hidden")})]})},R=e=>e.startsWith("blob:"),U=e=>{let{context:t,to:s,created_at:n,from_uid:a,content:i="",download:o="",thumbnail:c="",properties:d={local_id:0,name:"",size:0,content_type:""}}=e;const[u,f]=(0,l.useState)(null),[h,m]=(0,l.useState)(!1),g=function(e){let{context:t="user",id:s=0}=e;const n=(0,Z.TL)(),r="channel"==t?N.nF:_.Fs;return e=>{n(r({id:s,mid:e})),n((0,y.Gd)(e))}}({context:t,id:s}),{sendMessage:v,isSuccess:b,isSending:S}=(0,k.Z)({context:t,from:a,to:s}),{stopUploading:F,data:P,uploadFile:O,progress:U,isSuccess:T}=(0,L.Z)(),D=(0,Z.CG)((e=>e.users.byId[a])),{size:I=0,name:G,content_type:H}=null!==d&&void 0!==d?d:{};(0,l.useEffect)((()=>{R(i)&&(async e=>{let{url:t,name:s,type:n}=e;try{if(m(!0),n.startsWith("image")){const e=await(0,p.Ad)(t);f(e)}let e=await fetch(t).then((e=>e.blob())).then((e=>new File([e],s,{type:n})));await O(e),m(!1)}catch(r){m(!1)}})({url:i,name:G,type:H})}),[i,G,H]),(0,l.useEffect)((()=>{const e=null!==d&&void 0!==d?d:{},t=u?{...e,...u}:e;if(T&&R(i)){const{path:e}=P;v({ignoreLocal:!0,type:"file",content:{path:e},properties:t})}}),[T,P,d,i]),(0,l.useEffect)((()=>{b&&URL.revokeObjectURL(i)}),[b,i]);if(!d)return null;const A=(0,p.LP)(H,G);if(!i||!G)return null;const V=h||S;return(0,p.Or)(H,I)?(0,x.jsx)(j,{uploading:V,progress:U,properties:{...u,...d},content:i,download:o,thumbnail:c},null===d||void 0===d?void 0:d.local_id):H.startsWith("video")&&!V?(0,x.jsx)(z,{size:I,url:i,name:G,download:o}):H.startsWith("audio")&&!V?(0,x.jsx)(M,{size:I,url:i,name:G,download:o}):(0,x.jsx)(w,{className:"file_message "+(V?"sending":""),children:(0,x.jsxs)("div",{className:"basic",children:[A,(0,x.jsxs)("div",{className:"info",children:[(0,x.jsx)("span",{className:"name",children:G}),(0,x.jsx)("span",{className:"details",children:V?(0,x.jsx)(C,{value:U,width:"80%"}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("i",{className:"size",children:(0,p.td)(I)}),(0,x.jsx)("i",{className:"time",children:r()(n).fromNow()}),D&&(0,x.jsxs)("i",{className:"from",children:["by ",(0,x.jsx)("strong",{children:D.name})]})]})})]}),V?(0,x.jsx)(E.Z,{className:"cancel",onClick:()=>{F(),URL.revokeObjectURL(i),g(d.local_id)}}):(0,x.jsx)("a",{className:"download",download:G,href:`${i}&download=true`,children:(0,x.jsx)($.Z,{})})]})})};var T=s(7935);const D=e=>{let{context:t,to:s=0,from_uid:n=0,created_at:l,properties:o,content_type:c,content:d,download:u,thumbnail:p,edited:f=!1}=e,h=null;switch(c){case i.bT.text:h=(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(T.Z,{text:d,cid:s}),f&&(0,x.jsxs)("span",{className:"edited",title:r()(+f).format("YYYY-MM-DD h:mm:ss A"),children:["(",a.ZP.t("edited",{ns:"chat"}),")"]})]});break;case i.bT.markdown:h=(0,x.jsx)(v.Z,{content:d});break;case i.bT.file:h=(0,x.jsx)(U,{properties:o,context:t,to:s,download:u,thumbnail:p,from_uid:n,created_at:l,content:d});break;case i.bT.archive:h=(0,x.jsx)(g,{properties:o,context:t,to:s,from_uid:n,created_at:l,id:d,thumbnail:p})}return h}},17150:(e,t,s)=>{s.d(t,{Z:()=>n});const n=s(57889).ZP.div`
  position: relative;
  display: flex;
  align-items: flex-start;
  gap: 16px;
  padding: 4px 8px;
  margin: 8px 0;
  border-radius: 8px;
  &[data-highlight="true"] {
    background: #f5f6f7;
  }
  &.auto_delete {
    background: #f1d1ca50;
  }
  &.pinned {
    background: #ecfdff;
  }
  &:hover,
  &.contextVisible,
  &.preview {
    background: #f5f6f7;
    .cmds {
      visibility: visible;
    }
  }
  &.readonly:hover {
    background: none;
  }
  > .avatar {
    flex-shrink: 0;
    cursor: pointer;
    width: 40px;
    height: 40px;
    img {
      object-fit: cover;
      width: 100%;
      height: 100%;
      border-radius: 50%;
    }
  }
  > .details {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 8px;
    .up {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
      .name {
        color: #06b6d4;
        font-style: normal;
        font-size: 14px;
        line-height: 20px;
      }
      .time {
        color: #bfbfbf;
        font-size: 12px;
        line-height: 18px;
      }
    }
    .down {
      user-select: text;
      color: #374151;
      font-weight: normal;
      font-size: 14px;
      line-height: 20px;
      word-break: break-all;
      white-space: pre-wrap;
      .edited {
        margin-left: 5px;
        color: #999;
        font-size: 10px;
      }
      &.sending {
        opacity: 0.9;
      }
      > .link {
        text-decoration: none;
        border-radius: 2px;
        /* background-color: #f5feff; */
        padding: 2px;
        color: #1fe1f9;
      }
      /* 下载图标颜色 */
      .download_icon.gray{
        path{
            fill: #616161;
          }
      }
    }
  }
  &.archive {
    gap: 8px;
    > .details {
      gap: 0;
      .up .name {
        font-weight: 600;
        color: #475467;
      }
      .down {
        color: #475467;
      }
    }
  }
  &.pinned {
    padding-top: 26px;
    > .details {
      position: relative;
      &:before {
        position: absolute;
        left: 0;
        top: -4px;
        transform: translateY(-100%);
        content: attr(data-pin-tip);
        font-weight: 400;
        font-size: 12px;
        line-height: 18px;
        color: #98a2b3;
      }
    }
  }
`},11855:(e,t,s)=>{s.d(t,{Z:()=>i});var n=s(70537),r=s(24783),a=s(66160);function i(e){let{cid:t=null,uid:s=null}=e;const[i]=(0,r.DJ)(),[l]=(0,r.mK)(),[o,c]=(0,n.useState)([]),{favs:d=[]}=(0,a.CG)((e=>({favs:e.favorites})));return(0,n.useEffect)((()=>{let e=[];e=t?d.filter((e=>!!e.messages&&e.messages.every((e=>e.source.gid==t)))):d,e=s?e.filter((e=>!!e.messages&&e.messages.every((e=>e.source.uid==s)))):e,c(e)}),[t,s,d]),{isFavorited:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!e)return!1;let t=[];return o.forEach((e=>{var s;if(1==(null===e||void 0===e||null===(s=e.messages)||void 0===s?void 0:s.length)){const s=e.messages.map((e=>e.from_mid));t=[...t,...s]}})),t.findIndex((t=>t==e))>-1},addFavorite:async e=>{const t=Array.isArray(e)?e.map((e=>+e)):[+e];if(0==t.length)return;return!("error"in await l(t))},removeFavorite:e=>{e&&i(e)},favorites:o}}},62432:(e,t,s)=>{s.d(t,{Z:()=>c});var n=s(27418),r=s(53517),a=s(6144),i=s(52334),l=s(24783),o=s(66160);const c=e=>{const{context:t="user",from:s=0,to:c=0}=e||{},d=(0,o.TL)(),u=(0,o.CG)((e=>e.ui.uploadFiles[`${t}_${c}`]||[])),[p,{isError:f,isLoading:h,isSuccess:x}]=(0,l.qt)(),[m,{isLoading:g,isSuccess:v,isError:w}]=(0,a.R4)(),[b,{isLoading:j,isSuccess:y,isError:N}]=(0,i.bm)(),_="user"==t?b:m,Z=()=>{d((0,r.XS)(`${t}_${c}`))};return{setReplying:e=>{0===u.length?d((0,r.MQ)({mid:e,key:`${t}_${c}`})):n.ZP.error("Only text is supported when replying a message")},removeReplying:Z,sendMessages:async e=>{let{type:t="text",content:s,users:n=[],channels:r=[]}=e;if(n.length)for await(const a of n)await b({type:t,id:a,content:s});if(r.length)for await(const a of r)await m({type:t,id:a,content:s})},sendMessage:async e=>{let{type:t="text",content:n="",properties:r,reply_mid:a,...i}=e;a?(Z(),await p({from_uid:s,reply_mid:a,type:t,content:n,properties:r})):await _({id:c,content:n,properties:r,type:t,from_uid:s,...i})},isError:w||N||f,isSending:j||g||h,isSuccess:v||y||x}}},34265:(e,t,s)=>{s.d(t,{Z:()=>c});var n=s(70537),r=s(27418),a=s(12564),i=s(80308),l=s(24783),o=s(66160);const c=e=>{const{context:t,id:s}=e||{context:"channel",id:0},c=(0,o.TL)(),{stageFiles:d,replying:u}=(0,o.CG)((e=>({stageFiles:e.ui.uploadFiles[`${t}_${s}`]||[],replying:e.message.replying[`${t}_${s}`]}))),[p,f]=(0,n.useState)(null),h=(0,n.useRef)(!1),x=(0,n.useRef)(0),m=(0,n.useRef)(1),[g,{isLoading:v}]=(0,l.$_)(),[w,{isLoading:b,isError:j}]=(0,l.Yh)(),y=e=>{const{file_id:t,chunk:s,is_last:n}=e,r=new FormData;return r.append("file_id",t),r.append("chunk_data",s),r.append("chunk_is_last",`${n}`),w(r)};return{stopUploading:()=>{h.current=!0},data:p,isUploading:v||b,progress:+Number(x.current/m.current*100).toFixed(2),uploadFile:async e=>{if(!e)return;f(null);const{name:t=`-${+new Date}.${e.type.split("/")[1]}`,type:s,size:n}=e,a=await g({content_type:s,filename:t});if("error"in a)return void r.ZP.error("Prepare Upload File Error");const l=a.data;let o=null;if(h.current=!1,m.current=1,x.current=0,n<=2e6)o=await y({file_id:l,chunk:e,is_last:!0}),x.current=1;else{m.current=Math.ceil(n/i.Pb);const t=m.current,r=new Array(t);for await(const[n]of r.entries()){if(h.current)break;try{const t=e.slice(i.Pb*n,i.Pb*(n+1),s);o=await y({file_id:l,chunk:t,is_last:n==r.length-1}),x.current++}catch(w){return void(h.current=!0)}}}if(!o||"error"in o)return;const{path:c,size:d,hash:u}=o.data,p=encodeURIComponent(c),v={name:t,file_type:s,path:c,size:d,hash:u,url:`${i.ZP}/resource/file?file_path=${p}`,thumbnail:s.startsWith("image")?`${i.ZP}/resource/file?file_path=${p}&thumbnail=true`:"",download:`${i.ZP}/resource/file?file_path=${p}&download=true`};return f(v),v},isError:j,isSuccess:!!p,stageFiles:d,addStageFile:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u?r.ZP.error("Only text is supported when replying a message"):c((0,a.tD)({context:t,id:s,data:e}))},resetStageFiles:()=>{c((0,a.tD)({context:t,id:s,operation:"reset"}))},removeStageFile:e=>{c((0,a.tD)({context:t,id:s,operation:"remove",index:e}))},updateStageFile:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c((0,a.tD)({context:t,id:s,operation:"update",index:e,...n}))}}}}}]);