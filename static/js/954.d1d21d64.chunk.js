"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[954],{24041:(e,t,i)=>{i.d(t,{Z:()=>o});var s,n=i(70537);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},a.apply(this,arguments)}const r=(e,t)=>{let{title:i,titleId:r,...o}=e;return n.createElement("svg",a({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},o),i?n.createElement("title",{id:r},i):null,s||(s=n.createElement("path",{d:"M8.11904 0C3.91105 0 0.5 3.41105 0.5 7.61905C0.5 11.827 3.91105 15.2381 8.11904 15.2381C12.3271 15.2381 15.7381 11.827 15.7381 7.61905C15.7381 3.41105 12.3263 0 8.11904 0ZM11.7053 10.128L10.628 11.2053L8.11904 8.69714L5.61009 11.2053L4.53277 10.128L7.04095 7.61905L4.532 5.1101L5.60934 4.03353L8.11829 6.54248L10.6272 4.03353L11.7045 5.1101L9.19638 7.61905L11.7053 10.128Z",fill:"#6C737F"})))},o=(0,n.forwardRef)(r)},11972:(e,t,i)=>{i.d(t,{Z:()=>o});var s,n=i(70537);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},a.apply(this,arguments)}const r=(e,t)=>{let{title:i,titleId:r,...o}=e;return n.createElement("svg",a({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},o),i?n.createElement("title",{id:r},i):null,s||(s=n.createElement("path",{d:"M16.5303 11.7204L16.4462 11.6478C16.1526 11.4299 15.7359 11.4541 15.4697 11.7204L12.7503 14.4397L12.75 7.75003L12.7432 7.64826C12.6935 7.28218 12.3797 7.00003 12 7.00003L11.8982 7.00688C11.5322 7.05654 11.25 7.37033 11.25 7.75003L11.2503 14.4417L8.52961 11.7198L8.4455 11.6472C8.15193 11.4293 7.73527 11.4534 7.46895 11.7196C7.176 12.0124 7.17591 12.4873 7.46875 12.7803L11.4687 16.7818L11.5529 16.8544C11.8465 17.0724 12.2632 17.0482 12.5295 16.7819L16.5303 12.7811L16.6029 12.6969C16.8208 12.4033 16.7966 11.9867 16.5303 11.7204ZM6.25 3C4.45507 3 3 4.45507 3 6.25V17.75C3 19.5449 4.45507 21 6.25 21H17.75C19.5449 21 21 19.5449 21 17.75V6.25C21 4.45507 19.5449 3 17.75 3H6.25ZM4.5 6.25C4.5 5.2835 5.2835 4.5 6.25 4.5H17.75C18.7165 4.5 19.5 5.2835 19.5 6.25V17.75C19.5 18.7165 18.7165 19.5 17.75 19.5H6.25C5.2835 19.5 4.5 18.7165 4.5 17.75V6.25Z",fill:"#fff"})))},o=(0,n.forwardRef)(r)},10189:(e,t,i)=>{i.d(t,{Z:()=>o});var s,n=i(70537);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},a.apply(this,arguments)}const r=(e,t)=>{let{title:i,titleId:r,...o}=e;return n.createElement("svg",a({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},o),i?n.createElement("title",{id:r},i):null,s||(s=n.createElement("path",{d:"M14.2958 16.2945C13.9055 16.6853 13.906 17.3184 14.2968 17.7087C14.6876 18.0989 15.3207 18.0985 15.711 17.7077L20.7076 12.7043C21.0976 12.3137 21.0974 11.681 20.7072 11.2906L15.7106 6.29297C15.3201 5.9024 14.6869 5.90234 14.2964 6.29282C13.9058 6.6833 13.9057 7.31647 14.2962 7.70703L17.589 11H11C6.66509 11 3.13546 14.4478 3.00381 18.7508L3 19C3 19.5523 3.44772 20 4 20C4.55228 20 5 19.5523 5 19C5 15.7616 7.56557 13.1224 10.7751 13.0041L11 13H17.586L14.2958 16.2945Z",fill:"#667085"})))},o=(0,n.forwardRef)(r)},79180:(e,t,i)=>{i.d(t,{Z:()=>f});var s=i(70537),n=i(57889),a=i(97943),r=i(81721),o=i(18225),l=i(80874),d=i(80683);const c=n.F4`
  from {
    background: transparent;
  }
  to {
    background: rgba(1, 1, 1, 0.9);
  }
`,p=n.ZP.div`
  transition: all 0.5s ease;
  width: 100vw;
  height: 100vh;
  animation: ${c} 0.3s ease-in-out forwards;
  display: flex;
  align-items: center;
  justify-content: center;

  .box {
    position: relative;
    transition: all 0.2s ease;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    gap: 10px;

    > .loading {
      position: absolute;
      top: 40%;
      left: 50%;
      transform: translateX(-50%);
    }

    > .image {
      overflow: auto;

      img {
        max-width: 70vw;
        max-height: 80vh;
      }
    }

    &.loading .image img {
      filter: blur(2px);
    }

    .origin {
      font-weight: bold;
      font-size: 14px;
      color: #aaa;

      &:hover {
        text-decoration: underline;
        color: #fff;
      }
    }
  }
`,f=e=>{let{download:t=!0,data:i,closeModal:n}=e;const[c,f]=(0,s.useState)(null===i||void 0===i?void 0:i.thumbnail),[h,u]=(0,s.useState)(!0),x=(0,s.useRef)(null);if((0,a.O)(x,n),(0,r.z)("Escape",(()=>{n()}),{eventTypes:["keyup"]}),(0,s.useEffect)((()=>{if(i){const{originUrl:e}=i;e||u(!1);const t=new Image;t.src=e,t.onload=()=>{f(e),u(!1)},t.onerror=()=>{u(!1)}}}),[i]),!i)return null;const{originUrl:g,downloadLink:m,name:v,type:w}=i;return(0,d.jsx)(l.Z,{children:(0,d.jsx)(p,{children:(0,d.jsxs)("div",{className:"box "+(h?"loading":""),ref:x,children:[(0,d.jsx)("div",{className:"image",children:(0,d.jsx)("img",{src:c,alt:"preview",className:"animate__animated animate__fadeIn animate__faster"})}),t&&(0,d.jsx)("a",{className:"origin",download:v,type:w,href:m||g,rel:"noreferrer",children:"Download original"}),h&&(0,d.jsx)("div",{className:"loading",children:(0,d.jsx)(o.Z,{})})]})})})}},84006:(e,t,i)=>{i.d(t,{Z:()=>p});var s=i(70537),n=(i(85012),i(69495),i(55403)),a=i.n(n),r=i(85606),o=i(57889),l=i(79180),d=i(80683);const c=o.ZP.div`
  * {
    user-select: text;
  }
  .toastui-editor-contents {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
  }
`,p=e=>{let{content:t}=e;const i=(0,s.useRef)(null),[n,o]=(0,s.useState)(null);(0,s.useEffect)((()=>{const e=null===i||void 0===i?void 0:i.current;e&&e.addEventListener("click",(e=>{e.stopPropagation();const t=e.target;if(t&&"IMG"==t.nodeName){const e=new URL(t.src),i=`${e.origin}${e.pathname}?file_path=${e.searchParams.get("file_path")}`;o({originUrl:i})}}),!0)}),[]);return(0,d.jsxs)(d.Fragment,{children:[n&&(0,d.jsx)(l.Z,{download:!1,data:n,closeModal:()=>{o(null)}}),(0,d.jsx)(c,{ref:i,children:(0,d.jsx)(r.A,{initialValue:t,plugins:[a()]})})]})}},96954:(e,t,i)=>{i.d(t,{Z:()=>p});var s=i(70537),n=i(57889),a=i(17150),r=i(65581),o=i(64631),l=i(11855),d=i(80683);const c=n.ZP.div`
  display: flex;
  flex-direction: column;
  border-radius: var(--br);
  background-color: #f4f4f5;
`,p=e=>{let{id:t=""}=e;const{favorites:i}=(0,l.Z)({}),[n,p]=(0,s.useState)(null);return(0,s.useEffect)((()=>{const e=i.find((e=>e.id==t)),{messages:s}=e||{};if(!s)return;const n=s.map((e=>{let{from_mid:t}=e;return+t}))||[];p((0,d.jsx)(c,{"data-favorite-mids":n.join(","),className:"favorite",children:(0,d.jsx)("div",{className:"list",children:s.map(((e,t)=>{const{user:i={},download:s,content:n,content_type:l,properties:c,thumbnail:p}=e;return(0,d.jsxs)(a.Z,{className:"archive",children:[i&&(0,d.jsx)("div",{className:"avatar",children:(0,d.jsx)(o.Z,{url:i.avatar,name:i.name})}),(0,d.jsxs)("div",{className:"details",children:[(0,d.jsx)("div",{className:"up",children:(0,d.jsx)("span",{className:"name",children:(null===i||void 0===i?void 0:i.name)||"Deleted User"})}),(0,d.jsx)("div",{className:"down",children:(0,r.Z)({download:s,content:n,content_type:l,properties:c,thumbnail:p})})]})]},t)}))})}))}),[i,t]),t?n:null}},34115:(e,t,i)=>{i.d(t,{Z:()=>d});var s=i(7829),n=i(57889),a=i(71044),r=i(66160),o=i(80683);const l=n.ZP.span`
  padding: 0 2px;
  color: #1fe1f9;
  &.clickable {
    cursor: pointer;
  }
`,d=e=>{let{uid:t,popover:i=!0,cid:n,textOnly:d=!1}=e;const c=(0,r.CG)((e=>e.users.byId))[t];return c?d?`@${c.name}`:(0,o.jsx)(s.ZP,{disabled:!i,interactive:!0,placement:"top",trigger:"click",content:(0,o.jsx)(a.Z,{uid:t,type:"card",cid:n}),children:(0,o.jsx)(l,{className:i?"clickable":"",children:`@${c.name}`})}):null}},65581:(e,t,i)=>{i.d(t,{Z:()=>A});var s=i(70537),n=i(61241),a=i(7699),r=i.n(a),o=i(96919),l=i.n(o),d=i(80308),c=i(34115),p=i(57889),f=i(17150),h=i(64631),u=i(10189),x=i(21812),g=i(24783);var m=i(71893),v=i(80683);const w=p.ZP.div`
  display: flex;
  flex-direction: column;
  border-radius: var(--br);
  background-color: #f4f4f5;
  > .tip {
    padding: 8px 8px 0 8px;
    display: flex;
    align-items: center;
    gap: 4px;
    .icon {
      width: 16px;
      height: 16px;
      path {
        fill: #98a2b3;
      }
    }
    font-weight: 400;
    font-size: 12px;
    line-height: 18px;
    color: #98a2b3;
  }
`,b=e=>{let{context:t,to:i,from_uid:n,id:a}=e;const{t:r}=(0,m.$)(),{normalizeMessage:o,messages:l}=function(){const[e,t]=(0,s.useState)(null),[i,n]=(0,s.useState)(null),[a,{data:r,isError:o,isLoading:l,isSuccess:d}]=(0,g.uv)();return(0,s.useEffect)((()=>{if(r&&d){const t=(0,x.Hr)(r,e);n(t)}}),[r,d,e]),(0,s.useEffect)((()=>{e&&a(e)}),[e]),{normalizeMessage:e=>{t(e)},messages:i,isError:o,isLoading:l,isSuccess:d}}(),[d,c]=(0,s.useState)(null);return(0,s.useEffect)((()=>{a&&o(a)}),[a]),(0,s.useEffect)((()=>{if(l){const e=l.map((e=>{let{from_mid:t}=e;return t}))||[];c((0,v.jsxs)(w,{"data-forwarded-mids":e.join(","),children:[(0,v.jsxs)("h4",{className:"tip",children:[(0,v.jsx)(u.Z,{className:"icon"}),r("action.forward")]}),(0,v.jsx)("div",{className:"list",children:l.map(((e,s)=>{const{user:a={},download:r,content:o,content_type:l,properties:d,thumbnail:c}=e;return(0,v.jsxs)(f.Z,{className:"archive",children:[a&&(0,v.jsx)("div",{className:"avatar",children:(0,v.jsx)(h.Z,{url:a.avatar,name:a.name})}),(0,v.jsxs)("div",{className:"details",children:[(0,v.jsx)("div",{className:"up",children:(0,v.jsx)("span",{className:"name",children:(null===a||void 0===a?void 0:a.name)||"Deleted User"})}),(0,v.jsx)("div",{className:"down",children:A({download:r,context:t,to:i,from_uid:n,content:o,content_type:l,properties:d,thumbnail:c})})]})]},s)}))})]}))}}),[l,t,i,n]),a?d:null};var j=i(84006);const y=p.ZP.div`
  background: #f3f4f6;
  border: 1px solid #d4d4d4;
  box-sizing: border-box;
  border-radius: 6px;
  width: 370px;
  height: 66px;
  &.sending {
    opacity: 0.9;
  }
  * {
    user-select: text;
  }
  .basic {
    padding: 8px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    .icon {
      width: 36px;
      height: 48px;
     
    }
    .info {
      display: flex;
      flex-direction: column;
      gap: 4px;
      width: 100%;
      overflow: hidden;
      .name {
        font-weight: 600;
        font-size: 14px;
        line-height: 20px;
        color: #1c1c1e;
        white-space: nowrap;
        text-overflow: ellipsis;
      }
      .details {
        white-space: nowrap;
        font-weight: 400;
        font-size: 12px;
        line-height: 18px;
        color: #616161;
        display: flex;
        gap: 16px;
        .from strong {
          font-weight: bold;
        }
      }
    }
    .download {
      white-space: nowrap;
      svg path{
        fill: #616161;
      }
    }
    .cancel {
      cursor: pointer;
    }
  }
`;var N=i(92443);i(51388);const _=p.ZP.div`
  position: relative;
  width: fit-content;
  height: fit-content;
  > img {
    max-width: 480px;
    cursor: zoom-in;
    object-fit: cover;
  }
  .overlay {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.4);
    display: flex;
    justify-content: center;
    align-items: center;
    .progress {
      width: 15px;
      height: 15px;
      .CircularProgressbar-path {
        stroke: #444;
      }
    }
  }
`,Z=e=>{let{uploading:t,progress:i,thumbnail:n,download:a,content:r,properties:o}=e;const[l,d]=(0,s.useState)(n),{width:c=0,height:p=0}=(0,x.CW)(o);return(0,s.useEffect)((()=>{const e=n,t=new Image;t.onload=()=>{d(e)},t.onerror=()=>{d("")},t.src=e}),[n]),(0,v.jsxs)(_,{children:[t&&(0,v.jsx)("div",{className:"overlay",children:(0,v.jsx)("div",{className:"progress",children:(0,v.jsx)(N.Ip,{value:i,strokeWidth:50,styles:(0,N.y3)({strokeLinecap:"butt"})})})}),(0,v.jsx)("img",{className:"img preview",style:{width:c?`${c}px`:"",height:p?`${p}px`:""},"data-meta":JSON.stringify(o),"data-origin":r,"data-download":a,src:l})]})};var k=i(53517),L=i(1823),C=i(88332),z=i(66160);var E=i(34265),S=i(62432);const $=p.ZP.div`
  background: #ecfdff;
  border-radius: 4px;
  height: 8px;
  overflow: hidden;
  .progress {
    transition: all 0.25s ease;
    height: 8px;
    background: #088ab2;
    border-radius: 4px;
  }
`,P=e=>{let{value:t,width:i="100%"}=e;return(0,v.jsx)($,{style:{width:i},children:(0,v.jsx)("div",{className:"progress",style:{width:`${t}%`}})})};var F=i(11972),O=i(24041),M=i(8969);const R=e=>{let{url:t,name:i,size:n,download:a}=e;const[r,o]=(0,s.useState)(!1),l=(0,x.td)(n);return(0,v.jsxs)("div",{className:"w-96 h-52 relative rounded-md border border-solid border-gray-300 overflow-hidden group",children:[!r&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-black/40 z-20 group-hover:hidden"}),(0,v.jsxs)("div",{className:"absolute top-0 left-0 w-full flex justify-between z-30 px-3 py-2 overflow-hidden group-hover:bg-black/20",children:[(0,v.jsxs)("div",{className:"flex gap-2 ",children:[(0,v.jsx)(M.Z,{className:"w-9 h-auto"}),(0,v.jsxs)("div",{className:"flex flex-col gap-1 text-sm text-white",children:[(0,v.jsx)("span",{title:i,className:"font-bold whitespace-nowrap text-ellipsis w-[240px] overflow-hidden",children:i}),(0,v.jsx)("span",{children:l})]})]}),(0,v.jsx)("a",{href:a,className:"mt-2",children:(0,v.jsx)(F.Z,{className:"fill-white"})})]})]}),(0,v.jsx)("video",{onPlaying:()=>{o(!0)},onPause:()=>{o(!1)},src:t,controls:!0,className:"absolute left-0 top-0 w-full h-full object-cover z-10"})]})};var U=i(20814);const I=e=>{let{url:t,name:i,size:s,download:n}=e;const a=(0,x.td)(s);return(0,v.jsxs)("div",{className:"w-96 flex flex-col gap-2 px-3 py-2 rounded-md border border-solid border-gray-300 overflow-hidden bg-[#f1f3f4]",children:[(0,v.jsxs)("div",{className:"flex justify-between z-30 overflow-hidden",children:[(0,v.jsxs)("div",{className:"flex gap-2 ",children:[(0,v.jsx)(U.Z,{className:"w-9 h-auto"}),(0,v.jsxs)("div",{className:"flex flex-col gap-1 text-sm text-gray-700",children:[(0,v.jsx)("span",{title:i,className:"font-bold whitespace-nowrap text-ellipsis w-[240px] overflow-hidden",children:i}),(0,v.jsx)("span",{children:a})]})]}),(0,v.jsx)("a",{href:n,className:"mt-2",children:(0,v.jsx)(F.Z,{className:"download_icon gray"})})]}),(0,v.jsx)("audio",{src:t,controls:!0,className:"w-full object-cover z-10"})]})},D=e=>e.startsWith("blob:"),T=e=>{let{context:t,to:i,created_at:n,from_uid:a,content:o="",download:l="",thumbnail:d="",properties:c={local_id:0,name:"",size:0,content_type:""}}=e;const[p,f]=(0,s.useState)(null),[h,u]=(0,s.useState)(!1),g=function(e){let{context:t="user",id:i=0}=e;const s=(0,z.TL)(),n="channel"==t?L.nF:C.Fs;return e=>{s(n({id:i,mid:e})),s((0,k.Gd)(e))}}({context:t,id:i}),{sendMessage:m,isSuccess:w,isSending:b}=(0,S.Z)({context:t,from:a,to:i}),{stopUploading:j,data:N,uploadFile:_,progress:$,isSuccess:M}=(0,E.Z)(),U=(0,z.CG)((e=>e.users.byId[a])),{size:T=0,name:W,content_type:G}=null!==c&&void 0!==c?c:{};(0,s.useEffect)((()=>{D(o)&&(async e=>{let{url:t,name:i,type:s}=e;try{if(u(!0),s.startsWith("image")){const e=await(0,x.Ad)(t);f(e)}let e=await fetch(t).then((e=>e.blob())).then((e=>new File([e],i,{type:s})));await _(e),u(!1)}catch(n){u(!1)}})({url:o,name:W,type:G})}),[o,W,G]),(0,s.useEffect)((()=>{const e=null!==c&&void 0!==c?c:{},t=p?{...e,...p}:e;if(M&&D(o)){const{path:e}=N;m({ignoreLocal:!0,type:"file",content:{path:e},properties:t})}}),[M,N,c,o]),(0,s.useEffect)((()=>{w&&URL.revokeObjectURL(o)}),[w,o]);if(!c)return null;const H=(0,x.LP)(G,W);if(!o||!W)return null;const A=h||b;return(0,x.Or)(G,T)?(0,v.jsx)(Z,{uploading:A,progress:$,properties:{...p,...c},content:o,download:l,thumbnail:d},null===c||void 0===c?void 0:c.local_id):G.startsWith("video")&&!A?(0,v.jsx)(R,{size:T,url:o,name:W,download:l}):G.startsWith("audio")&&!A?(0,v.jsx)(I,{size:T,url:o,name:W,download:l}):(0,v.jsx)(y,{className:"file_message "+(A?"sending":""),children:(0,v.jsxs)("div",{className:"basic",children:[H,(0,v.jsxs)("div",{className:"info",children:[(0,v.jsx)("span",{className:"name",children:W}),(0,v.jsx)("span",{className:"details",children:A?(0,v.jsx)(P,{value:$,width:"80%"}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("i",{className:"size",children:(0,x.td)(T)}),(0,v.jsx)("i",{className:"time",children:r()(n).fromNow()}),U&&(0,v.jsxs)("i",{className:"from",children:["by ",(0,v.jsx)("strong",{children:U.name})]})]})})]}),A?(0,v.jsx)(O.Z,{className:"cancel",onClick:()=>{j(),URL.revokeObjectURL(o),g(c.local_id)}}):(0,v.jsx)("a",{className:"download",download:W,href:`${o}&download=true`,children:(0,v.jsx)(F.Z,{})})]})})},W=p.ZP.a`
  background: #f3f4f6;
  border: 1px solid #d4d4d4;
  box-sizing: border-box;
  border-radius: 6px;
  padding: 12px 8px;
  display: flex;
  align-items: center;
  gap: 8px;
  width: 380px;
  .favicon {
    display: flex;
    width: 48px;
    height: 48px;
    border-radius: 4px;
    img {
      object-fit: contain;
    }
  }
  .info {
    display: flex;
    flex-direction: column;
    .title {
      font-style: normal;
      font-weight: 600;
      font-size: 14px;
      line-height: 20px;
      color: #1c1c1e;
    }
    .desc {
      font-weight: 500;
      font-size: 12px;
      line-height: 18px;
      color: #616161;
    }
    .link {
      font-weight: 400;
      font-size: 10px;
      line-height: 18px;
      color: #616161;
    }
    .dots {
      width: 288px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }
`,G=p.ZP.a`
  width: 380px;
  padding: 12px;
  background: #f3f4f6;
  border: 1px solid #d4d4d4;
  box-sizing: border-box;
  border-radius: 6px;
  display: flex;
  flex-direction: column;
  .title {
    font-weight: 600;
    font-size: 16px;
    line-height: 24px;
    color: #06aed4;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .desc {
    font-weight: 400;
    font-size: 12px;
    line-height: 18px;
    color: #616161;
    margin-bottom: 8px;
    width: 356px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .image {
    width: 100%;
    height: 180px;
    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  }
`;function H(e){let{url:t=""}=e;const[i,n]=(0,s.useState)(""),[a]=(0,g.rf)(),[r,o]=(0,s.useState)(null);(0,s.useEffect)((()=>{(async e=>{var t;const{data:i}=await a(e),s=(null===i||void 0===i?void 0:i.title)||(null===i||void 0===i?void 0:i.site_name)||"",r=(null===i||void 0===i?void 0:i.description)||"",l=(null===i||void 0===i||null===(t=i.images.find((e=>!!e.url)))||void 0===t?void 0:t.url)||"",d=(null===i||void 0===i?void 0:i.favicon_url)||`${new URL(e).origin}/favicon.ico`;n(d),o({title:s,description:r,ogImage:l})})(t)}),[t]);if(!t||!r||!r.title)return null;const{title:l,description:d,ogImage:c}=r;return c?(0,v.jsxs)(G,{href:t,target:"_blank",children:[(0,v.jsx)("h3",{className:"title",children:l}),(0,v.jsx)("p",{className:"desc dots",children:d}),(0,v.jsx)("div",{className:"image",children:(0,v.jsx)("img",{src:c,alt:"og image"})})]}):(0,v.jsxs)(W,{href:t,target:"_blank",children:[i&&(0,v.jsx)("div",{className:"favicon",children:(0,v.jsx)("img",{onError:()=>{n("")},src:i,alt:"favicon"})}),(0,v.jsxs)("div",{className:"info",children:[(0,v.jsx)("h3",{className:"title",children:l}),(0,v.jsx)("p",{className:"desc dots",children:d}),(0,v.jsx)("span",{className:"link dots",children:t})]})]})}const A=e=>{let{context:t,to:i=0,from_uid:a=0,created_at:o,properties:p,content_type:f,content:h,download:u,thumbnail:x,edited:g=!1}=e,m=null;switch(f){case d.bT.text:m=(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(n.Z,{componentDecorator:(e,t,i)=>(0,v.jsxs)(s.Fragment,{children:[(0,v.jsx)("a",{className:"link",target:"_blank",href:e,rel:"noreferrer",children:t},i),!e.startsWith("mailto")&&(0,v.jsx)(H,{url:e})]},i),children:l()(h,/(\s{1}@[0-9]+\s{1})/g,((e,t)=>{const s=e.trim().slice(1);return(0,v.jsx)(c.Z,{uid:+s,cid:i},t)}))}),g&&(0,v.jsx)("span",{className:"edited",title:r()(+g).format("YYYY-MM-DD h:mm:ss A"),children:"(edited)"})]});break;case d.bT.markdown:m=(0,v.jsx)(j.Z,{content:h});break;case d.bT.file:m=(0,v.jsx)(T,{properties:p,context:t,to:i,download:u,thumbnail:x,from_uid:a,created_at:o,content:h});break;case d.bT.archive:m=(0,v.jsx)(b,{properties:p,context:t,to:i,from_uid:a,created_at:o,id:h,thumbnail:x})}return m}},17150:(e,t,i)=>{i.d(t,{Z:()=>s});const s=i(57889).ZP.div`
  position: relative;
  display: flex;
  align-items: flex-start;
  gap: 16px;
  padding: 4px 8px;
  margin: 8px 0;
  border-radius: 8px;
  &[data-highlight="true"] {
    background: #f5f6f7;
  }
  &.pinned {
    background: #ecfdff;
  }
  &:hover,
  &.contextVisible,
  &.preview {
    background: #f5f6f7;
    .cmds {
      visibility: visible;
    }
  }
  &.readonly:hover {
    background: none;
  }
  > .avatar {
    flex-shrink: 0;
    cursor: pointer;
    width: 40px;
    height: 40px;
    img {
      object-fit: cover;
      width: 100%;
      height: 100%;
      border-radius: 50%;
    }
  }
  > .details {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 8px;
    .up {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
      .name {
        color: #06b6d4;
        font-style: normal;
        font-size: 14px;
        line-height: 20px;
      }
      .time {
        color: #bfbfbf;
        font-size: 12px;
        line-height: 18px;
      }
    }
    .down {
      user-select: text;
      color: #374151;
      font-weight: normal;
      font-size: 14px;
      line-height: 20px;
      word-break: break-all;
      white-space: pre-wrap;
      .edited {
        margin-left: 5px;
        color: #999;
        font-size: 10px;
      }
      &.sending {
        opacity: 0.9;
      }
      > .link {
        text-decoration: none;
        border-radius: 2px;
        /* background-color: #f5feff; */
        padding: 2px;
        color: #1fe1f9;
      }
      /* 下载图标颜色 */
      .download_icon.gray{
        path{
            fill: #616161;
          }
      }
    }
  }
  &.archive {
    gap: 8px;
    .avatar {
      width: 24px;
      height: 24px;
    }
    > .details {
      gap: 0;
      .up .name {
        font-weight: 600;
        color: #475467;
      }
      .down {
        color: #475467;
      }
    }
  }
  &.pinned {
    padding-top: 26px;
    > .details {
      position: relative;
      &:before {
        position: absolute;
        left: 0;
        top: -4px;
        transform: translateY(-100%);
        content: attr(data-pin-tip);
        font-weight: 400;
        font-size: 12px;
        line-height: 18px;
        color: #98a2b3;
      }
    }
  }
`},11855:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(70537),n=i(24783),a=i(66160);function r(e){let{cid:t=null,uid:i=null}=e;const[r]=(0,n.DJ)(),[o]=(0,n.mK)(),[l,d]=(0,s.useState)([]),{favs:c=[]}=(0,a.CG)((e=>({favs:e.favorites})));return(0,s.useEffect)((()=>{let e=[];e=t?c.filter((e=>!!e.messages&&e.messages.every((e=>e.source.gid==t)))):c,e=i?e.filter((e=>!!e.messages&&e.messages.every((e=>e.source.uid==i)))):e,d(e)}),[t,i,c]),{isFavorited:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!e)return!1;let t=[];return l.forEach((e=>{var i;if(1==(null===e||void 0===e||null===(i=e.messages)||void 0===i?void 0:i.length)){const i=e.messages.map((e=>e.from_mid));t=[...t,...i]}})),t.findIndex((t=>t==e))>-1},addFavorite:async e=>{const t=Array.isArray(e)?e.map((e=>+e)):[+e];if(0==t.length)return;return!("error"in await o(t))},removeFavorite:e=>{e&&r(e)},favorites:l}}},62432:(e,t,i)=>{i.d(t,{Z:()=>d});var s=i(27418),n=i(53517),a=i(6144),r=i(52334),o=i(24783),l=i(66160);const d=e=>{const{context:t="user",from:i=0,to:d=0}=e||{},c=(0,l.TL)(),p=(0,l.CG)((e=>e.ui.uploadFiles[`${t}_${d}`]||[])),[f,{isError:h,isLoading:u,isSuccess:x}]=(0,o.qt)(),[g,{isLoading:m,isSuccess:v,isError:w}]=(0,a.R4)(),[b,{isLoading:j,isSuccess:y,isError:N}]=(0,r.bm)(),_="user"==t?b:g,Z=()=>{c((0,n.XS)(`${t}_${d}`))};return{setReplying:e=>{0===p.length?c((0,n.MQ)({mid:e,key:`${t}_${d}`})):s.ZP.error("Only text is supported when replying a message")},removeReplying:Z,sendMessages:async e=>{let{type:t="text",content:i,users:s=[],channels:n=[]}=e;if(s.length)for await(const a of s)await b({type:t,id:a,content:i});if(n.length)for await(const a of n)await g({type:t,id:a,content:i})},sendMessage:async e=>{let{type:t="text",content:s="",properties:n,reply_mid:a,...r}=e;a?(Z(),await f({from_uid:i,reply_mid:a,type:t,content:s,properties:n})):await _({id:d,content:s,properties:n,type:t,from_uid:i,...r})},isError:w||N||h,isSending:j||m||u,isSuccess:v||y||x}}},34265:(e,t,i)=>{i.d(t,{Z:()=>d});var s=i(70537),n=i(27418),a=i(12564),r=i(80308),o=i(24783),l=i(66160);const d=e=>{const{context:t,id:i}=e||{context:"channel",id:0},d=(0,l.TL)(),{stageFiles:c,replying:p}=(0,l.CG)((e=>({stageFiles:e.ui.uploadFiles[`${t}_${i}`]||[],replying:e.message.replying[`${t}_${i}`]}))),[f,h]=(0,s.useState)(null),u=(0,s.useRef)(!1),x=(0,s.useRef)(0),g=(0,s.useRef)(1),[m,{isLoading:v}]=(0,o.$_)(),[w,{isLoading:b,isError:j}]=(0,o.Yh)(),y=e=>{const{file_id:t,chunk:i,is_last:s}=e,n=new FormData;return n.append("file_id",t),n.append("chunk_data",i),n.append("chunk_is_last",`${s}`),w(n)};return{stopUploading:()=>{u.current=!0},data:f,isUploading:v||b,progress:+Number(x.current/g.current*100).toFixed(2),uploadFile:async e=>{if(!e)return;h(null);const{name:t=`-${+new Date}.${e.type.split("/")[1]}`,type:i,size:s}=e,a=await m({content_type:i,filename:t});if("error"in a)return void n.ZP.error("Prepare Upload File Error");const o=a.data;let l=null;if(u.current=!1,g.current=1,x.current=0,s<=2e6)l=await y({file_id:o,chunk:e,is_last:!0}),x.current=1;else{g.current=Math.ceil(s/r.Pb);const t=g.current,n=new Array(t);for await(const[s]of n.entries()){if(u.current)break;try{const t=e.slice(r.Pb*s,r.Pb*(s+1),i);l=await y({file_id:o,chunk:t,is_last:s==n.length-1}),x.current++}catch(w){return}}}if(!l||"error"in l)return;const{path:d,size:c,hash:p}=l.data,f=encodeURIComponent(d),v={name:t,file_type:i,path:d,size:c,hash:p,url:`${r.ZP}/resource/file?file_path=${f}`,thumbnail:i.startsWith("image")?`${r.ZP}/resource/file?file_path=${f}&thumbnail=true`:"",download:`${r.ZP}/resource/file?file_path=${f}&download=true`};return h(v),v},isError:j,isSuccess:!!f,stageFiles:c,addStageFile:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p?n.ZP.error("Only text is supported when replying a message"):d((0,a.tD)({context:t,id:i,data:e}))},resetStageFiles:()=>{d((0,a.tD)({context:t,id:i,operation:"reset"}))},removeStageFile:e=>{d((0,a.tD)({context:t,id:i,operation:"remove",index:e}))},updateStageFile:function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d((0,a.tD)({context:t,id:i,operation:"update",index:e,...s}))}}}}}]);