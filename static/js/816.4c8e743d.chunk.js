"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[816,625],{52816:(e,a,t)=>{t.r(a),t.d(a,{default:()=>_});var s=t(70537),n=t(27418),r=t(14566),o=t(3074),l=t(64084),c=t(15924),i=t(80308),d=t(15312),m=t(65809),x=t(21645),u=t(66160),h=t(51285),g=t(4472),p=t(99487),f=t(26602),w=t(67093),v=t(80683);function j(){return(0,v.jsxs)("div",{className:"flex flex-col items-center",children:[(0,v.jsx)("div",{className:"font-bold text-3xl text-gray-800 dark:text-white mt-3",children:"Magic link Sent"}),(0,v.jsx)("p",{className:"text-center text-gray-400 dark:text-gray-300 mb-6",children:"Login to your email client, and continue next step"}),(0,v.jsx)("p",{className:"text-center text-gray-400 dark:text-gray-300",children:"You can close this window now."})]})}var y=t(60625),k=t(22421);function _(){let[e]=(0,l.lr)(new URLSearchParams(location.search));const a=e.get("ctx"),t=(0,u.CG)((e=>e.server.name)),{t:_}=(0,r.$G)("auth"),{t:N}=(0,r.$G)(),[b,{isLoading:P,data:S,isSuccess:L}]=(0,d.uk)(),Z=(0,o.I0)(),{token:C}=(0,y.useMagicToken)(),[$,{isLoading:E,data:q,isSuccess:G}]=(0,d.l4)(),[R,{isLoading:I}]=(0,d.N0)(),{data:M,isSuccess:O}=(0,m.ww)(),T=(0,c.s0)(),[U,z]=(0,s.useState)({name:"",email:"",password:"",confirmPassword:""});C&&localStorage.setItem(i.LJ,C),(0,s.useEffect)((()=>{"web"!==a&&(0,f.tq)()&&C&&T(`/invite_mobile/${C}`)}),[a,C]),(0,s.useEffect)((()=>{if(L&&S){const{new_magic_token:e,mail_is_sent:a}=S;!a&&e&&T(`/register/set_name?magic_token=${e}`)}}),[L,S]),(0,s.useEffect)((()=>{G&&q&&(n.ZP.success(N("tip.reg")),Z((0,x.A3)(q)),location.href="/#/")}),[G,q]);const A=e=>{const{type:a}=e.target.dataset,{value:t}=e.target;z((e=>(e[a]=t,{...e})))};if(!O)return null;const{who_can_sign_up:B}=M;if("EveryOne"!==B&&!C)return(0,v.jsx)("span",{className:"dark:text-white",children:"Sign up method is updated to Invitation Link Only"});const{name:D,email:F,password:J,confirmPassword:Y}=U;if(null!==S&&void 0!==S&&S.mail_is_sent)return(0,v.jsx)(j,{});const H=E||P||I;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"flex-center flex-col pb-6",children:[(0,v.jsx)("img",{src:`${i.ZP}/resource/organization/logo`,alt:"logo",className:"w-14 h-14 md:mb-7 rounded-full"}),(0,v.jsx)("h2",{className:"font-semibold text-2xl text-gray-800 dark:text-white",children:_("reg.title",{name:t})})]}),(0,v.jsxs)("form",{className:"flex flex-col gap-5 w-80 md:min-w-[360px]",onSubmit:async e=>{e.preventDefault();const{name:a,email:t,password:s,confirmPassword:r}=U;if(s!==r)return void n.ZP.error("Not Same Password!");const{data:o}=await R(t);o?C?b({magic_token:C,email:t,password:s}):$({name:a,email:t,password:s}):n.ZP.error("Email already registered!")},autoSave:"false",autoComplete:"true",children:[!C&&(0,v.jsx)(p.Z,{className:"large",name:"name",value:D,required:!0,type:"name",placeholder:_("placeholder_name"),"data-type":"name",onChange:A}),(0,v.jsx)(p.Z,{className:"large",name:"email",value:F,required:!0,type:"email",placeholder:_("placeholder_email"),"data-type":"email",onChange:A}),(0,v.jsx)(p.Z,{className:"large",type:"password",value:J,name:"password",required:!0,minLength:6,"data-type":"password",onChange:A,placeholder:_("placeholder_pwd")}),(0,v.jsx)(p.Z,{className:"large",required:!0,onBlur:()=>{const{password:e,confirmPassword:a}=U;e!==a&&n.ZP.error("Not Same Password!")},type:"password",minLength:6,name:"confirmPassword",value:Y,"data-type":"confirmPassword",onChange:A,placeholder:_("placeholder_confirm_pwd")}),(0,v.jsx)(g.Z,{type:"submit",disabled:H,children:_(H?"signing_up":"sign_up")})]}),(0,v.jsx)(h.Z,{content:"OR"}),(0,v.jsx)("div",{className:"socials flex flex-col gap-3 py-3 empty:hidden",children:(0,v.jsx)(w.Z,{type:"register"})}),(0,v.jsx)(k.Z,{token:C})]})}},22421:(e,a,t)=>{t.d(a,{Z:()=>c});var s=t(70537),n=t(14566),r=t(64084),o=t(26602),l=t(80683);function c(e){var a;let{token:t}=e;const{t:c}=(0,n.$G)("auth");let[i]=(0,r.lr)(new URLSearchParams(location.search));const d=null!==(a=i.get("ctx"))&&void 0!==a?a:"app";return(0,s.useEffect)((()=>{(0,o.tq)()&&t&&"app"==d&&(location.href=`https://join.voce.chat/download?link=${encodeURIComponent(`${location.origin}?magic_token=${t}`)}`)}),[t,d]),(0,l.jsxs)("div",{className:"flex gap-1 mt-7 text-sm text-slate-500 dark:text-gray-100 justify-center",children:[(0,l.jsx)("span",{children:c("reg.have_account")}),(0,l.jsx)(r.OL,{to:"/login",className:"text-primary-400 cursor-pointer",children:c("sign_in")})]})}},60625:(e,a,t)=>{t.r(a),t.d(a,{default:()=>d,useMagicToken:()=>m});var s=t(70537),n=t(64084),r=t(15924),o=t(15312),l=t(14566),c=t(80683);function i(){const{t:e}=(0,l.$G)("auth",{keyPrefix:"magic_link_expire"});return(0,c.jsxs)("div",{className:"flex flex-col items-center",children:[(0,c.jsx)("div",{className:"font-bold text-3xl text-gray-800 dark:text-white mt-3",children:e("title")}),(0,c.jsx)("p",{className:"text-center text-gray-400 mb-6",children:e("desc")}),(0,c.jsx)("p",{className:"text-center text-gray-400",children:e("desc_close")})]})}function d(){var e;const[a,{data:t,isLoading:l}]=(0,o.v5)(),[d,m]=(0,s.useState)("");let[x]=(0,n.lr)(new URLSearchParams(location.search));const u=null!==(e=x.get("magic_token"))&&void 0!==e?e:"";return(0,s.useEffect)((()=>{u&&a(u)}),[u]),(0,s.useEffect)((()=>{t&&m(u)}),[t,u]),l?(0,c.jsx)("div",{className:"dark:text-gray-100",children:"Checking Magic Link..."}):(0,c.jsx)("div",{className:"flex-center h-screen overflow-x-hidden overflow-y-auto dark:bg-gray-700",children:(0,c.jsx)("div",{className:"py-8 px-10 shadow-md rounded-xl max-h-[95vh] overflow-y-auto overflow-x-hidden",children:u?t?(0,c.jsx)(r.j3,{context:{token:d}}):(0,c.jsx)(i,{}):(0,c.jsx)(r.j3,{context:{token:d}})})})}function m(){return(0,r.bx)()}}}]);