"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[576],{51892:(e,s,t)=>{t.d(s,{Z:()=>r});var c=t(70537),i=t(65809),n=t(66160);const r=()=>{var e;const{userCount:s,isGuest:t}=(0,n.CG)((e=>({userCount:e.users.ids.length,isGuest:e.authData.guest}))),{data:r,refetch:a}=(0,i.qM)(void 0,{refetchOnMountOrArgChange:!0,skip:t}),[o,{isLoading:l,isSuccess:d}]=(0,i.U_)(),[u,{isSuccess:g,isLoading:h,reset:f}]=(0,i.yn)();(0,c.useEffect)((()=>{g&&(a(),f())}),[g]);return{reachLimit:s>=(null!==(e=null===r||void 0===r?void 0:r.user_limit)&&void 0!==e?e:Number.MAX_SAFE_INTEGER),license:r,checked:d,checking:l,upserting:h,upserted:g,checkLicense:e=>{o(e)},upsertLicense:async e=>{const s=await o(e);return!(!("data"in s)||!s.data.sign)&&await u(e)}}}},99571:(e,s,t)=>{t.r(s),t.d(s,{default:()=>x});var c=t(15924),i=t(70537),n=t(65809),r=t(51892),a=t(69885);const o=t.p+"static/media/check.0e75fc4e5a0b2b49cbd1.png";var l=t(14566),d=t(80683);const u=e=>{let{sid:s}=e;const{t:t}=(0,l.$G)("setting",{keyPrefix:"license"}),u=(0,c.s0)(),{upsertLicense:g,upserting:h,upserted:f}=(0,r.Z)(),[p,{data:m,isError:x,isLoading:b,isSuccess:w}]=(0,n.YS)();(0,i.useEffect)((()=>{s&&p(s)}),[s]),(0,i.useEffect)((()=>{if(w&&m){const e=m.license;g(e)}}),[m,w]);return(0,d.jsxs)("section",{className:"flex flex-col items-center bg-slate-100 rounded-2xl w-[512px] p-6",children:[(0,d.jsx)("img",{className:"w-28 h-28",src:o,alt:"check icon"}),(0,d.jsx)("h1",{className:"font-bold text-3xl pt-5",children:t("payment_success")}),(0,d.jsxs)("p",{className:"text-lg pb-7 mt-2 text-gray-400",children:[h?t("tip_renewing"):"",f?t("tip_renewed"):"",x?t("tip_renew_error"):""]}),(0,d.jsx)(a.Z,{disabled:b||h,className:"back",onClick:()=>{u("/")},children:t("back_home")})]})};var g=t(80308),h=t(15312),f=t(27418);const p=e=>{let{code:s,from:t="webapp"}=e;const{t:c}=(0,l.$G)(),n=localStorage.getItem(g.LJ),[r,{isLoading:a,isSuccess:o,error:u}]=(0,h.YA)();return(0,i.useEffect)((()=>{s&&r({magic_token:n,code:s,type:"github"})}),[s]),(0,i.useEffect)((()=>{o&&(f.ZP.success(c("tip.login")),"widget"==t&&localStorage.setItem("widget",`${(new Date).getTime()}`),"webapp"==t&&(location.href="/"))}),[o,t]),(0,i.useEffect)((()=>{if(u)if(410===u.status)f.ZP.error("No associated account found, please contact user admin for an invitation link to join.");else f.ZP.error("Something Error");else;}),[u]),u?(0,d.jsx)("span",{children:"Something Error"}):(0,d.jsxs)("section",{className:"flex flex-col gap-3 justify-center items-center",children:[o&&"widget"==t&&(0,d.jsx)("h1",{children:"Please close this window and return widget window"}),(0,d.jsx)("span",{className:"text-3xl text-green-600 font-bold",children:a?"GitHub Logging in...":"GitHub Login Success!"})]})},m=e=>{let{children:s}=e;return(0,d.jsx)("div",{className:"flex w-screen h-screen items-center justify-center break-words leading-normal",children:s})};function x(){const{type:e="",payload:s=""}=(0,c.UO)();if("payment_success"==e)return(0,d.jsx)(m,{children:(0,d.jsx)(u,{sid:s})});if("github"==e){var t;const e=null!==(t=new URLSearchParams(location.search).get("code"))&&void 0!==t?t:"";return(0,d.jsx)(m,{children:(0,d.jsx)(p,{code:e,from:s})})}return(0,d.jsx)(m,{children:"callback page"})}}}]);