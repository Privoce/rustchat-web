"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[287],{28595:(e,t,s)=>{s.d(t,{Z:()=>i});var a,n=s(70537);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},l.apply(this,arguments)}const r=(e,t)=>{let{title:s,titleId:r,...i}=e;return n.createElement("svg",l({width:24,height:24,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"#78787C",ref:t,"aria-labelledby":r},i),s?n.createElement("title",{id:r},s):null,a||(a=n.createElement("path",{d:"M12.75 4.125C12.75 3.50368 12.2463 3 11.625 3C11.0037 3 10.5 3.50368 10.5 4.125V10.5H4.125C3.50368 10.5 3 11.0037 3 11.625C3 12.2463 3.50368 12.75 4.125 12.75H10.5V19.125C10.5 19.7463 11.0037 20.25 11.625 20.25C12.2463 20.25 12.75 19.7463 12.75 19.125V12.75H19.125C19.7463 12.75 20.25 12.2463 20.25 11.625C20.25 11.0037 19.7463 10.5 19.125 10.5H12.75V4.125Z"})))},i=(0,n.forwardRef)(r)},96954:(e,t,s)=>{s.d(t,{Z:()=>d});var a=s(70537),n=s(26201),l=s(64631),r=s(11855),i=s(80683);const d=e=>{let{id:t=""}=e;const{favorites:s}=(0,r.Z)({}),[d,c]=(0,a.useState)(null);return(0,a.useEffect)((()=>{const e=s.find((e=>e.id==t)),{messages:a}=e||{};if(!a)return;const r=a.map((e=>{let{from_mid:t}=e;return+t}))||[];c((0,i.jsx)("div",{"data-favorite-mids":r.join(","),className:"favorite flex flex-col rounded-md bg-slate-50 dark:bg-slate-800",children:(0,i.jsx)("div",{className:"list",children:a.map(((e,t)=>{const{user:s={},download:a,content:r,content_type:d,properties:c,thumbnail:o}=e;return(0,i.jsxs)("div",{className:"w-full relative flex items-start gap-3 px-2 py-1 my-2 rounded-lg md:dark:hover:bg-gray-800",children:[s&&(0,i.jsx)("div",{className:"shrink-0 w-10 h-10 flex",children:(0,i.jsx)(l.Z,{width:40,height:40,className:"rounded-full object-cover",src:s.avatar,name:s.name})}),(0,i.jsxs)("div",{className:"w-full flex flex-col gap-2 text-sm",children:[(0,i.jsx)("div",{className:"flex items-center gap-2 font-semibold",children:(0,i.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:(null===s||void 0===s?void 0:s.name)||"Deleted User"})}),(0,i.jsx)("div",{className:"select-text text-gray-800 break-all whitespace-pre-wrap dark:text-white",children:(0,n.Z)({download:a,content:r,content_type:d,properties:c,thumbnail:o})})]})]},t)}))})}))}),[s,t]),t?d:null}},7954:(e,t,s)=>{s.r(t),s.d(t,{default:()=>rs});var a=s(70537),n=s(15924),l=s(57425),r=s(72991),i=s(64084),d=s(7829),c=s(65953),o=s(31159),m=s(14317),u=s(66160),x=s(14566),h=s(80683);function p(e){let{readonly:t=!1}=e;const{t:s}=(0,x.$G)(),{pathname:a}=(0,n.TH)(),{server:l,userCount:r}=(0,u.CG)((e=>({userCount:e.users.ids.length,server:e.server}))),{name:p,description:f,logo:g}=l;return t?(0,h.jsx)(i.OL,{to:"/",className:"relative flex items-center justify-between gap-2 px-4 py-2",children:(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("div",{className:"w-8 h-8",children:(0,h.jsx)("img",{alt:`${p} logo`,className:"w-full h-full object-cover rounded-full",src:g})}),(0,h.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,h.jsx)("h3",{className:"text-sm text-gray-600 dark:text-gray-100",title:f,children:p}),(0,h.jsxs)("span",{className:"text-xs text-gray-500",children:[r," ",s("members")]})]})]})}):(0,h.jsxs)("div",{className:"relative flex items-center justify-between gap-2 px-4 py-2",children:[(0,h.jsx)(i.OL,{to:`/setting/overview?f=${a}`,children:(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("div",{className:"w-8 h-8",children:(0,h.jsx)("img",{alt:`${p} logo`,className:"w-full h-full object-cover rounded-full",src:g})}),(0,h.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,h.jsx)("h3",{className:"text-sm text-gray-600 font-bold dark:text-gray-100",title:f,children:p}),(0,h.jsxs)("span",{className:"text-xs text-gray-500",children:[r," ",s("members")]})]})]})}),(0,h.jsx)(o.Z,{tip:s("more"),placement:"bottom",children:(0,h.jsx)(d.ZP,{interactive:!0,placement:"bottom-end",trigger:"click",content:(0,h.jsx)(m.Z,{}),children:(0,h.jsx)("img",{src:c,alt:"add icon",className:"cursor-pointer"})})})]})}var f,g=s(3074),v=s(87336);function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},j.apply(this,arguments)}const b=(e,t)=>{let{title:s,titleId:n,...l}=e;return a.createElement("svg",j({width:160,height:160,viewBox:"0 0 160 160",fill:"#D0D5DD",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},l),s?a.createElement("title",{id:n},s):null,f||(f=a.createElement("path",{d:"M79.9997 13.3642C116.819 13.3642 146.666 43.2118 146.666 80.0308C146.666 116.85 116.819 146.698 79.9997 146.698C43.1807 146.698 13.333 116.85 13.333 80.0308C13.333 43.2118 43.1807 13.3642 79.9997 13.3642ZM79.9997 23.3642C48.7035 23.3642 23.333 48.7347 23.333 80.0308C23.333 111.327 48.7035 136.698 79.9997 136.698C111.296 136.698 136.666 111.327 136.666 80.0308C136.666 48.7347 111.296 23.3642 79.9997 23.3642ZM79.9997 86.6667C88.284 86.6667 94.9997 93.3824 94.9997 101.667C94.9997 109.951 88.284 116.667 79.9997 116.667C71.7154 116.667 64.9997 109.951 64.9997 101.667C64.9997 93.3824 71.7154 86.6667 79.9997 86.6667ZM60.0027 58.3411C64.6024 58.3411 68.3313 62.0699 68.3313 66.6697C68.3313 71.2694 64.6024 74.9983 60.0027 74.9983C55.4029 74.9983 51.6741 71.2694 51.6741 66.6697C51.6741 62.0699 55.4029 58.3411 60.0027 58.3411ZM100.003 58.3411C104.602 58.3411 108.331 62.0699 108.331 66.6697C108.331 71.2694 104.602 74.9983 100.003 74.9983C95.4029 74.9983 91.6741 71.2694 91.6741 66.6697C91.6741 62.0699 95.4029 58.3411 100.003 58.3411Z"})))},y=(0,a.forwardRef)(b);var w=s(25552),C=s(7699),N=s.n(C),k=s(26201),_=s(64631),Z=s(21812);const M=e=>{var t,s,a;let{data:n}=e;const{msgData:l,usersData:r}=(0,u.CG)((e=>({msgData:e.message,usersData:e.users.byId}))),{mid:i=0}=n,d=(0,Z.PW)(n)||{},{content_type:c,content:o,properties:m,thumbnail:x=""}={...n,...d},p=(null===(t=l[i])||void 0===t?void 0:t.from_uid)||0,f=(null===(s=l[i])||void 0===s?void 0:s.created_at)||0,{name:g,avatar:v}=null!==(a=r[p])&&void 0!==a?a:{};return(0,h.jsxs)("div",{className:"w-full relative flex items-start gap-3 p-2 my-2 rounded-lg",children:[(0,h.jsx)("div",{className:"rounded-full overflow-hidden w-10 h-10 shrink-0",children:(0,h.jsx)(_.Z,{width:40,height:40,src:v,name:g})}),(0,h.jsxs)("div",{className:"w-full flex flex-col items-start gap-1  text-sm",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2 font-semibold",children:[(0,h.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:g}),(0,h.jsx)("time",{className:"text-xs text-gray-400",children:N()(f).format("YYYY-MM-DD h:mm:ss A")})]}),(0,h.jsx)("div",{className:"select-text text-gray-600 break-all whitespace-pre-wrap dark:text-white",children:(0,k.Z)({content_type:c,content:o,thumbnail:x,from_uid:p,properties:m})})]})]})},$=e=>{let{id:t}=e;const{t:s}=(0,x.$G)("chat"),{pins:a,unpinMessage:n,canPin:l}=(0,v.Z)(t),r=e=>{const{mid:t}=e.currentTarget.dataset;t&&n(+t)},i=0==a.length;return(0,h.jsxs)("div",{className:"p-4 drop-shadow-md overflow-y-scroll min-w-[320px] md:min-w-[486px] md:max-h-[90vh] rounded-xl bg-gray-50 dark:bg-gray-800",children:[(0,h.jsxs)("h4",{className:" text-gray-600 dark:text-gray-400 mb-4 font-semibold",children:[s("pinned_msg"),"(",a.length,")"]}),i?(0,h.jsxs)("div",{className:"flex flex-col items-center gap-2 w-full p-4",children:[(0,h.jsx)(y,{}),(0,h.jsx)("div",{className:"w-60 font-semibold text-gray-500 dark:text-gray-300 text-center",children:s("pin_empty_tip")})]}):(0,h.jsx)("ul",{className:"flex flex-col gap-2",children:a.map((e=>(0,h.jsxs)("li",{className:"group relative border border-solid border-slate-100 dark:border-slate-600 rounded-md ",children:[(0,h.jsx)(M,{data:e}),(0,h.jsx)("div",{className:"invisible group-hover:visible flex items-center gap-1 absolute top-1 right-1 p-1 border border-solid border-black/10 dark:border-gray-500 rounded-md",children:l&&(0,h.jsx)("button",{className:"flex bg-none border-none","data-mid":e.mid,onClick:r,children:(0,h.jsx)(w.Z,{className:"fill-slate-900 dark:fill-slate-300"})})})]},e.mid)))})]})};var D=s(96954),I=s(11855);const E=e=>{let{cid:t=null,uid:s=null}=e;const{t:a}=(0,x.$G)("chat"),{favorites:n,removeFavorite:l}=(0,I.Z)({cid:t,uid:s}),r=e=>{const{id:t=""}=e.currentTarget.dataset;l(t)},i=0==n.length;return(0,h.jsxs)("div",{className:"p-4 bg-slate-50 dark:bg-slate-800 rounded-xl min-w-[500px] max-h-[500px] overflow-auto drop-shadow-[0px_25px_50px_rgba(31,_41,_55,_0.25)]",children:[(0,h.jsxs)("h4",{className:"font-bold text-gray-600 dark:text-gray-400 mb-4",children:[a("fav_msg"),"(",n.length,")"]}),i?(0,h.jsxs)("div",{className:"flex flex-col gap-2 w-full items-center p-4",children:[(0,h.jsx)(y,{}),(0,h.jsx)("div",{className:"w-60 text-gray-600 dark:text-gray-400 text-center font-bold",children:a("fav_empty_tip")})]}):(0,h.jsx)("ul",{className:"flex flex-col gap-2",children:n.map((e=>{let{id:t}=e;return(0,h.jsxs)("li",{className:"relative border border-solid border-slate-200 dark:border-gray-600 rounded-md group",children:[(0,h.jsx)(D.Z,{id:t}),(0,h.jsx)("div",{className:"flex items-center absolute top-2 right-2 border border-solid border-gray-300 dark:border-gray-600 rounded-md overflow-hidden invisible group-hover:visible",children:(0,h.jsx)("button",{className:"flex-center w-6 h-6 p-1","data-id":t,onClick:r,children:(0,h.jsx)(w.Z,{className:"fill-slate-900 dark:fill-slate-500"})})})]},t)}))})]})};var O=s(12564),H=s(13386),V=s(59857),L=s(16352),S=s(27418),F=s(62432),U=s(53517),G=s(1823),R=s(88332);var T=s(80308),B=s(81721),P=s(57815),z=s(55526),A=s(88109),W=s(25583),Y=s(34265);const q={editableProps:{spellCheck:!1,autoFocus:!0,placeholder:"Type\u2026"},trailingBlock:{type:z.JBe},softBreak:{options:{rules:[{hotkey:"shift+enter",query:{allow:[z.IVr,z.JBe]}}]}},exitBreak:{options:{rules:[{hotkey:"mod+enter",query:{allow:[z.IVr,z.JBe]}}]}},selectOnBackspace:{options:{query:{allow:[z.IVr]}}}};var K=s(33941);const J="_text_editor";let Q=(0,z.Ips)({});const X=[{type:z.JBe,children:[{text:""}]}],ee=e=>{const t=(0,z.CE7)(`${J}_${e}`);return{focus:()=>{t&&W.F3.focus(t)},insertText:e=>{t&&(W.F3.focus(t),t.insertText(e))}}},te=e=>{let{updateDraft:t=null,initialValue:s=X,id:n,placeholder:l="Write some markdown...",sendMessages:r,members:i=[]}=e;const[d,c]=n.split("_"),{addStageFile:o}=(0,Y.Z)({context:d,id:c}),m=i.length>0,x=(0,u.CG)((e=>e.users.byId)),[p,f]=(0,a.useState)([]),g=(0,a.useRef)(null),v={...q.editableProps,className:"flex flex-col md:gap-2",placeholder:l},j=(0,z.CE7)(`${J}_${n}`);(0,a.useEffect)((()=>{const e=e=>{const t=[...e.clipboardData.files];if(t.length){const e=t.map((e=>{const{size:t,type:s,name:a}=e;return{size:t,type:s,name:a,url:URL.createObjectURL(e)}}));o(e)}};return window.addEventListener("paste",e),()=>{window.removeEventListener("paste",e)}}),[n,t]),(0,B.z)("Enter",(e=>{if(!j)return;if((0,z.kGl)(j)||e.shiftKey||e.ctrlKey||e.altKey||e.isComposing)return!0;e.preventDefault(),b()}),{when:!(0,Z.tq)(),target:g});const b=()=>{r(p),P.YR.delete(j,{at:{anchor:P.ML.start(j,[]),focus:P.ML.end(j,[])}})},y=[(0,z.ZZF)(),(0,z.kdp)(),(0,z.kjx)(q.softBreak),(0,z.AFf)(q.trailingBlock),(0,z.z$X)(q.exitBreak)],w=(0,z.ZUk)(m?y.concat([(0,A.kQ)(),(0,z.MoH)({options:{createMentionNode:e=>{const{text:t,data:{uid:s}}=e;return{value:`@${t}`,uid:s}},insertSpaceAfterMention:!0}})]):y,{components:Q}),C=(0,a.useCallback)((async e=>{const t=[],s=e=>{const t=[];return{value:e.map((e=>{let{type:s,text:a,uid:n}=e;return"mention"==s?(t.push(n),` @${n} `):a})).join(""),mentions:t}};for(const n of e){const{value:e,mentions:a}=s(n.children),l=t[t.length-1];l&&Array.isArray(l)?t[t.length-1].push({type:"text",content:e,properties:{mentions:a}}):t.push([{type:"text",content:e,properties:{mentions:a}}])}const a=t.map((e=>Array.isArray(e)?{type:"text",content:e.map((e=>e.content)).join("\n"),properties:{mentions:e.map((e=>{var t;return(null===(t=e.properties)||void 0===t?void 0:t.mentions)||[]})).flat()}}:e)).filter((e=>{let{content:t}=e;return!!t}));f(a)}),[p]);return(0,h.jsx)("div",{className:"input w-full pr-14 md:pr-0 max-h-[50vh] overflow-auto text-sm text-gray-600 dark:text-white",ref:g,children:(0,h.jsx)(z.hv7,{id:`${J}_${n}`,onChange:C,editableProps:{...v,style:{userSelect:"text"}},initialValue:s,plugins:w,children:m?(0,h.jsx)(z.bEm,{onRenderItem:e=>{let{item:t}=e;return t&&t.data?(0,h.jsx)(K.Z,{uid:t.data.uid,interactive:!1},t.data.uid):null},items:i.map((e=>{const t=x[e];if(!t)return{key:e};const{uid:s,name:a,...n}=t;return{key:s,text:a,data:{uid:s,...n}}}))}):null})})};var se=s(80874),ae=s(69885),ne=s(17237);function le(e){let{name:t,closeModal:s,updateName:n}=e;const[l,r]=(0,a.useState)(t);return(0,h.jsx)(se.Z,{children:(0,h.jsxs)("div",{className:"bg-white dark:bg-gray-800 flex flex-col drop-shadow rounded-xl p-4 w-[406px]",children:[(0,h.jsxs)("h4",{className:"flex items-center justify-between font-semibold text-lg text-gray-700 dark:text-gray-100 w-full",children:["File Details ",(0,h.jsx)(w.Z,{className:"cursor-pointer dark:fill-white",onClick:s})]}),(0,h.jsxs)("div",{className:"py-4 flex flex-col gap-2",children:[(0,h.jsx)("label",{className:"font-semibold text-sm text-gray-600 dark:text-gray-200",htmlFor:"name",children:"Name"}),(0,h.jsx)(ne.Z,{id:"name",value:l,onChange:e=>{r(e.target.value)}})]}),(0,h.jsxs)("div",{className:"flex justify-end gap-4 mt-8 w-full",children:[(0,h.jsx)(ae.Z,{className:"ghost cancel",onClick:s,children:"Cancel"}),(0,h.jsx)(ae.Z,{onClick:()=>{n(l),s()},children:"Save Changes"})]})]})})}var re=s(28533),ie=s(9925);function de(e){let{context:t,id:s}=e;const n=ee(`${t}_${s}`),[l,r]=(0,a.useState)(null),{stageFiles:i,updateStageFile:d,removeStageFile:c}=(0,Y.Z)({context:t,id:s}),o=e=>{r((t=>t?null:e))},m=e=>{const t=i[`${e}`];t&&o({...t,index:e})};return(0,a.useEffect)((()=>{n.focus()}),[i.length]),t&&s&&i&&0!=i.length?(0,h.jsxs)(h.Fragment,{children:[l&&(0,h.jsx)(le,{name:l.name,updateName:e=>{if(!e||!l)return;const{index:t}=l;d(t,{name:e})},closeModal:o}),(0,h.jsx)("ul",{className:"w-full overflow-auto flex gap-2 justify-start p-4 pt-6 bg-gray-200 dark:bg-gray-800 rounded-t-lg",children:i.map(((e,t)=>{let{name:s,url:a,size:n,type:l}=e;return(0,h.jsxs)("li",{className:"group relative flex flex-col bg-gray-100 dark:bg-gray-700 rounded p-2",children:[(0,h.jsx)("div",{className:"flex-center w-40 h-40",children:l.startsWith("image")?(0,h.jsx)("img",{className:"w-full h-full object-cover",src:a,alt:"image"}):(0,Z.LP)(l,s)}),(0,h.jsx)("h4",{className:"w-40 mt-4 mb-0.5 font-semibold text-sm text-gray-800 dark:text-gray-100 truncate",children:s}),(0,h.jsx)("span",{className:"text-xs text-gray-500",children:(0,Z.td)(n)}),(0,h.jsxs)("ul",{className:"invisible group-hover:visible bg-inherit border border-solid border-black/10 box-border rounded-md flex items-center absolute -right-5 -top-2.5",children:[(0,h.jsx)("li",{className:"p-1 cursor-pointer edit",onClick:m.bind(null,t),children:(0,h.jsx)(re.Z,{})}),(0,h.jsx)("li",{className:"p-1 cursor-pointer delete","data-index":t,onClick:c.bind(null,t),children:(0,h.jsx)(ie.Z,{})})]})]},a)}))})]}):null}var ce=s(84006);const oe=s.p+"static/media/close.circle.785556eb2b09c84f7ef1.svg",me=s.p+"static/media/picture.57a395fb7f41e8e3c5d1.svg";var ue=s(7935);const xe=e=>{const{content_type:t,content:s,thumbnail:a="",properties:n}=e;let l=null;switch(t){case T.bT.text:l=(0,h.jsx)(ue.Z,{text:s,url:!1,mentionTextOnly:!0});break;case T.bT.markdown:l=(0,h.jsx)("div",{className:"max-h-[100px] overflow-auto",children:(0,h.jsx)(ce.Z,{content:s})});break;case T.bT.file:{const{content_type:e="",name:t,size:s}=n||{};if((0,Z.Or)(e,s))l=(0,h.jsx)("img",{className:"w-10 h-10 object-cover",src:a||me});else{const s=(0,Z.LP)(e,t,"icon w-4 h-5");l=(0,h.jsxs)(h.Fragment,{children:[s,(0,h.jsx)("span",{className:"ml-1 text-[10px] text-gray-400",children:t})]})}}}return l};function he(e){let{context:t,id:s,mid:a}=e;const{removeReplying:n}=(0,F.Z)({to:s,context:t}),{msg:l,usersData:r}=(0,u.CG)((e=>({usersData:e.users.byId,msg:e.message[a]})));if(!l)return null;const{from_uid:i=0}=l,d=r[i];return(0,h.jsxs)("div",{className:"reply bg-gray-100 dark:bg-gray-700 z-[999] flex flex-col md:flex-row items-start justify-start gap-4 rounded-t-lg w-full px-4 py-3 text-sm",children:[(0,h.jsxs)("div",{className:"whitespace-nowrap text-gray-400 ",children:["Replying to ",(0,h.jsx)("span",{className:"font-bold text-gray-600 dark:text-gray-400",children:null===d||void 0===d?void 0:d.name})]}),(0,h.jsx)("div",{className:"text-gray-500 overflow-hidden pr-7 ",children:xe(l)}),(0,h.jsx)("button",{className:"absolute top-4 right-4 cursor-pointer",onClick:()=>{n()},children:(0,h.jsx)("img",{src:oe,alt:"close icon"})})]})}var pe;function fe(){return fe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},fe.apply(this,arguments)}const ge=(e,t)=>{let{title:s,titleId:n,...l}=e;return a.createElement("svg",fe({width:24,height:24,viewBox:"0 0 24 24",fill:"#667085",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},l),s?a.createElement("title",{id:n},s):null,pe||(pe=a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM17 13H13V17H11V13H7V11H11V7H13V11H17V13Z"})))},ve=(0,a.forwardRef)(ge);var je;function be(){return be=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},be.apply(this,arguments)}const ye=(e,t)=>{let{title:s,titleId:n,...l}=e;return a.createElement("svg",be({width:24,height:24,viewBox:"0 0 24 24",fill:"#667085",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},l),s?a.createElement("title",{id:n},s):null,je||(je=a.createElement("path",{d:"M3 2H21C21.2652 2 21.5196 2.11706 21.7071 2.32544C21.8946 2.53381 22 2.81643 22 3.11111V20.8889C22 21.1836 21.8946 21.4662 21.7071 21.6746C21.5196 21.8829 21.2652 22 21 22H3C2.73478 22 2.48043 21.8829 2.29289 21.6746C2.10536 21.4662 2 21.1836 2 20.8889V3.11111C2 2.81643 2.10536 2.53381 2.29289 2.32544C2.48043 2.11706 2.73478 2 3 2ZM7 15.8889V11.4444L9 13.6667L11 11.4444V15.8889H13V8.11111H11L9 10.3333L7 8.11111H5V15.8889H7ZM18 12.5556V8.11111H16V12.5556H14L17 15.8889L20 12.5556H18Z"})))},we=(0,a.forwardRef)(ye);var Ce;function Ne(){return Ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Ne.apply(this,arguments)}const ke=(e,t)=>{let{title:s,titleId:n,...l}=e;return a.createElement("svg",Ne({width:24,height:24,viewBox:"0 0 24 24",fill:"#667085",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},l),s?a.createElement("title",{id:n},s):null,Ce||(Ce=a.createElement("path",{d:"M5 6C5 5.44772 5.44772 5 6 5H8C8.55228 5 9 4.55228 9 4C9 3.44772 8.55228 3 8 3H6C4.34315 3 3 4.34315 3 6V8C3 8.55228 3.44772 9 4 9C4.55228 9 5 8.55228 5 8V6ZM5 18C5 18.5523 5.44772 19 6 19H8C8.55228 19 9 19.4477 9 20C9 20.5523 8.55228 21 8 21H6C4.34315 21 3 19.6569 3 18V16C3 15.4477 3.44772 15 4 15C4.55228 15 5 15.4477 5 16V18ZM18 5C18.5523 5 19 5.44772 19 6V8C19 8.55228 19.4477 9 20 9C20.5523 9 21 8.55228 21 8V6C21 4.34315 19.6569 3 18 3H16C15.4477 3 15 3.44772 15 4C15 4.55228 15.4477 5 16 5H18ZM19 18C19 18.5523 18.5523 19 18 19H16C15.4477 19 15 19.4477 15 20C15 20.5523 15.4477 21 16 21H18C19.6569 21 21 19.6569 21 18V16C21 15.4477 20.5523 15 20 15C19.4477 15 19 15.4477 19 16V18Z"})))},_e=(0,a.forwardRef)(ke);var Ze;function Me(){return Me=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Me.apply(this,arguments)}const $e=(e,t)=>{let{title:s,titleId:n,...l}=e;return a.createElement("svg",Me({width:24,height:24,viewBox:"0 0 24 24",fill:"#667085",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},l),s?a.createElement("title",{id:n},s):null,Ze||(Ze=a.createElement("path",{d:"M9 4C9 3.44772 8.55228 3 8 3C7.44772 3 7 3.44772 7 4V6.5C7 6.77614 6.77614 7 6.5 7H4C3.44772 7 3 7.44772 3 8C3 8.55228 3.44772 9 4 9H6.5C7.88071 9 9 7.88071 9 6.5V4ZM9 20C9 20.5523 8.55228 21 8 21C7.44772 21 7 20.5523 7 20V17.5C7 17.2239 6.77614 17 6.5 17H4C3.44772 17 3 16.5523 3 16C3 15.4477 3.44772 15 4 15H6.5C7.88071 15 9 16.1193 9 17.5V20ZM16 3C15.4477 3 15 3.44772 15 4V6.5C15 7.88071 16.1193 9 17.5 9H20C20.5523 9 21 8.55228 21 8C21 7.44772 20.5523 7 20 7H17.5C17.2239 7 17 6.77614 17 6.5V4C17 3.44772 16.5523 3 16 3ZM15 20C15 20.5523 15.4477 21 16 21C16.5523 21 17 20.5523 17 20V17.5C17 17.2239 17.2239 17 17.5 17H20C20.5523 17 21 16.5523 21 16C21 15.4477 20.5523 15 20 15H17.5C16.1193 15 15 16.1193 15 17.5V20Z"})))},De=(0,a.forwardRef)($e),Ie=e=>{let{toggleMarkdownFullscreen:t,fullscreen:s,toggleMode:n,mode:l,to:r,context:i}=e;const{t:d}=(0,x.$G)(),{addStageFile:c}=(0,Y.Z)({context:i,id:r}),m=(0,a.useRef)(null),u="markdown"==l;return(0,h.jsxs)("div",{className:"hidden md:flex flex-col md:flex-row items-center justify-end gap-2.5",children:[(0,h.jsxs)("div",{className:"flex cursor-pointer gap-3.5",children:[(0,h.jsx)(o.Z,{placement:"top",tip:"Markdown",children:(0,h.jsx)(we,{className:u?"fill-primary-400":"dark:fill-gray-300",onClick:n})}),u&&(s?(0,h.jsx)(o.Z,{placement:"top",tip:"Exit Fullscreen",children:(0,h.jsx)(De,{onClick:t,className:"dark:fill-gray-300"})}):(0,h.jsx)(o.Z,{placement:"top",tip:"Fullscreen",children:(0,h.jsx)(_e,{onClick:t,className:"dark:fill-gray-300"})}))]}),!u&&(0,h.jsx)(o.Z,{placement:"top",tip:d("action.upload"),children:(0,h.jsxs)("div",{className:"cursor-pointer relative w-6 h-6",children:[(0,h.jsx)(ve,{className:"dark:fill-gray-300"}),(0,h.jsx)("label",{htmlFor:"file",className:" cursor-pointer absolute left-0 top-0 w-full h-full opacity-0",children:(0,h.jsx)("input",{className:"hidden",size:24,ref:m,multiple:!0,onChange:e=>{if(!e.target.files)return;const t=Array.from(e.target.files).map((e=>{const{size:t,type:s,name:a}=e;return{size:t,type:s,name:a,url:URL.createObjectURL(e)}}));c(t),m.current.value=null,m.current.value=""},type:"file",name:"file",id:"file"})})]})})]})};var Ee=s(97943),Oe=s(49476),He=s(1098);function Ve(e){let{selectEmoji:t}=e;const s=(0,a.useRef)(null),[n,r]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{s&&s.current&&(s.current.innerHTML="",new Oe.cW({data:async()=>(await fetch("https://cdn.jsdelivr.net/npm/@emoji-mart/data")).json(),parent:s.current,onEmojiSelect:e=>{t(e.native)}}))}),[t]),(0,Ee.O)(s,(e=>{const t=e.target;"svg"==t.nodeName&&"toggler"==t.dataset.emoji||"path"==t.nodeName&&"toggler"==t.parentElement.dataset.emoji||r(!1)}),n),(0,h.jsx)(o.Z,{placement:"top",tip:"Emojis",disabled:n,children:(0,h.jsxs)("div",{className:"hidden md:flex relative w-fit items-center",children:[(0,h.jsx)("div",{ref:s,className:(0,l.Z)("absolute -top-5 -left-5 -translate-y-full",n?"block":"hidden")}),(0,h.jsx)(He.Z,{"data-emoji":"toggler",className:"cursor-pointer select-none !w-[22px] !h-[22px]",onClick:()=>{r((e=>!e))}})]})})}s(61459);var Le=s(85606),Se=(s(85012),s(29191),s(69495),s(55403)),Fe=s.n(Se);const Ue=e=>{let{updateDraft:t=null,initialValue:s="",height:n="50vh",placeholder:l,sendMarkdown:r,setEditorInstance:i}=e;const d=(0,a.useRef)(),{uploadFile:c}=(0,Y.Z)();(0,a.useEffect)((()=>{const e=null===d||void 0===d?void 0:d.current;if(e){const t=e.getInstance();t.removeHook("addImageBlobHook"),t.addHook("addImageBlobHook",(async(e,t)=>{const{thumbnail:s=""}=await c(e)||{};t(s)})),i(t)}return()=>{if(e){const s=e.getInstance(),a=s.getMarkdown();t&&t(a),s.destroy()}}}),[]);return(0,h.jsxs)("div",{className:"input md-editor",children:[(0,h.jsx)(Le.M,{initialValue:s,plugins:[Fe()],placeholder:l,ref:d,toolbarItems:[],hideModeSwitch:!0,previewStyle:"vertical",height:n,initialEditType:"markdown",useCommandShortcut:!0,theme:(0,Z.Yc)()?"dark":"light"}),(0,h.jsx)(ae.Z,{className:"send small",onClick:()=>{if(!d.current)return;const e=d.current.getInstance();e.getMarkdown().trim()&&(r(e.getMarkdown()),e.reset())},children:"Send"})]})},Ge=e=>{let{context:t="user",id:s=0}=e;const a=(0,u.TL)(),n=`${t}_${s}`,{draftMarkdown:l,draftMixedText:r}=(0,u.CG)((e=>({draftMarkdown:e.ui.draftMarkdown,draftMixedText:e.ui.draftMixedText})));return{getDraft:function(){return"mixed"==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mixed")?r[n]:l[n]},getUpdateDraft:function(){const e="mixed"==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mixed")?O.$K:O.Ul;return t=>{a(e({key:n,value:t}))}}}};var Re=s(55283);const Te=e=>{let{sendMessage:t,placeholder:s}=e;const{t:n}=(0,x.$G)(),l=(0,a.useRef)(null),[r,i]=(0,a.useState)(""),d=()=>{if(!r)return;t([{type:"text",content:r}]),i("")};return(0,B.z)("Enter",(e=>{e.preventDefault(),d()}),{when:!(0,Z.tq)(),target:l}),(0,h.jsxs)("div",{className:"md:hidden relative mb-1 p-1 flex items-center w-full text-gray-600 dark:text-white bg-gray-200 dark:bg-gray-600 rounded-lg",children:[(0,h.jsx)(Re.Z,{onFocus:e=>e.currentTarget.setSelectionRange(e.currentTarget.value.length,e.currentTarget.value.length),ref:l,className:"p-1 w-full min-h-[28px] resize-none bg-transparent text-gray-800 dark:text-white text-sm break-all",maxRows:8,minRows:1,onChange:e=>{i(e.target.value)},value:r,placeholder:s}),(0,h.jsx)(ae.Z,{onClick:d,className:"mini absolute right-1.5 bottom-1.5",children:n("action.send")})]})},Be="text",Pe="markdown",ze=e=>{var t,s,n,r;let{context:i="channel",id:d}=e;const{t:c}=(0,x.$G)("chat"),{resetStageFiles:o}=(0,Y.Z)({context:i,id:d}),{getDraft:m,getUpdateDraft:p}=Ge({context:i,id:d}),f=ee(`${i}_${d}`),[v,j]=(0,a.useState)(null),[b,y]=(0,a.useState)(!1),w=(0,u.TL)(),C=function(e){let{context:t,to:s}=e;const a=(0,g.I0)(),n="channel"==t?G.p_:R.ZK;return e=>{a((0,U.Hz)(e)),a(n({id:s,mid:e.mid}))}}({context:i,to:d}),{from_uid:N,replying_mid:k=null,mode:_,uploadFiles:Z,channelsData:M,usersData:$,uids:D}=(0,u.CG)((e=>{var t;return{channelsData:e.channels.byId,uids:e.users.ids,usersData:e.users.byId,mode:e.ui.inputMode,from_uid:null===(t=e.authData.user)||void 0===t?void 0:t.uid,replying_mid:e.message.replying[`${i}_${d}`],uploadFiles:e.ui.uploadFiles[`${i}_${d}`]}})),{sendMessage:I}=(0,F.Z)({context:i,from:N,to:d});(0,a.useEffect)((()=>{k&&f.focus()}),[k]);const E=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(d){if(e&&e.length)for await(const s of e){var t;const{type:e,content:a,properties:n={}}=s;n.local_id=null!==(t=n.local_id)&&void 0!==t?t:+new Date,await I({id:d,reply_mid:k,type:e,content:a,from_uid:N,properties:n})}Z&&0!==Z.length&&(Z.forEach((e=>{const t=+new Date,{url:s,name:a,size:n,type:l}=e,r={mid:t,content:s,content_type:T.bT.file,created_at:t,properties:{content_type:l,name:a,size:n,local_id:t},from_uid:N,sending:!0};C(r)})),o())}},H="channel"==i?null===(t=M[d])||void 0===t?void 0:t.name:null===(s=$[d])||void 0===s?void 0:s.name,V=`${c("send_to")} ${T.rR[i]}${H} `,L="channel"==i?null!==(n=M[d])&&void 0!==n&&n.is_public?D:null===(r=M[d])||void 0===r?void 0:r.members:[],S=_==Pe;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Te,{sendMessage:E,placeholder:V}),(0,h.jsxs)("div",{className:(0,l.Z)(`send hidden md:block relative bg-gray-200 rounded-lg w-full dark:bg-gray-600 ${_} ${b?"fullscreen":""} ${k?"reply":""} ${i}`,S&&b&&"-mt-9"),children:[k&&(0,h.jsx)(he,{context:i,mid:k,id:d}),_==Be&&(0,h.jsx)(de,{context:i,id:d}),(0,h.jsxs)("div",{className:(0,l.Z)("flex justify-between items-center gap-4 px-4 py-3.5",S&&"grid grid-cols-[1fr_1fr] grid-rows-[auto_auto] gap-0"),children:[(0,h.jsx)(Ve,{selectEmoji:e=>{_==Pe&&v?v.insertText(e):f.insertText(e)}}),_==Be&&(0,h.jsx)(te,{updateDraft:p(),initialValue:m(),members:L,id:`${i}_${d}`,placeholder:V,sendMessages:E}),(0,h.jsx)(Ie,{context:i,to:d,mode:_,toggleMode:()=>{w((0,O.XH)(_==Be?Pe:Be))},fullscreen:b,toggleMarkdownFullscreen:()=>{y((e=>!e))}}),_==Pe&&(0,h.jsx)(Ue,{updateDraft:p("markdown"),initialValue:m("markdown"),height:b?"calc(100vh - 168px)":"30vh",placeholder:V,setEditorInstance:j,sendMarkdown:async e=>{I({id:d,reply_mid:k,type:"markdown",content:e,from_uid:N,properties:{local_id:+new Date}})}})]})]})]})};var Ae=s(46269),We=s(10189),Ye=s(41016),qe=s(24041),Ke=s(99181),Je=s(96117);const Qe=e=>{let{context:t,id:s}=e;const[n,l]=(0,a.useState)(!1),{canDelete:r}=(0,Ae.Z)(),{addFavorite:i}=(0,I.Z)({}),d=(0,u.CG)((e=>e.ui.selectMessages[`${t}_${s}`])),[c,o]=(0,a.useState)(!1),m=(0,u.TL)(),x=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];l((e=>!e)),e&&(m((0,O.Gy)({context:t,id:s,operation:"reset"})),S.ZP.success("Messages Deleted!"))},p=()=>{o((e=>!e))};(0,B.z)("Escape",(()=>{m((0,O.Gy)({context:t,id:s,operation:"reset"}))}));const f=r(d),g="p-2 bg-slate-100 dark:bg-slate-800 rounded md:hover:bg-slate-300 dark:md:hover:bg-slate-900";return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"relative p-4 flex-center gap-8 shadow-md",children:[(0,h.jsx)("button",{className:g,onClick:p,children:(0,h.jsx)(We.Z,{})}),(0,h.jsx)("button",{className:g,onClick:async()=>{await i(d)?(m((0,O.Gy)({context:t,id:s,operation:"reset"})),S.ZP.success("Messages Saved!")):S.ZP.error("Operation Failed!")},children:(0,h.jsx)(Ye.Z,{})}),(0,h.jsx)("button",{className:g,disabled:!f,onClick:x.bind(null,!1),children:(0,h.jsx)(ie.Z,{})}),(0,h.jsx)(qe.Z,{className:"cursor-pointer absolute right-5 top-1/2 -translate-y-1/2",onClick:()=>{m((0,O.Gy)({context:t,id:s,operation:"reset"}))}})]}),c&&(0,h.jsx)(Ke.Z,{mids:d,closeModal:p}),n&&(0,h.jsx)(Je.Z,{mids:d,closeModal:x})]})};var Xe=s(21645),et=s(34400);const tt=e=>{let{placement:t="chat"}=e;const{t:s}=(0,x.$G)("welcome"),{t:a}=(0,x.$G)(),r=(0,g.I0)(),{clearLocalData:i}=(0,et.Z)(),d=(0,n.s0)();return(0,h.jsxs)("div",{className:(0,l.Z)("flex items-center justify-between bg-slate-200/80 dark:bg-gray-800 rounded-lg p-4 border border-solid border-gray-200 dark:border-gray-500","session"==t?"!w-[96%] md:hidden fixed bottom-2 left-1/2 -translate-x-1/2":"w-full"),children:[(0,h.jsxs)("span",{className:"text-xs md:text-base text-gray-400 dark:text-gray-100",children:[(0,h.jsx)("i",{className:"mr-2 text-xs md:text-lg ",children:"\ud83d\udc4b"}),s("sign_in_tip")]}),(0,h.jsx)(ae.Z,{onClick:()=>{r((0,Xe.sQ)()),i(),d("/login")},className:"small",children:a("action.login")})]})};var st=s(51892);const at=()=>{const{t:e}=(0,x.$G)("chat"),t=(0,n.s0)();return(0,h.jsxs)("div",{className:"flex items-center justify-between bg-red-600 rounded-md w-full py-3 px-4",children:[(0,h.jsxs)("span",{className:"text-white",children:[(0,h.jsx)("i",{className:"text-xl mr-2",children:"\ud83d\udea8"}),e("license_tip")]}),(0,h.jsx)(ae.Z,{onClick:()=>{t("/setting/license")},className:"small",children:"Upgrade License"})]})},nt=e=>{let{context:t,name:s}=e;const{t:a}=(0,x.$G)("chat");return(0,h.jsx)("div",{className:"flex-center absolute left-0 top-0 w-full h-full bg-black/50",children:(0,h.jsx)("div",{className:"p-4 drop-shadow-md rounded-lg bg-primary-300",children:(0,h.jsxs)("div",{className:"p-4 pt-16 border-2 border-dashed border-primary-300 rounded-md flex flex-col items-center text-white",children:[(0,h.jsx)("h4",{className:"text-xl font-semibold",children:`${a("send_to")} ${T.rR[t]}${s}`}),(0,h.jsx)("span",{className:"text-sm",children:"Photos accept jpg, png, max size limit to 10M."})]})})})};var lt,rt;function it(){return it=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},it.apply(this,arguments)}const dt=(e,t)=>{let{title:s,titleId:n,...l}=e;return a.createElement("svg",it({width:32,height:32,viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},l),s?a.createElement("title",{id:n},s):null,lt||(lt=a.createElement("rect",{width:32,height:32,rx:16,fill:"#FEF0C7"})),rt||(rt=a.createElement("path",{d:"M15.9998 13.3333V16M15.9998 18.6667H16.0064M14.8598 9.90666L9.2131 19.3333C9.09668 19.5349 9.03508 19.7635 9.03443 19.9963C9.03378 20.2292 9.0941 20.4581 9.20939 20.6603C9.32468 20.8626 9.49092 21.0312 9.69157 21.1492C9.89223 21.2673 10.1203 21.3308 10.3531 21.3333H21.6464C21.8792 21.3308 22.1073 21.2673 22.308 21.1492C22.5086 21.0312 22.6749 20.8626 22.7902 20.6603C22.9054 20.4581 22.9658 20.2292 22.9651 19.9963C22.9645 19.7635 22.9029 19.5349 22.7864 19.3333L17.1398 9.90666C17.0209 9.71073 16.8536 9.54874 16.6539 9.43632C16.4542 9.32389 16.2289 9.26483 15.9998 9.26483C15.7706 9.26483 15.5453 9.32389 15.3456 9.43632C15.146 9.54874 14.9786 9.71073 14.8598 9.90666Z",stroke:"#DC6803",strokeWidth:1.33333,strokeLinecap:"round",strokeLinejoin:"round"})))},ct=(0,a.forwardRef)(dt);var ot=s(11172),mt=s(67883),ut=s(85910),xt=s(24783),ht=s(48791);const pt=e=>{let{context:t,id:s,scrollToBottom:a}=e;const{t:n}=(0,x.$G)("chat"),{readIndex:r,mids:i,messageData:d,loginUid:c}=(0,u.CG)((e=>{var a,n;return{readIndex:"channel"==t?e.footprint.readChannels[s]:e.footprint.readUsers[s],mids:"user"==t?e.userMessage.byId[s]:e.channelMessage[s],selects:e.ui.selectMessages[`${t}_${s}`],loginUid:null!==(a=null===(n=e.authData.user)||void 0===n?void 0:n.uid)&&void 0!==a?a:0,data:"channel"==t?e.channels.byId[s]:void 0,messageData:e.message||{}}})),{unreads:o=0}=(0,ht.ZP)({mids:i,readIndex:r,messageData:d,loginUid:c});return(0,h.jsx)("aside",{className:(0,l.Z)("z-[999] absolute bottom-20 right-4\n                                justify-between text-xs\n                                rounded-full py-1 px-3 text-white\n                                bg-gradient-to-tl from-[#3C8CE7] to-[#00EAFF]",o>0?"flex":"hidden"),children:(0,h.jsx)("button",{onClick:a,children:n("new_msg",{num:o})})})},ft=(0,a.forwardRef)(((e,t)=>{let{style:s,...a}=e;return(0,h.jsx)("div",{style:{...s,width:"calc(100% - 2rem)"},...a,ref:t})}));var gt=s(37076);const vt=e=>{let{cid:t}=e;const{pathname:s}=(0,n.TH)(),{t:a}=(0,x.$G)("chat"),{data:l,loginUser:r}=(0,u.CG)((e=>({loginUser:e.authData.user,data:e.channels.byId[t]})));return(0,h.jsxs)("div",{className:"pt-14 px-1 md:px-0 flex flex-col items-start gap-2",children:[(0,h.jsx)("h2",{className:"font-bold text-4xl dark:text-white",children:a("welcome_channel",{name:null===l||void 0===l?void 0:l.name})}),(0,h.jsxs)("p",{className:"text-gray-600 dark:text-gray-300",children:[a("welcome_desc",{name:null===l||void 0===l?void 0:l.name})," "]}),(null===r||void 0===r?void 0:r.is_admin)&&(0,h.jsxs)(i.OL,{to:`/setting/channel/${t}/overview?f=${s}`,className:"flex items-center gap-1 bg-clip-text text-fill-transparent bg-gradient-to-r from-blue-500 to-primary-400 ",children:[(0,h.jsx)(re.Z,{className:"w-4 h-4 fill-blue-500"}),a("edit_channel")]})]})},jt=e=>{let{context:t}=e;if(!t)return null;const{id:s,isChannel:a,loadingMore:n}=t;return(0,h.jsxs)(h.Fragment,{children:[a?(0,h.jsx)(vt,{cid:s}):null,(0,h.jsx)("div",{className:(0,l.Z)("mt-2 w-full py-2 ",n?"flex-center":"hidden"),children:(0,h.jsx)(gt.Z,{size:18,lineWeight:4,speed:1,color:"#ccc"})})]})};var bt=s(81980);const yt=e=>{let{context:t,id:s}=e;const n=(0,g.I0)(),[l,r]=(0,a.useState)(!1),[i,{isLoading:d,isSuccess:c,data:o}]=(0,xt.F0)(),m=(0,a.useRef)(null),[x]=(0,xt.o5)(),p=(0,mt.N)(x,300),{historyMid:f="",mids:v=[],selects:j,messageData:b,loginUser:y,footprint:w}=(0,u.CG)((e=>({historyMid:"user"==t?e.footprint.historyUsers[s]:e.footprint.historyChannels[s],mids:"user"==t?e.userMessage.byId[s]:e.channelMessage[s],selects:e.ui.selectMessages[`${t}_${s}`],footprint:e.footprint,loginUser:e.authData.user,messageData:e.message||{}})));(0,a.useEffect)((()=>{if(c&&o)if(0==o.length)n((0,bt.aB)({type:t,id:s,mid:"reached"}));else{const[{mid:e}]=o;n((0,bt.aB)({type:t,id:s,mid:`${e}`}))}}),[c,o,v,t,s]);const C=(0,a.useCallback)((()=>{const e=m.current;e&&e.scrollToIndex(v.length-1)}),[v]),N="channel"==t?w.readChannels[s]:w.readUsers[s];return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(ut.OO,{overscan:50,context:{loadingMore:d,id:s,isChannel:"channel"==t},id:`VOCECHAT_FEED_${t}_${s}`,className:"px-1 md:px-4 py-4.5 overflow-x-hidden overflow-y-scroll",ref:m,components:{List:ft,Header:jt},initialTopMostItemIndex:v.length-1,data:v,atTopThreshold:"channel"==t?160:0,atTopStateChange:e=>{if(e){if("reached"===f)return;let e=v.slice(0,1)[0];f&&(e=+f),i({context:t,id:s,mid:e})}},atBottomStateChange:e=>{r(e)},atBottomThreshold:400,followOutput:e=>{const[t]=v?v.slice(-1):[0],s=(new Date).getTime();return!(!e&&!(s-t<1e3))&&(!e||"smooth")},itemContent:(e,a)=>{const n=b[a];if(!n)return null;const l=0==e?null:b[v[e-1]],r=(null===n||void 0===n?void 0:n.from_uid)==(null===y||void 0===y?void 0:y.uid)||a<=N;return(0,ht.R7)({selectMode:!!j,updateReadIndex:p,read:r,prev:l,curr:n,contextId:s,context:t})}}),!l&&(0,h.jsx)(pt,{context:t,id:s,scrollToBottom:C})]})},wt=e=>{var t,s;let{readonly:n=!1,header:r,aside:i=null,users:d=null,dropFiles:c=[],context:o="channel",to:m}=e;const{reachLimit:x}=(0,st.Z)(),{addStageFile:p}=(0,Y.Z)({context:o,id:m}),f=(0,a.useRef)(null),{selects:g,channelsData:v,usersData:j,inputMode:b}=(0,u.CG)((e=>({inputMode:e.ui.inputMode,selects:e.ui.selectMessages[`${o}_${m}`],channelsData:e.channels.byId,usersData:e.users.byId}))),[{isActive:y},w]=(0,V.L)((()=>({accept:[L.FILE],drop(e){let{files:t}=e;if("text"===b){if(t.length){const e=t.map((e=>{const{size:t,type:s,name:a}=e;return{size:t,type:s,name:a,url:URL.createObjectURL(e)}}));p(e)}}else(0,S.Am)("DnD not allowed in this input mode",{icon:(0,h.jsx)(ct,{className:"w-5 h-5"})})},collect:e=>({isActive:e.canDrop()&&e.isOver()})})),[o,m,b]);(0,a.useEffect)((()=>{if(null!==c&&void 0!==c&&c.length){const e=c.map((e=>{const{size:t,type:s,name:a}=e;return{size:t,type:s,name:a,url:URL.createObjectURL(e)}}));p(e)}}),[c]);const C="channel"==o?null===(t=v[m])||void 0===t?void 0:t.name:null===(s=j[m])||void 0===s?void 0:s.name;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(ot.Z,{container:f.current}),(0,h.jsxs)("section",{ref:w,className:"relative h-full w-full rounded-r-2xl flex",children:[(0,h.jsxs)("main",{className:"flex flex-col flex-1",children:[r,(0,h.jsx)("div",{className:"w-full h-full flex items-start justify-between relative",children:(0,h.jsxs)("div",{className:"rounded-br-2xl flex flex-col absolute bottom-0 w-full h-full",ref:f,children:[(0,h.jsx)(yt,{context:o,id:m},`${o}_${m}`),(0,h.jsxs)("div",{className:"px-2 py-0 md:p-4 "+(g?"selecting":""),children:[n?(0,h.jsx)(tt,{}):x?(0,h.jsx)(at,{}):(0,h.jsx)("div",{className:(0,l.Z)("flex justify-center",g&&"hidden"),children:(0,h.jsx)(ze,{id:m,context:o},m)}),g&&(0,h.jsx)(Qe,{context:o,id:m})]})]})})]}),i&&(0,h.jsx)("div",{className:(0,l.Z)("z-50 p-3 absolute right-0 top-0 translate-x-full flex-col hidden md:flex"),children:i}),d&&(0,h.jsx)("div",{className:"hidden md:block",children:d}),!n&&"text"==b&&y&&(0,h.jsx)(nt,{context:o,name:C})]})]})};var Ct;function Nt(){return Nt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Nt.apply(this,arguments)}const kt=(e,t)=>{let{title:s,titleId:n,...l}=e;return a.createElement("svg",Nt({width:24,height:24,viewBox:"0 0 24 24",fill:"#70707B",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},l),s?a.createElement("title",{id:n},s):null,Ct||(Ct=a.createElement("path",{d:"M3.5 14L13.5 14.001C14.2793 14.001 14.9204 14.5963 14.9931 15.3566L15 15.501V17.5C14.999 21 11.284 22 8.5 22C5.77787 22 2.1647 21.044 2.00545 17.7296L2 17.5V15.5C2 14.7207 2.59527 14.0796 3.35561 14.0069L3.5 14ZM15.488 14H20.5C21.2793 14 21.9204 14.5944 21.9931 15.3555L22 15.5V17C21.999 20.062 19.142 21 17 21C16.32 21 15.569 20.904 14.86 20.678C15.5128 19.9277 15.9362 18.9748 15.9934 17.78L16 17.5V15.5C16 15.0056 15.8507 14.5488 15.601 14.1616L15.488 14H20.5H15.488ZM8.5 3C10.985 3 13 5.015 13 7.5C13 9.985 10.985 12 8.5 12C6.015 12 4 9.985 4 7.5C4 5.015 6.015 3 8.5 3ZM17.5 5C19.433 5 21 6.567 21 8.5C21 10.433 19.433 12 17.5 12C15.567 12 14 10.433 14 8.5C14 6.567 15.567 5 17.5 5Z"})))},_t=(0,a.forwardRef)(kt);var Zt=s(25680),Mt=s(94271),$t=s(24007),Dt=s(28595),It=s(89670);const Et=e=>{let{uids:t,addVisible:s,ownerId:n,cid:l,membersVisible:r}=e;const{t:i}=(0,x.$G)("chat"),d=(0,a.useRef)(null),[c,o]=(0,a.useState)(!1),m=()=>{o((e=>!e))};return(0,h.jsxs)(h.Fragment,{children:[c&&(0,h.jsx)(It.Z,{cid:l,closeModal:m}),(0,h.jsxs)("div",{ref:d,className:"h-full flex-col gap-1 w-[226px] overflow-y-scroll p-2 shadow-[inset_1px_0px_0px_rgba(0,_0,_0,_0.1)] "+(r?"flex":"hidden"),children:[s&&(0,h.jsxs)("div",{className:"cursor-pointer flex items-center justify-start gap-1 select-none rounded-lg p-2.5 md:hover:bg-gray-500/10",onClick:m,children:[(0,h.jsx)(Dt.Z,{className:"w-6 h-6 dark:fill-slate-300"}),(0,h.jsx)("div",{className:"font-semibold text-sm text-gray-600 dark:text-gray-50",children:i("add_channel_members")})]}),(0,h.jsx)($t.b,{initialPrerender:15,viewportRef:d,items:t,children:e=>(0,h.jsx)(K.Z,{enableContextMenu:!0,cid:l,owner:n==e,uid:e,dm:!0,popover:!0},e)})]})]})};function Ot(e){var t;let{cid:s=0,dropFiles:l=[]}=e;const{t:r}=(0,x.$G)("chat"),{pathname:i}=(0,n.TH)(),c=(0,n.s0)(),m=(0,g.I0)(),[p,f]=(0,a.useState)(!0),{userIds:v,data:j,loginUser:b}=(0,u.CG)((e=>({loginUser:e.authData.user,userIds:e.users.ids,data:e.channels.byId[s]})));(0,a.useEffect)((()=>{j||c("/chat")}),[j]),(0,a.useEffect)((()=>(m((0,O.cp)()),()=>{m((0,O.cp)({path:i}))})),[i]);if(!j)return null;const{name:y,description:w,is_public:C,members:N=[],owner:k}=j,_=C?v:N.slice(0).sort((e=>e==k?-1:0)),Z=(null===b||void 0===b?void 0:b.is_admin)||k==(null===b||void 0===b?void 0:b.uid),M=(null===j||void 0===j||null===(t=j.pinned_messages)||void 0===t?void 0:t.length)||0,D="relative cursor-pointer";return(0,h.jsx)(wt,{to:s,context:"channel",dropFiles:l,aside:(0,h.jsxs)("ul",{className:"flex flex-col gap-6",children:[(0,h.jsx)(o.Z,{tip:r("pin"),placement:"left",children:(0,h.jsx)(d.ZP,{placement:"left-start",popperOptions:{strategy:"fixed"},offset:[0,150],interactive:!0,trigger:"click",content:(0,h.jsx)($,{id:s}),children:(0,h.jsxs)("li",{className:`${D}`,children:[M>0?(0,h.jsx)("span",{className:"absolute -top-2 -right-2 flex-center w-4 h-4 rounded-full bg-primary-400 text-white font-bold text-[10px]",children:M}):null,(0,h.jsx)(Zt.Z,{className:"fill-gray-500"})]})})}),(0,h.jsx)(o.Z,{tip:r("fav"),placement:"left",children:(0,h.jsx)(d.ZP,{placement:"left-start",popperOptions:{strategy:"fixed"},offset:[0,164],interactive:!0,trigger:"click",content:(0,h.jsx)(E,{cid:s}),children:(0,h.jsx)("li",{className:`${D}`,children:(0,h.jsx)(Ye.Z,{className:"fill-gray-500"})})})}),(0,h.jsx)("li",{className:`${D}`,onClick:()=>{f((e=>!e))},children:(0,h.jsx)(o.Z,{tip:r("channel_members"),placement:"left",children:(0,h.jsx)(_t,{className:p?"fill-gray-600":""})})})]}),header:(0,h.jsxs)("header",{className:"px-5 py-4 flex items-center justify-center md:justify-between shadow-[inset_0_-1px_0_rgb(0_0_0_/_10%)]",children:[(0,h.jsx)(Mt.Z,{}),(0,h.jsxs)("div",{className:"flex items-center gap-1",children:[(0,h.jsx)(H.Z,{personal:!C}),(0,h.jsx)("span",{className:"text-gray-800 dark:text-white",children:y}),(0,h.jsx)("span",{className:"ml-2 text-gray-500 hidden md:block",children:w})]})]}),users:(0,h.jsx)(Et,{uids:_,addVisible:Z,cid:s,ownerId:k,membersVisible:p})})}const Ht=(0,a.memo)(Ot,((e,t)=>e.cid==t.cid)),Vt=e=>{let{uid:t=0,dropFiles:s}=e;const l=(0,n.s0)(),{currUser:r}=(0,u.CG)((e=>({currUser:e.users.byId[t]})));return(0,a.useEffect)((()=>{r||l("/chat")}),[r]),r?(0,h.jsx)(wt,{to:t,context:"user",dropFiles:s,aside:(0,h.jsx)("ul",{className:"flex flex-col gap-6",children:(0,h.jsx)(o.Z,{tip:"Saved Items",placement:"left",children:(0,h.jsx)(d.ZP,{placement:"left-start",popperOptions:{strategy:"fixed"},offset:[0,180],interactive:!0,trigger:"click",content:(0,h.jsx)(E,{uid:t}),children:(0,h.jsx)("li",{className:"relative cursor-pointer fav",children:(0,h.jsx)(Ye.Z,{className:"fill-gray-500"})})})})}),header:(0,h.jsxs)("header",{className:"box-border px-5 py-1 flex items-center justify-center md:justify-between shadow-[inset_0_-1px_0_rgb(0_0_0_/_10%)]",children:[(0,h.jsx)(Mt.Z,{}),(0,h.jsx)(K.Z,{interactive:!1,uid:r.uid})]})}):null};var Lt=s(59476),St=s(18879),Ft=s(52334),Ut=s(79198),Gt=s(50911);const Rt=e=>{let{context:t="user",id:s,visible:a,mid:l,hide:r,deleteChannel:i,setInviteChannelId:c,children:o}=e;const{t:m}=(0,x.$G)(),{canCopyEmail:p,copyEmail:f,canDeleteChannel:v}=(0,Gt.Z)({uid:"user"==t?s:void 0,cid:"channel"==t?s:void 0}),[j]=(0,Ft.bI)(),[b]=(0,xt.o5)(),y=(0,n.bS)(`/chat/dm/${s}`),w=(0,g.I0)(),C=(0,n.s0)(),{pathname:N}=(0,n.TH)(),{channelMuted:k}=(0,u.CG)((e=>({channelMuted:"channel"==t&&e.footprint.muteChannels[s]}))),_=()=>{if(l){b("user"==t?{users:[{uid:+s,mid:l}]}:{groups:[{gid:+s,mid:l}]})}},Z="user"==t?[{title:m("action.mark_read"),handler:_},{title:m("setting"),handler:()=>{C(`/setting/dm/${s}/overview?f=${N}`)}},p&&{title:m("action.copy_email"),handler:f},{title:m("action.hide_session"),danger:!0,handler:()=>{w((0,R.So)(s)),y&&C("/chat")}}]:[{title:m("setting"),underline:!0,handler:()=>{C(`/setting/channel/${s}/overview?f=${N}`)}},{title:m("action.mark_read"),handler:_},{title:m(k?"action.unmute":"action.mute"),handler:()=>{j(k?{remove_groups:[s]}:{add_groups:[{gid:s}]})}},{title:m("action.invite_people"),handler:c.bind(null,s)},v&&{title:m("action.delete_channel"),danger:!0,handler:i.bind(null,s)}];return(0,h.jsx)(d.ZP,{interactive:!0,placement:"right-start",popperOptions:{strategy:"fixed"},followCursor:"initial",visible:a,onClickOutside:r,content:(0,h.jsx)(Ut.Z,{hideMenu:r,items:Z.filter(Boolean)}),children:o})};var Tt;function Bt(){return Bt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Bt.apply(this,arguments)}const Pt=(e,t)=>{let{title:s,titleId:n,...l}=e;return a.createElement("svg",Bt({width:5,height:8,viewBox:"0 0 5 8",fill:"#616161",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},l),s?a.createElement("title",{id:n},s):null,Tt||(Tt=a.createElement("path",{d:"M4.1875 3.16699V2.33366C4.1875 1.40033 3.375 0.666992 2.5 0.666992C1.625 0.666992 0.833333 1.40033 0.833333 2.33366V3.16699C0.373083 3.16699 0 3.54009 0 4.00032V6.50032C0 6.96056 0.373083 7.33366 0.833333 7.33366H2.5H4.16667C4.62692 7.33366 5 6.96056 5 6.50032V3.97949C5 3.53076 4.63625 3.16699 4.1875 3.16699ZM3.33333 3.16699H1.66667V2.33366C1.66667 1.85747 2.05558 1.50033 2.5 1.50033C2.94442 1.50033 3.33333 1.85747 3.33333 2.33366V3.16699Z"})))},zt=(0,a.forwardRef)(Pt);var At=s(47438);const Wt=e=>{let{type:t="user",id:s,mid:r,setDeleteChannelId:d,setInviteChannelId:c}=e;const o="user"==t?`/chat/dm/${s}`:`/chat/channel/${s}`,m=(0,n.bS)(o),x=(0,n.s0)(),{addStageFile:p}=(0,Y.Z)({context:t,id:s}),[{isActive:f},g]=(0,V.L)((()=>({accept:[L.FILE],drop(e){let{files:a}=e;if(a.length){const e=a.map((e=>{const{size:t,type:s,name:a}=e;return{size:t,type:s,name:a,url:URL.createObjectURL(e)}}));p(e),x("user"==t?`/chat/dm/${s}`:`/chat/channel/${s}`)}},collect:e=>({isActive:e.canDrop()&&e.isOver()})})),[t,s]),{visible:v,handleContextMenuEvent:j,hideContextMenu:b}=(0,At.Z)(),[y,w]=(0,a.useState)(),{messageData:C,userData:N,channelData:k,readIndex:M,loginUid:$,mids:D,muted:I}=(0,u.CG)((e=>{var a;return{mids:"user"==t?e.userMessage.byId[s]:e.channelMessage[s],loginUid:(null===(a=e.authData.user)||void 0===a?void 0:a.uid)||0,readIndex:"user"==t?e.footprint.readUsers[s]:e.footprint.readChannels[s],messageData:e.message,userData:e.users.byId,channelData:e.channels.byId,muted:"user"==t?e.footprint.muteUsers[s]:e.footprint.muteChannels[s]}}));if((0,a.useEffect)((()=>{const e="user"==t?N[s]:k[s];if(e)if("avatar"in e){const{name:t,avatar:s}=e;w({name:t,icon:s,mid:r,is_public:!0})}else{const{name:t,icon:s="",is_public:a}=e;w({name:t,icon:s,mid:r,is_public:a})}}),[s,r,t,N,k]),!y)return null;const E=C[r]||{},{name:O,icon:H,is_public:S}=y,{unreads:F=0}=(0,ht.ZP)({mids:D,readIndex:M,messageData:C,loginUid:$});return(0,h.jsx)("li",{className:"session",children:(0,h.jsx)(Rt,{visible:v,hide:b,context:t,id:s,mid:r,setInviteChannelId:c,deleteChannel:d,children:(0,h.jsxs)(i.OL,{ref:g,className:e=>{let{isActive:t}=e;return(0,l.Z)("nav flex gap-2 rounded-lg p-2 w-full md:hover:bg-gray-500/20",f&&"shadow-[inset_0_0_0_2px_#52edff]",t&&"bg-gray-500/20")},to:o,onContextMenu:j,children:[(0,h.jsx)("div",{className:"flex shrink-0",children:"user"==t?(0,h.jsx)(K.Z,{avatarSize:40,compact:!0,interactive:!1,uid:s}):(0,h.jsx)(_.Z,{width:40,height:40,className:"icon rounded-full",type:"channel",name:O,src:H})}),(0,h.jsxs)("div",{className:"w-full flex flex-col justify-between overflow-hidden",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between ",children:[(0,h.jsxs)("span",{className:(0,l.Z)("flex items-center gap-1"),children:[(0,h.jsx)("i",{className:(0,l.Z)("not-italic font-semibold text-sm text-gray-500 dark:text-white max-w-[120px] truncate",!E.created_at&&"max-w-[190px]"),children:O}),!S&&(0,h.jsx)(zt,{className:"dark:fill-gray-400"})]}),(0,h.jsx)("span",{className:(0,l.Z)("text-xs text-gray-500 dark:text-gray-400 max-w-[80px] truncate font-semibold"),children:(0,Z.Lf)(E.created_at)})]}),(0,h.jsxs)("div",{className:"flex items-center justify-between",children:[(0,h.jsx)("span",{className:(0,l.Z)("text-xs text-gray-500 dark:text-gray-400  truncate",F>0?"w-36":""),children:(0,ht.DH)(E)}),F>0&&!m&&(0,h.jsx)("strong",{className:(0,l.Z)("text-white px-1.5 py-[3px] bg-primary-400 font-bold text-[10px] leading-[10px] rounded-[10px]",F>99&&"w-1.5 !h-1.5 p-0 min-w-[unset]",I&&"bg-gray-500"),children:F>99?null:F})]})]})]})})})};var Yt=s(77493);const qt=e=>{let{tempSession:t}=e;const s=(0,a.useRef)(null),[n,l]=(0,a.useState)(),[r,i]=(0,a.useState)(),[d,c]=(0,a.useState)([]),{channelIDs:o,DMs:m,readChannels:x,readUsers:p,channelMessage:f,userMessage:g,loginUid:v}=(0,u.CG)((e=>{var t;return{loginUid:null===(t=e.authData.user)||void 0===t?void 0:t.uid,channelIDs:e.channels.ids,DMs:e.userMessage.ids,userMessage:e.userMessage.byId,channelMessage:e.channelMessage,readChannels:e.footprint.readChannels,readUsers:e.footprint.readUsers}}));return(0,a.useEffect)((()=>{const e=[...o.map((e=>{const t=f[e];if(!t||0==t.length)return{unreads:0,id:e,type:"channel"};return{id:e,mid:[...t].sort(((e,t)=>+e-+t)).pop(),type:"channel"}})),...m.map((e=>{const t=g[e];if(!t||0==t.length)return{unreads:0,id:e,type:"user"};return{type:"user",id:e,mid:[...t].sort(((e,t)=>+e-+t)).pop()}}))].sort(((e,t)=>{const{mid:s=0}=e,{mid:a=0}=t;return a-s})),s=t?[t,...e]:e;c(s)}),[o,m,f,x,p,v,g,t]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("ul",{ref:s,className:"flex flex-col gap-0.5 p-2 overflow-auto",children:(0,h.jsx)($t.b,{initialPrerender:10,viewportRef:s,items:d,children:e=>{const{type:t,id:s,mid:a=0}=e,n=`${t}_${s}`;return(0,h.jsx)(Wt,{type:t,id:s,mid:a,setInviteChannelId:i,setDeleteChannelId:l},n)}})}),!!n&&(0,h.jsx)(Yt.Z,{id:n,closeModal:()=>{l(0)}}),!!r&&(0,h.jsx)(It.Z,{type:"channel",cid:r,closeModal:()=>{i(0)}})]})},Kt=(0,a.memo)(qt);var Jt=s(43764);const Qt=()=>{const{t:e}=(0,x.$G)("auth"),t=(0,g.I0)(),{clearLocalData:s}=(0,et.Z)(),a=(0,n.s0)(),l=(0,u.CG)((e=>e.server.name));return(0,h.jsxs)("section",{className:"flex flex-col items-center text-center",children:[(0,h.jsx)("h2",{className:"text-3xl text-gray-600 dark:text-gray-50 font-bold",children:e("welcome",{name:l})}),(0,h.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,h.jsx)("span",{className:"text-gray-400 dark:text-gray-200 my-3 text-sm",children:e("guest_login_tip")}),(0,h.jsx)("div",{className:"w-44 h-44 self-center mb-4",children:(0,h.jsx)(Jt.Z,{level:"Q",size:1200,link:`https://voce.chat/login?s=${encodeURIComponent(T.Ci)}`})}),(0,h.jsx)(ae.Z,{onClick:()=>{t((0,Xe.sQ)()),s(),a("/login")},className:"small",children:e("sign_in")})]})]})};function Xt(e){let{cid:t=0}=e;const{data:s}=(0,u.CG)((e=>({data:e.channels.byId[t]})));if(!s)return null;const{name:a,description:n,is_public:l}=s;return(0,h.jsx)(wt,{readonly:!0,to:t,context:"channel",header:(0,h.jsxs)("header",{className:"px-5 py-4 flex items-center justify-center md:justify-between shadow-[inset_0_-1px_0_rgb(0_0_0_/_10%)]",children:[(0,h.jsx)(Mt.Z,{}),(0,h.jsxs)("div",{className:"flex items-center gap-1",children:[(0,h.jsx)(H.Z,{personal:!l}),(0,h.jsx)("span",{className:"text-gray-800 dark:text-white",children:a}),(0,h.jsx)("span",{className:"ml-2 text-gray-500 hidden md:block ",children:n})]})]})})}const es=e=>{let{id:t,mid:s}=e;const[n,r]=(0,a.useState)(),{messageData:d,userData:c,channelData:o}=(0,u.CG)((e=>({messageData:e.message,userData:e.users.byId,channelData:e.channels.byId})));if((0,a.useEffect)((()=>{const e=o[t];if(!e)return;const{name:a,icon:n="",is_public:l}=e;r({name:a,icon:n,mid:s,is_public:l})}),[t,s,c,o]),!n)return null;const m=d[s]||{},{name:x,icon:p}=n;return(0,h.jsx)("li",{className:"session",children:(0,h.jsxs)(i.OL,{className:e=>{let{isActive:t}=e;return(0,l.Z)("nav flex gap-2 rounded-lg p-2 w-full md:hover:bg-gray-500/20",t&&"bg-gray-500/20")},to:`/chat/channel/${t}`,children:[(0,h.jsx)("div",{className:"flex shrink-0",children:(0,h.jsx)(_.Z,{width:40,height:40,className:"icon rounded-full",type:"channel",name:x,src:p})}),(0,h.jsxs)("div",{className:"w-full flex flex-col justify-between",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between",children:[(0,h.jsx)("span",{className:(0,l.Z)("flex items-center gap-2 font-semibold text-sm text-gray-500 dark:text-white truncate",m.created_at&&"max-w-[190px]"),children:x}),(0,h.jsx)("span",{className:"text-xs text-gray-600 max-w-[80px] truncate",children:(0,Z.Lf)(m.created_at)})]}),(0,h.jsx)("div",{className:"flex items-center justify-between",children:(0,h.jsx)("span",{className:"text-xs text-gray-500 w-36 truncate",children:(0,ht.DH)(m)})})]})]})})},ts=()=>{const[e,t]=(0,a.useState)([]),{channelIDs:s,readChannels:n,readUsers:l,channelMessage:r,userMessage:i,loginUid:d}=(0,u.CG)((e=>{var t;return{loginUid:null===(t=e.authData.user)||void 0===t?void 0:t.uid,channelIDs:e.channels.ids,userMessage:e.userMessage.byId,channelMessage:e.channelMessage,readChannels:e.footprint.readChannels,readUsers:e.footprint.readUsers}}));return(0,a.useEffect)((()=>{const e=[...s.map((e=>{const t=r[e];if(!t||0==t.length)return{key:`channel_${e}`,unreads:0,id:e,type:"channel"};return{key:`channel_${e}`,id:e,mid:[...t].sort().pop(),type:"channel"}}))].sort(((e,t)=>{const{mid:s=0}=e,{mid:a=0}=t;return a-s}));t(e)}),[s,r,n,l,d,i]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("ul",{className:"flex-1 flex flex-col gap-0.5 p-2 overflow-auto",children:e.map((e=>{const{key:t,id:s,mid:a=0}=e;return(0,h.jsx)(es,{id:s,mid:a},t)}))}),(0,h.jsx)(tt,{placement:"session"})]})};var ss=s(83825);function as(e){let{error:t,resetErrorBoundary:s}=e;return(0,h.jsxs)("div",{role:"alert",className:"text-lg text-red-600",children:[(0,h.jsx)("p",{children:"Something went wrong:"}),(0,h.jsx)("pre",{children:t.message}),(0,h.jsx)("button",{onClick:s,children:"Try again"})]})}const ns=e=>{let{children:t}=e;return(0,h.jsx)(ss.SV,{FallbackComponent:as,children:t})};function ls(){const e=(0,n.bS)("/"),t=(0,n.bS)("/chat"),[s,i]=(0,a.useState)(!1),[d,c]=(0,a.useState)(!1),[o,m]=(0,a.useState)(!1),{channel_id:x=0,user_id:f=0}=(0,n.UO)(),{sessionUids:g,isGuest:v}=(0,u.CG)((e=>({isGuest:e.authData.guest,sessionUids:e.userMessage.ids}))),j=0==f?void 0:-1==g.findIndex((e=>e==+f))?{mid:0,unread:0,id:+f,type:"user"}:void 0,b=0==x&&0==f,y=e||t;return(0,h.jsxs)(ns,{children:[d&&(0,h.jsx)(St.Z,{closeModal:()=>{c((e=>!e))},personal:!0}),o&&(0,h.jsx)(Lt.Z,{closeModal:()=>{m((e=>!e))}}),(0,h.jsxs)("div",{className:(0,l.Z)("flex h-screen md:h-full md:pt-2 md:pb-2.5 md:pr-1",v?"guest-container md:px-1":"md:pr-12"),children:[s&&(0,h.jsx)("div",{onClick:()=>{i((e=>!e))},className:"z-30 fixed top-0 left-4 w-screen h-screen bg-black/50 transition-all backdrop-blur-sm"}),(0,h.jsxs)("div",{className:(0,l.Z)("left-container pb-14 md:pb-0 flex-col md:rounded-l-2xl w-full h-screen md:h-full md:max-w-[250px] md:min-w-[268px] shadow-[rgb(0_0_0_/_10%)_-1px_0px_0px_inset] bg-white dark:!bg-gray-800",y?"flex":"hidden md:flex"),children:[(0,h.jsx)(p,{readonly:v}),v?(0,h.jsx)(ts,{}):(0,h.jsx)(Kt,{tempSession:j}),v&&(0,h.jsxs)("footer",{className:"hidden md:block py-1 text-xs text-gray-300 dark:text-gray-700 text-center",children:["Host your own ",(0,h.jsx)("a",{href:"https://voce.chat",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400  dark:text-gray-600",children:"voce.chat"})]})]}),(0,h.jsxs)("div",{className:(0,l.Z)("right-container md:rounded-r-2xl w-full bg-white dark:!bg-gray-700",b&&"h-full flex-center",y&&"hidden md:flex"),children:[b&&(v?(0,h.jsx)(Qt,{}):(0,h.jsx)(r.Z,{})),0!==x&&(v?(0,h.jsx)(Xt,{cid:+x}):(0,h.jsx)(Ht,{cid:+x})),0!==f&&(0,h.jsx)(Vt,{uid:+f})]})]})]})}const rs=(0,a.memo)(ls)},77493:(e,t,s)=>{s.d(t,{Z:()=>u});var a=s(70537),n=s(27418),l=s(15924),r=s(80874),i=s(6144),d=s(40698),c=s(69885),o=s(14566),m=s(80683);const u=e=>{let{id:t,closeModal:s}=e;const{t:u}=(0,o.$G)("setting"),{t:x}=(0,o.$G)(),h=(0,l.s0)(),[p,{isLoading:f,isSuccess:g}]=(0,i.kE)();return(0,a.useEffect)((()=>{g&&(n.ZP.success(x("tip.delete")),s(),h("/chat"))}),[g]),t?(0,m.jsx)(r.Z,{id:"modal-modal",children:(0,m.jsx)(d.Z,{className:"compact",title:u("channel.delete"),description:u("channel.delete_desc"),buttons:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(c.Z,{onClick:s.bind(null,void 0),className:"cancel",children:x("action.cancel")}),(0,m.jsx)(c.Z,{onClick:()=>{p(t)},className:"danger",children:f?"Deleting":x("action.remove")})]})})}):null}}}]);