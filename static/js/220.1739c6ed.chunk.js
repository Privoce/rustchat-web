"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[220],{13706:(e,s,n)=>{n.d(s,{Z:()=>h});var l=n(70537),a=n(27418),t=n(14566),i=n(52334),c=n(6144),d=n(66160),r=n(78806),o=n(4472),u=n(27459),v=n(74425),m=n(80683);const h=({id:e,type:s="channel"})=>{var n,h;const x=(0,d.CG)((n=>"channel"==s?n.footprint.autoDeleteMsgChannels.find((s=>s.gid==e)):n.footprint.autoDeleteMsgUsers.find((s=>s.uid==e))),v.wU),f=(0,d.CG)((e=>e.authData.user),v.wU),p=(0,d.CG)((n=>"channel"==s?n.channels.byId[e]:null),v.wU),[g,{isSuccess:j}]=(0,i.ar)(),[Z,{isSuccess:w}]=(0,c.cF)(),[b,C]=(0,l.useState)(null!==(n=null===x||void 0===x?void 0:x.expires_in)&&void 0!==n?n:0),{t:N}=(0,t.$G)("setting",{keyPrefix:"auto_delete_msg"}),{t:_}=(0,t.$G)(),y=[{title:N("off"),value:0},{title:N("5_min"),value:300},{title:N("10_min"),value:600},{title:N("1_hour"),value:3600},{title:N("1_day"),value:86400},{title:N("1_week"),value:604800}];(0,l.useEffect)((()=>{j&&a.Am.success(_("tip.update"))}),[j]),(0,l.useEffect)((()=>{w&&a.Am.success("Cleared!")}),[w]);const k=null!==(h=null===x||void 0===x?void 0:x.expires_in)&&void 0!==h?h:0,S="channel"==s&&((null===p||void 0===p?void 0:p.owner)==(null===f||void 0===f?void 0:f.uid)||(null===f||void 0===f?void 0:f.is_admin));return(0,m.jsxs)("section",{className:"max-w-[512px] h-full relative",children:[(0,m.jsxs)("div",{className:"text-sm",children:[(0,m.jsx)("h2",{className:"dark:text-white",children:N("title")}),(0,m.jsx)("p",{className:"text-gray-400 text-xs",children:N("desc")})]}),(0,m.jsx)("div",{className:"mt-4",children:(0,m.jsx)(u.Z,{options:y.map((({title:e})=>e)),values:y.map((({value:e})=>e)),value:b||0,onChange:e=>{C(e)}})}),k!==b&&(0,m.jsx)(r.Z,{saveHandler:()=>{g("dm"==s?{users:[{uid:e,expires_in:b}]}:{groups:[{gid:e,expires_in:b}]})},resetHandler:()=>{var e;C(null!==(e=null===x||void 0===x?void 0:x.expires_in)&&void 0!==e?e:0)}}),S&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"text-sm mt-8",children:[(0,m.jsx)("h2",{className:"dark:text-white",children:N("clear_title")}),(0,m.jsx)("p",{className:"text-gray-400 text-xs",children:N("clear_desc")})]}),(0,m.jsx)("div",{className:"mt-4",children:(0,m.jsx)(o.Z,{className:"danger",onClick:()=>{confirm("are you sure?")&&Z(e)},children:N("clear")})})]})]})}},77493:(e,s,n)=>{n.d(s,{Z:()=>v});var l=n(70537),a=n(27418),t=n(14566),i=n(15924),c=n(6144),d=n(97601),r=n(4472),o=n(70254),u=n(80683);const v=({id:e,closeModal:s})=>{const{t:n}=(0,t.$G)("setting"),{t:v}=(0,t.$G)(),m=(0,i.s0)(),[h,{isLoading:x,isSuccess:f}]=(0,c.kE)();return(0,l.useEffect)((()=>{f&&(a.ZP.success(v("tip.delete")),s(),m("/chat"))}),[f]),e?(0,u.jsx)(d.Z,{id:"modal-modal",children:(0,u.jsx)(o.Z,{compact:!0,title:n("channel.delete"),description:n("channel.delete_desc"),buttons:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(r.Z,{onClick:s.bind(null,void 0),className:"cancel",children:v("action.cancel")}),(0,u.jsx)(r.Z,{onClick:()=>{h(e)},className:"danger",children:x?"Deleting":v("action.remove")})]})})}):null}},24629:(e,s,n)=>{n.r(s),n.d(s,{default:()=>F});var l=n(70537),a=n(14566),t=n(15924),i=n(64084),c=n(66160),d=n(27418),r=n(6144),o=n(74425);function u(e){const s=(0,c.CG)((e=>{var s;return null===(s=e.authData.user)||void 0===s?void 0:s.uid}),o.wU),n=(0,c.CG)((s=>s.channels.byId[e]),o.wU),[l,{isLoading:a,isSuccess:t}]=(0,r.tW)(),[i,{isLoading:d,isSuccess:u}]=(0,r.VJ)(),v=s==(null===n||void 0===n?void 0:n.owner);return{otherMembers:(null===n||void 0===n?void 0:n.members.filter((e=>e!=s)))||[],transferOwner:s=>{s&&l({id:e,owner:s})},leaveChannel:()=>{e&&i(e)},leaving:d,leaveSuccess:u,isOwner:v,transferring:a,transferSuccess:t}}var v=n(97601),m=n(4472),h=n(70254),x=n(80683);const f=({id:e,closeModal:s,handleNextStep:n})=>{const{t:i}=(0,a.$G)("setting"),c=(0,t.s0)(),{isOwner:r,leaving:o,leaveChannel:f,leaveSuccess:p}=u(e);return(0,l.useEffect)((()=>{p&&(d.ZP.success("Leave channel successfully!"),s(),c("/chat"))}),[p]),e?(0,x.jsx)(v.Z,{id:"modal-modal",children:(0,x.jsx)(h.Z,{compact:!0,title:i("channel.leave"),description:i(r?"channel.transfer_desc":"channel.leave_desc"),buttons:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(m.Z,{onClick:s.bind(null,void 0),className:"cancel",children:i("action.cancel",{ns:"common"})}),r?(0,x.jsx)(m.Z,{onClick:n,className:"main",children:"Next"}):(0,x.jsx)(m.Z,{onClick:f,className:"danger",children:o?"Leaving":"Leave"})]})})}):null};var p=n(75649),g=n(65487);const j=({id:e,closeModal:s,withLeave:n=!0})=>{const{t:i}=(0,a.$G)(),{transferOwner:c,otherMembers:r,leaving:o,leaveChannel:f,leaveSuccess:j,transferSuccess:Z,transferring:w}=u(e),[b,C]=(0,l.useState)(null),N=(0,t.s0)(),_=e=>{C(e)};if((0,l.useEffect)((()=>{Z&&j&&(d.ZP.success("Leave channel successfully!"),s(),N("/chat"))}),[j,Z,n]),!e)return null;const y=o||w;return(0,x.jsx)(v.Z,{id:"modal-modal",children:(0,x.jsx)(h.Z,{compact:!0,title:"Transfer Ownership",description:"This cannot be undone.",buttons:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(m.Z,{onClick:s.bind(null,void 0),className:"cancel",children:i("action.cancel")}),(0,x.jsx)(m.Z,{disabled:!b,onClick:async()=>{b&&(await c(b),n&&await f())},className:"danger",children:y?"Assigning":"Assign and Leave"})]}),children:(0,x.jsx)("ul",{className:"flex flex-col max-h-[260px] py-4 overflow-y-scroll",children:r.map((e=>(0,x.jsx)("li",{className:(0,p.Z)("cursor-pointer flex items-center px-2 md:hover:bg-gray-500/10",b==e?"bg-gray-500/10":""),onClick:_.bind(null,e),children:(0,x.jsx)(g.Z,{uid:e,interactive:!1})},e)))})})})},Z=({id:e,isOwner:s=!1,closeModal:n})=>{const[a,t]=(0,l.useState)(s);return a?(0,x.jsx)(j,{id:e,closeModal:n}):(0,x.jsx)(f,{id:e,closeModal:n,handleNextStep:()=>{t(!0)}})};var w=n(37954),b=n(77493),C=n(85225),N=n(13706),_=n(87808),y=n(78806),k=n(99487),S=n(54443),G=n(27459),E=n(96825),L=n(79884);function M({id:e=0}){const{t:s}=(0,a.$G)("setting",{keyPrefix:"channel"}),{t:n}=(0,a.$G)(),t=(0,c.CG)((e=>e.authData.user),o.wU),i=(0,c.CG)((s=>s.channels.byId[e]),o.wU),{data:u,refetch:v}=(0,r.aw)(e),[m,h]=(0,l.useState)(!1),[f,p]=(0,l.useState)(),[g]=(0,r.kG)(),[j,{isSuccess:Z}]=(0,r.tW)(),[w,{isSuccess:b}]=(0,r.Cl)(),C=e=>{const s=e.target.value,{type:n=""}=e.target.dataset;p((e=>e?{...e,[n]:s}:e))};if((0,l.useEffect)((()=>{u&&p(u)}),[u]),(0,l.useEffect)((()=>{if(u&&f){const{name:e,description:s}=f,{name:n,description:l}=u;h(n!==e||l!==s)}}),[u,f]),(0,l.useEffect)((()=>{Z&&(d.ZP.success(n("tip.update")),v())}),[Z]),(0,l.useEffect)((()=>{b&&d.ZP.success(n("tip.update"))}),[b]),!f||!e||!i)return null;const{name:N,description:M}=f,U=!(null!==t&&void 0!==t&&t.is_admin)&&(null===i||void 0===i?void 0:i.owner)!=(null===t||void 0===t?void 0:t.uid),$="w-full flex flex-col items-start gap-2 relative";return(0,x.jsxs)("div",{className:"relative w-[512px] flex flex-col gap-6 h-full",children:[(0,x.jsx)(_.Z,{type:"channel",url:null===i||void 0===i?void 0:i.icon,name:N,uploadImage:s=>{g({gid:e,image:s})}}),(0,x.jsxs)("div",{className:"flex flex-col gap-6 items-start",children:[(0,x.jsxs)("div",{className:"flex items-center gap-1",children:[(0,x.jsx)(S.Z,{htmlFor:"name",children:s("id")}),(0,x.jsxs)("span",{className:"text-gray-500",children:["#",e]})]}),(0,x.jsxs)("div",{className:$,children:[(0,x.jsx)(S.Z,{htmlFor:"name",children:s("name")}),(0,x.jsx)(k.Z,{disabled:U,className:"!pl-8","data-type":"name",onChange:C,value:N,name:"name",id:"name",placeholder:s("name")}),(0,x.jsx)(L.Z,{className:"absolute bottom-2.5 left-2 dark:fill-gray-300"})]}),(0,x.jsxs)("div",{className:$,children:[(0,x.jsx)(S.Z,{htmlFor:"desc",children:s("topic")}),(0,x.jsx)(E.Z,{disabled:U,"data-type":"description",onChange:C,value:null!==M&&void 0!==M?M:"",rows:4,name:"name",id:"name",placeholder:s("topic_placeholder")})]}),!U&&t.is_admin&&(0,x.jsxs)("div",{className:$,children:[(0,x.jsx)(S.Z,{htmlFor:"desc",children:s("visibility")}),(0,x.jsx)(G.Z,{options:[s("public"),s("private")],values:["true","false"],value:String(i.is_public),onChange:s=>{w({is_public:"true"===s.toLowerCase(),id:e})}})]})]}),m&&(0,x.jsx)(y.Z,{saveHandler:()=>{if(!f)return;const{name:s,description:n}=f;j({id:e,name:s,description:n})},resetHandler:()=>{p(u)}})]})}const U=e=>{const{t:s}=(0,a.$G)("setting");return[{title:s("nav.general"),items:[{name:"overview",title:s("nav.overview"),component:(0,x.jsx)(M,{id:e})},{name:"auto_delete_msg",title:s("nav.auto_delete_msg"),component:(0,x.jsx)(N.Z,{id:e})},{name:"members",title:s("nav.members"),component:(0,x.jsx)(C.Z,{cid:e})}]}]};let $="";function F(){const{t:e}=(0,a.$G)("setting"),{cid:s=0,nav:n}=(0,t.UO)(),d=(0,c.CG)((e=>e.authData.user),o.wU),r=(0,c.CG)((e=>s?e.channels.byId[+s]:void 0),o.wU),u=(0,t.s0)(),[v]=(0,i.lr)(),m=U(+s),h=m.map((({items:e})=>e)).flat();$=$||(v.get("f")||"/");const[f,p]=(0,l.useState)(!1),[g,j]=(0,l.useState)(!1),C=()=>{p((e=>!e))},N=()=>{j((e=>!e))};if(!s)return null;const _=h.find((e=>e.name==n)),y=(null===d||void 0===d?void 0:d.is_admin)||(null===r||void 0===r?void 0:r.owner)==(null===d||void 0===d?void 0:d.uid),k=!(null!==r&&void 0!==r&&r.is_public);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(w.Z,{pathPrefix:`/setting/channel/${s}`,nav:_,closeModal:()=>{u($),$=""},title:"Channel Settings",navs:m,dangers:[k&&{title:e("channel.leave"),handler:N},y&&{title:e("channel.delete"),handler:C}],children:n?null===_||void 0===_?void 0:_.component:null}),f&&(0,x.jsx)(b.Z,{closeModal:C,id:+s}),g&&(0,x.jsx)(Z,{closeModal:N,id:+s})]})}},97943:(e,s,n)=>{n.d(s,{O:()=>t});var l=n(70537),a=n(2978);function t(e,s,n=!0){const t=(0,l.useRef)(s),i=(0,l.useCallback)((s=>{e.current&&!e.current.contains(s.target)&&t.current(s)}),[e]);(0,l.useEffect)((()=>{t.current=s})),(0,l.useEffect)((()=>n?(document.addEventListener("click",i,!0),document.addEventListener("ontouchstart",i,!0),()=>{document.removeEventListener("click",i,!0),document.removeEventListener("ontouchstart",i,!0)}):a.Z),[e,s,n,i])}},2978:(e,s,n)=>{n.d(s,{Z:()=>l});const l=()=>{}}}]);